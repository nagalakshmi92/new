

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ROCm Libraries &mdash; ReadTheDocs-Breathe 1.0.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ROCm Compiler SDK" href="../ROCm_Compiler_SDK/ROCm-Compiler-SDK.html" />
    <link rel="prev" title="ROCm Tools" href="../ROCm_Tools/ROCm-Tools.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> ReadTheDocs-Breathe
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../ROCm.html">Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Current_Release_Notes/Current-Release-Notes.html">Current Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Installation_Guide/Installation-Guide.html">ROCm Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Programming_Guides/Programming-Guides.html">Programming Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ROCm_GPU_Tunning_Guides/ROCm-GPU-Tunning-Guides.html">ROCm GPU Tuning Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GCN_ISA_Manuals/GCN-ISA-Manuals.html">GCN ISA Manuals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ROCm_API_References/ROCm-API-References.html">ROCm API References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ROCm_Tools/ROCm-Tools.html">ROCm Tools</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">ROCm Libraries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#rocfft">rocFFT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#api-design">API design</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installing-pre-built-packages">Installing pre-built packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="#quickstart-rocfft-build">Quickstart rocFFT build</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#rocblas">rocBLAS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">Installing pre-built packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="#quickstart-rocblas-build">Quickstart rocBLAS build</a></li>
<li class="toctree-l3"><a class="reference internal" href="#manual-build-all-supported-platforms">Manual build (all supported platforms)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rocblas-interface-examples">rocBLAS interface examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gemv-api">GEMV API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#batched-and-strided-gemm-api">Batched and strided GEMM API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#asynchronous-api">Asynchronous API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#hipblas">hipBLAS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id6">Installing pre-built packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="#quickstart-hipblas-build">Quickstart hipBLAS build</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hipblas-interface-examples">hipBLAS interface examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7">GEMV API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id8">Batched and strided GEMM API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#hcrng">hcRNG</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#key-features">Key Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tested-environments">Tested Environments</a></li>
<li class="toctree-l3"><a class="reference internal" href="#unit-testing">Unit testing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#hipeigen">hipeigen</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#installation-instructions-for-rocm">Installation instructions for ROCm</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installing-from-amd-rocm-repositories">Installing from AMD ROCm repositories</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation-instructions-for-eigen">Installation instructions for Eigen</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-and-run-hipeigen-direct-tests">Build and Run hipeigen direct tests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#clfft">clFFT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction-to-clfft">Introduction to clFFT</a></li>
<li class="toctree-l3"><a class="reference internal" href="#clfft-library-user-documentation">clFFT library user documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#api-semantic-versioning">API semantic versioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="#clfft-wiki">clFFT Wiki</a></li>
<li class="toctree-l3"><a class="reference internal" href="#contributing-code">Contributing code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#license">License</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id12">Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-dependencies">Build dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#performance-infrastructure">Performance infrastructure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#clblas">clBLAS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#clblas-library-user-documentation">clBLAS library user documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id16">License</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id17">Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id18">Build dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id19">Performance infrastructure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#clsparse">clSPARSE</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-s-new-in-clsparse-v0-10-1">What’s new in clSPARSE v0.10.1</a></li>
<li class="toctree-l3"><a class="reference internal" href="#clsparse-features">clSPARSE features</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id21">API semantic versioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id26">License</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#clrng">clRNG</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-s-new">What’s New</a></li>
<li class="toctree-l3"><a class="reference internal" href="#building">Building</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-instructions-for-linux">Example Instructions for Linux</a></li>
<li class="toctree-l3"><a class="reference internal" href="#building-the-documentation-manually">Building the documentation manually</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#hcfft">hcFFT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id29">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id30">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#keyfeature">KeyFeature</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id32">Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id33">Tested Environments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tensile">Tensile</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#benchmark-config">Benchmark Config</a></li>
<li class="toctree-l3"><a class="reference internal" href="#benchmark-protocol">Benchmark Protocol</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#benchmark-common-parameters">Benchmark Common Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fork-parameters"><strong>Fork Parameters</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="#join-parameters">Join Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#benchmark-final-parameters">Benchmark Final Parameters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#kernel-parameters">Kernel Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#solution-kernel-parameters">Solution / Kernel Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#kernel-parameters-affect-performance">Kernel Parameters Affect Performance</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gpu-kernel-dimension">GPU Kernel Dimension</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#languages">Languages</a></li>
<li class="toctree-l3"><a class="reference internal" href="#problem-nomenclature">Problem Nomenclature</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensile-lib">Tensile.lib</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#rocalution">rocALUTION</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id34">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#building-and-installing">Building and Installing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id35">Installing from AMD ROCm repositories</a></li>
<li class="toctree-l3"><a class="reference internal" href="#building-rocalution-from-open-source-repository">Building rocALUTION from Open-Source repository</a></li>
<li class="toctree-l3"><a class="reference internal" href="#download-rocalution">Download rocALUTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-install-sh-to-build-dependencies-library">Using <em>install.sh</em> to build dependencies + library</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-install-sh-to-build-dependencies-library-client">Using <em>install.sh</em> to build dependencies + library + client</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-individual-commands-to-build-rocalution">Using individual commands to build rocALUTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="#common-build-problems">Common build problems</a></li>
<li class="toctree-l3"><a class="reference internal" href="#simple-test">Simple Test</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id38">rocSPARSE</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id39">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#device-and-stream-management">Device and Stream Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="#asynchronous-execution">Asynchronous Execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hip-device-management">HIP Device Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hip-stream-management">HIP Stream Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multiple-streams-and-multiple-devices">Multiple Streams and Multiple Devices</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id40">Building and Installing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id41">Installing from AMD ROCm repositories</a></li>
<li class="toctree-l3"><a class="reference internal" href="#building-rocsparse-from-open-source-repository">Building rocSPARSE from Open-Source repository</a></li>
<li class="toctree-l3"><a class="reference internal" href="#download-rocsparse">Download rocSPARSE</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id42">Using <em>install.sh</em> to build dependencies + library</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id43">Using <em>install.sh</em> to build dependencies + library + client</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-individual-commands-to-build-rocsparse">Using individual commands to build rocSPARSE</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id44">Common build problems</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ROCm_Compiler_SDK/ROCm-Compiler-SDK.html">ROCm Compiler SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ROCm_System_Managment/ROCm-System-Managment.html">ROCm System Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ROCm_Virtualization_Containers/ROCm-Virtualization-&amp;-Containers.html">ROCm Virtualization &amp; Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Remote_Device_Programming/Remote-Device-Programming.html">Remote Device Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Deep_learning/Deep-learning.html">Deep Learning on ROCm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Other_Solutions/Other-Solutions.html">System Level Debug</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorial/Tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ROCm_Glossary/ROCm-Glossary.html">ROCm Glossary</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ReadTheDocs-Breathe</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>ROCm Libraries</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/ROCm_Libraries/ROCm_Libraries.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="rocm-libraries">
<span id="id1"></span><h1>ROCm Libraries<a class="headerlink" href="#rocm-libraries" title="Permalink to this headline">¶</a></h1>
<div class="section" id="rocfft">
<h2>rocFFT<a class="headerlink" href="#rocfft" title="Permalink to this headline">¶</a></h2>
<p>rocFFT is a software library for computing Fast Fourier Transforms (FFT) written in HIP. It is part of AMD’s software ecosystem based on ROCm. In addition to AMD GPU devices, the library can also be compiled with the CUDA compiler using HIP tools for running on Nvidia GPU devices.</p>
<div class="section" id="api-design">
<h3>API design<a class="headerlink" href="#api-design" title="Permalink to this headline">¶</a></h3>
<p>Please refer to the <a class="reference internal" href="../ROCm_Tools/rocFFTAPI.html#rocfftapi"><span class="std std-ref">rocFFT API design</span></a> for current documentation. Work in progress.</p>
</div>
<div class="section" id="installing-pre-built-packages">
<h3>Installing pre-built packages<a class="headerlink" href="#installing-pre-built-packages" title="Permalink to this headline">¶</a></h3>
<p>Download pre-built packages either from <a class="reference external" href="https://rocm-documentation.readthedocs.io/en/latest/Installation_Guide/Installation-Guide.html">ROCm’s package servers</a> or by clicking the github releases tab and manually downloading, which could be newer. Release notes are available for each release on the releases tab.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">update</span> <span class="o">&amp;&amp;</span> <span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">rocfft</span>
</pre></div>
</div>
</div>
<div class="section" id="quickstart-rocfft-build">
<h3>Quickstart rocFFT build<a class="headerlink" href="#quickstart-rocfft-build" title="Permalink to this headline">¶</a></h3>
<p>Bash helper build script (Ubuntu only)
The root of this repository has a helper bash script install.sh to build and install rocFFT on Ubuntu with a single command. It does not take a lot of options and hard-codes configuration that can be specified through invoking cmake directly, but it’s a great way to get started quickly and can serve as an example of how to build/install. A few commands in the script need sudo access, so it may prompt you for a password.
* <code class="docutils literal notranslate"><span class="pre">./install</span> <span class="pre">-h</span></code> – shows help
* <code class="docutils literal notranslate"><span class="pre">./install</span> <span class="pre">-id</span></code> – build library, build dependencies and install globally (-d flag only needs to be specified once on a system)
* <code class="docutils literal notranslate"><span class="pre">./install</span> <span class="pre">-c</span> <span class="pre">--cuda</span></code> – build library and clients for cuda backend into a local directory
Manual build (all supported platforms)
If you use a distro other than Ubuntu, or would like more control over the build process, the <a class="reference external" href="https://github.com/ROCmSoftwarePlatform/rocFFT/wiki/Build">rocfft build wiki</a> has helpful information on how to configure cmake and manually build.</p>
<p>Library and API Documentation
Please refer to the Library documentation for current documentation.</p>
</div>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>The following is a simple example code that shows how to use rocFFT to compute a 1D single precision 16-point complex forward transform.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;iostream&gt;</span>
<span class="c1">#include &lt;vector&gt;</span>
<span class="c1">#include &quot;hip/hip_runtime_api.h&quot;</span>
<span class="c1">#include &quot;hip/hip_vector_types.h&quot;</span>
<span class="c1">#include &quot;rocfft.h&quot;</span>

<span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
        <span class="o">//</span> <span class="n">rocFFT</span> <span class="n">gpu</span> <span class="n">compute</span>
        <span class="o">//</span> <span class="o">========================================</span>

        <span class="n">size_t</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>
        <span class="n">size_t</span> <span class="n">Nbytes</span> <span class="o">=</span> <span class="n">N</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">float2</span><span class="p">);</span>

        <span class="o">//</span> <span class="n">Create</span> <span class="n">HIP</span> <span class="n">device</span> <span class="n">buffer</span>
        <span class="n">float2</span> <span class="o">*</span><span class="n">x</span><span class="p">;</span>
        <span class="n">hipMalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="n">Nbytes</span><span class="p">);</span>

        <span class="o">//</span> <span class="n">Initialize</span> <span class="n">data</span>
        <span class="n">std</span><span class="p">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">float2</span><span class="o">&gt;</span> <span class="n">cx</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
                <span class="n">cx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                <span class="n">cx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="o">//</span>  <span class="n">Copy</span> <span class="n">data</span> <span class="n">to</span> <span class="n">device</span>
        <span class="n">hipMemcpy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">cx</span><span class="o">.</span><span class="n">data</span><span class="p">(),</span> <span class="n">Nbytes</span><span class="p">,</span> <span class="n">hipMemcpyHostToDevice</span><span class="p">);</span>

        <span class="o">//</span> <span class="n">Create</span> <span class="n">rocFFT</span> <span class="n">plan</span>
        <span class="n">rocfft_plan</span> <span class="n">plan</span> <span class="o">=</span> <span class="n">NULL</span><span class="p">;</span>
        <span class="n">size_t</span> <span class="n">length</span> <span class="o">=</span> <span class="n">N</span><span class="p">;</span>
        <span class="n">rocfft_plan_create</span><span class="p">(</span><span class="o">&amp;</span><span class="n">plan</span><span class="p">,</span> <span class="n">rocfft_placement_inplace</span><span class="p">,</span> <span class="n">rocfft_transform_type_complex_forward</span><span class="p">,</span> <span class="n">rocfft_precision_single</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>                        <span class="o">&amp;</span><span class="n">length</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NULL</span><span class="p">);</span>

        <span class="o">//</span> <span class="n">Execute</span> <span class="n">plan</span>
        <span class="n">rocfft_execute</span><span class="p">(</span><span class="n">plan</span><span class="p">,</span> <span class="p">(</span><span class="n">void</span><span class="o">**</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span><span class="p">);</span>

        <span class="o">//</span> <span class="n">Wait</span> <span class="k">for</span> <span class="n">execution</span> <span class="n">to</span> <span class="n">finish</span>
        <span class="n">hipDeviceSynchronize</span><span class="p">();</span>

        <span class="o">//</span> <span class="n">Destroy</span> <span class="n">plan</span>
        <span class="n">rocfft_plan_destroy</span><span class="p">(</span><span class="n">plan</span><span class="p">);</span>

        <span class="o">//</span> <span class="n">Copy</span> <span class="n">result</span> <span class="n">back</span> <span class="n">to</span> <span class="n">host</span>
        <span class="n">std</span><span class="p">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">float2</span><span class="o">&gt;</span> <span class="n">y</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
        <span class="n">hipMemcpy</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">data</span><span class="p">(),</span> <span class="n">x</span><span class="p">,</span> <span class="n">Nbytes</span><span class="p">,</span> <span class="n">hipMemcpyDeviceToHost</span><span class="p">);</span>

        <span class="o">//</span> <span class="n">Print</span> <span class="n">results</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
                <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;, &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">endl</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="o">//</span> <span class="n">Free</span> <span class="n">device</span> <span class="n">buffer</span>
        <span class="n">hipFree</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>

        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="rocblas">
<h2>rocBLAS<a class="headerlink" href="#rocblas" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="https://github.com/ROCmSoftwarePlatform/rocBLAS">rocBLAS Github link</a></li>
</ul>
</div></blockquote>
<p>A BLAS implementation on top of AMD’s Radeon Open Compute <a class="reference external" href="http://rocm-documentation.readthedocs.io/en/latest/Installation_Guide/Installation-Guide.html">ROCm</a> runtime and toolchains. rocBLAS is implemented in the <a class="reference external" href="http://rocm-documentation.readthedocs.io/en/latest/Programming_Guides/Programming-Guides.html#hip-programing-guide">HIP</a> programming language and optimized for AMD’s latest discrete GPUs.</p>
<div class="section" id="id2">
<h3>Installing pre-built packages<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Download pre-built packages either from <a class="reference external" href="http://rocm-documentation.readthedocs.io/en/latest/Installation_Guide/Installation-Guide.html#installation-guide-ubuntu">ROCm’s package servers</a> or by clicking the github releases tab and manually downloading, which could be newer. Release notes are available for each release on the releases tab.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">update</span> <span class="o">&amp;&amp;</span> <span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">rocblas</span>
</pre></div>
</div>
</div>
<div class="section" id="quickstart-rocblas-build">
<h3>Quickstart rocBLAS build<a class="headerlink" href="#quickstart-rocblas-build" title="Permalink to this headline">¶</a></h3>
<p><strong>Bash helper build script (Ubuntu only)</strong></p>
<p>The root of this repository has a helper bash script install.sh to build and install rocBLAS on Ubuntu with a single command. It does not take a lot of options and hard-codes configuration that can be specified through invoking cmake directly, but it’s a great way to get started quickly and can serve as an example of how to build/install. A few commands in the script need sudo access, so it may prompt you for a password.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">install</span> <span class="o">-</span><span class="n">h</span> <span class="o">--</span> <span class="n">shows</span> <span class="n">help</span>
<span class="o">./</span><span class="n">install</span> <span class="o">-</span><span class="nb">id</span> <span class="o">--</span> <span class="n">build</span> <span class="n">library</span><span class="p">,</span> <span class="n">build</span> <span class="n">dependencies</span> <span class="ow">and</span> <span class="n">install</span> <span class="p">(</span><span class="o">-</span><span class="n">d</span> <span class="n">flag</span> <span class="n">only</span> <span class="n">needs</span> <span class="n">to</span> <span class="n">be</span> <span class="n">passed</span> <span class="n">once</span> <span class="n">on</span> <span class="n">a</span> <span class="n">system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="manual-build-all-supported-platforms">
<h3>Manual build (all supported platforms)<a class="headerlink" href="#manual-build-all-supported-platforms" title="Permalink to this headline">¶</a></h3>
<p>If you use a distro other than Ubuntu, or would like more control over the build process, the <a class="reference internal" href="../ROCm_Tools/rocblaswiki.html#rocblaswiki"><span class="std std-ref">rocblas build wiki</span></a> has helpful information on how to configure cmake and manually build.</p>
<p><strong>Functions supported</strong></p>
<p>A list of exported functions from rocblas can be found on the wiki</p>
</div>
<div class="section" id="rocblas-interface-examples">
<h3>rocBLAS interface examples<a class="headerlink" href="#rocblas-interface-examples" title="Permalink to this headline">¶</a></h3>
<p>In general, the rocBLAS interface is compatible with CPU oriented <a class="reference external" href="http://www.netlib.org/blas/">Netlib BLAS</a> and the cuBLAS-v2 API, with the explicit exception that traditional BLAS interfaces do not accept handles. The cuBLAS’ cublasHandle_t is replaced with rocblas_handle everywhere. Thus, porting a CUDA application which originally calls the cuBLAS API to a HIP application calling rocBLAS API should be relatively straightforward. For example, the rocBLAS SGEMV interface is</p>
</div>
<div class="section" id="gemv-api">
<h3>GEMV API<a class="headerlink" href="#gemv-api" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rocblas_status</span>
<span class="n">rocblas_sgemv</span><span class="p">(</span><span class="n">rocblas_handle</span> <span class="n">handle</span><span class="p">,</span>
              <span class="n">rocblas_operation</span> <span class="n">trans</span><span class="p">,</span>
              <span class="n">rocblas_int</span> <span class="n">m</span><span class="p">,</span> <span class="n">rocblas_int</span> <span class="n">n</span><span class="p">,</span>
              <span class="n">const</span> <span class="nb">float</span><span class="o">*</span> <span class="n">alpha</span><span class="p">,</span>
              <span class="n">const</span> <span class="nb">float</span><span class="o">*</span> <span class="n">A</span><span class="p">,</span> <span class="n">rocblas_int</span> <span class="n">lda</span><span class="p">,</span>
              <span class="n">const</span> <span class="nb">float</span><span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">rocblas_int</span> <span class="n">incx</span><span class="p">,</span>
              <span class="n">const</span> <span class="nb">float</span><span class="o">*</span> <span class="n">beta</span><span class="p">,</span>
              <span class="nb">float</span><span class="o">*</span> <span class="n">y</span><span class="p">,</span> <span class="n">rocblas_int</span> <span class="n">incy</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="batched-and-strided-gemm-api">
<h3>Batched and strided GEMM API<a class="headerlink" href="#batched-and-strided-gemm-api" title="Permalink to this headline">¶</a></h3>
<p>rocBLAS GEMM can process matrices in batches with regular strides. There are several permutations of these API’s, the following is an example that takes everything</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rocblas_status</span>
<span class="n">rocblas_sgemm_strided_batched</span><span class="p">(</span>
    <span class="n">rocblas_handle</span> <span class="n">handle</span><span class="p">,</span>
    <span class="n">rocblas_operation</span> <span class="n">transa</span><span class="p">,</span> <span class="n">rocblas_operation</span> <span class="n">transb</span><span class="p">,</span>
    <span class="n">rocblas_int</span> <span class="n">m</span><span class="p">,</span> <span class="n">rocblas_int</span> <span class="n">n</span><span class="p">,</span> <span class="n">rocblas_int</span> <span class="n">k</span><span class="p">,</span>
    <span class="n">const</span> <span class="nb">float</span><span class="o">*</span> <span class="n">alpha</span><span class="p">,</span>
    <span class="n">const</span> <span class="nb">float</span><span class="o">*</span> <span class="n">A</span><span class="p">,</span> <span class="n">rocblas_int</span> <span class="n">ls_a</span><span class="p">,</span> <span class="n">rocblas_int</span> <span class="n">ld_a</span><span class="p">,</span> <span class="n">rocblas_int</span> <span class="n">bs_a</span><span class="p">,</span>
    <span class="n">const</span> <span class="nb">float</span><span class="o">*</span> <span class="n">B</span><span class="p">,</span> <span class="n">rocblas_int</span> <span class="n">ls_b</span><span class="p">,</span> <span class="n">rocblas_int</span> <span class="n">ld_b</span><span class="p">,</span> <span class="n">rocblas_int</span> <span class="n">bs_b</span><span class="p">,</span>
    <span class="n">const</span> <span class="nb">float</span><span class="o">*</span> <span class="n">beta</span><span class="p">,</span>
          <span class="nb">float</span><span class="o">*</span> <span class="n">C</span><span class="p">,</span> <span class="n">rocblas_int</span> <span class="n">ls_c</span><span class="p">,</span> <span class="n">rocblas_int</span> <span class="n">ld_c</span><span class="p">,</span> <span class="n">rocblas_int</span> <span class="n">bs_c</span><span class="p">,</span>
    <span class="n">rocblas_int</span> <span class="n">batch_count</span> <span class="p">)</span>
</pre></div>
</div>
<p>rocBLAS assumes matrices A and vectors x, y are allocated in GPU memory space filled with data. Users are responsible for copying data from/to the host and device memory. HIP provides memcpy style API’s to facilitate data management.</p>
</div>
<div class="section" id="asynchronous-api">
<h3>Asynchronous API<a class="headerlink" href="#asynchronous-api" title="Permalink to this headline">¶</a></h3>
<p>Except a few routines (like TRSM) having memory allocation inside preventing asynchronicity, most of the library routines (like BLAS-1 SCAL, BLAS-2 GEMV, BLAS-3 GEMM) are configured to operate in asynchronous fashion with respect to CPU, meaning these library functions return immediately.</p>
<p>For more information regarding rocBLAS library and corresponding API documentation, refer <a class="reference external" href="https://rocblas.readthedocs.io/en/latest/">rocBLAS</a></p>
</div>
</div>
<div class="section" id="hipblas">
<h2>hipBLAS<a class="headerlink" href="#hipblas" title="Permalink to this headline">¶</a></h2>
<p>Please Refer here for Github link <a class="reference external" href="https://github.com/ROCmSoftwarePlatform/hipBLAS">hipBLAS</a></p>
<p>hipBLAS is a BLAS marshalling library, with multiple supported backends. It sits between the application and a ‘worker’ BLAS library, marshalling inputs into the backend library and marshalling results back to the application. hipBLAS exports an interface that does not require the client to change, regardless of the chosen backend. Currently, hipBLAS supports <a class="reference internal" href="../ROCm_Tools/rocblas.html#rocblas"><span class="std std-ref">rocBLAS</span></a> and <a class="reference external" href="https://developer.nvidia.com/cublas">cuBLAS</a> as backends.</p>
<div class="section" id="id6">
<h3>Installing pre-built packages<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>Download pre-built packages either from ROCm’s package servers or by clicking the github releases tab and manually downloading, which could be newer. Release notes are available for each release on the releases tab.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">update</span> <span class="o">&amp;&amp;</span> <span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">hipblas</span>
</pre></div>
</div>
</div>
<div class="section" id="quickstart-hipblas-build">
<h3>Quickstart hipBLAS build<a class="headerlink" href="#quickstart-hipblas-build" title="Permalink to this headline">¶</a></h3>
<p><strong>Bash helper build script (Ubuntu only)</strong></p>
<p>The root of this repository has a helper bash script install.sh to build and install hipBLAS on Ubuntu with a single command. It does not take a lot of options and hard-codes configuration that can be specified through invoking cmake directly, but it’s a great way to get started quickly and can serve as an example of how to build/install. A few commands in the script need sudo access, so it may prompt you for a password.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">install</span> <span class="o">-</span><span class="n">h</span> <span class="o">--</span> <span class="n">shows</span> <span class="n">help</span>
<span class="o">./</span><span class="n">install</span> <span class="o">-</span><span class="nb">id</span> <span class="o">--</span> <span class="n">build</span> <span class="n">library</span><span class="p">,</span> <span class="n">build</span> <span class="n">dependencies</span> <span class="ow">and</span> <span class="n">install</span> <span class="p">(</span><span class="o">-</span><span class="n">d</span> <span class="n">flag</span> <span class="n">only</span> <span class="n">needs</span> <span class="n">to</span> <span class="n">be</span> <span class="n">passed</span> <span class="n">once</span> <span class="n">on</span> <span class="n">a</span> <span class="n">system</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Manual build (all supported platforms)</strong></p>
<p>If you use a distro other than Ubuntu, or would like more control over the build process, the hipblas build wiki has helpful information on how to configure cmake and manually build.</p>
<p><strong>Functions supported</strong></p>
<p>A list of exported functions from hipblas can be found on the wiki</p>
</div>
<div class="section" id="hipblas-interface-examples">
<h3>hipBLAS interface examples<a class="headerlink" href="#hipblas-interface-examples" title="Permalink to this headline">¶</a></h3>
<p>The hipBLAS interface is compatible with rocBLAS and cuBLAS-v2 APIs. Porting a CUDA application which originally calls the cuBLAS API to an application calling hipBLAS API should be relatively straightforward. For example, the hipBLAS SGEMV interface is</p>
</div>
<div class="section" id="id7">
<h3>GEMV API<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hipblasStatus_t</span>
<span class="n">hipblasSgemv</span><span class="p">(</span> <span class="n">hipblasHandle_t</span> <span class="n">handle</span><span class="p">,</span>
             <span class="n">hipblasOperation_t</span> <span class="n">trans</span><span class="p">,</span>
             <span class="nb">int</span> <span class="n">m</span><span class="p">,</span> <span class="nb">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">const</span> <span class="nb">float</span> <span class="o">*</span><span class="n">alpha</span><span class="p">,</span>
             <span class="n">const</span> <span class="nb">float</span> <span class="o">*</span><span class="n">A</span><span class="p">,</span> <span class="nb">int</span> <span class="n">lda</span><span class="p">,</span>
             <span class="n">const</span> <span class="nb">float</span> <span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span> <span class="n">incx</span><span class="p">,</span> <span class="n">const</span> <span class="nb">float</span> <span class="o">*</span><span class="n">beta</span><span class="p">,</span>
             <span class="nb">float</span> <span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="nb">int</span> <span class="n">incy</span> <span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="id8">
<h3>Batched and strided GEMM API<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>hipBLAS GEMM can process matrices in batches with regular strides. There are several permutations of these API’s, the following is an example that takes everything</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hipblasStatus_t</span>
<span class="n">hipblasSgemmStridedBatched</span><span class="p">(</span> <span class="n">hipblasHandle_t</span> <span class="n">handle</span><span class="p">,</span>
             <span class="n">hipblasOperation_t</span> <span class="n">transa</span><span class="p">,</span> <span class="n">hipblasOperation_t</span> <span class="n">transb</span><span class="p">,</span>
             <span class="nb">int</span> <span class="n">m</span><span class="p">,</span> <span class="nb">int</span> <span class="n">n</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="n">const</span> <span class="nb">float</span> <span class="o">*</span><span class="n">alpha</span><span class="p">,</span>
             <span class="n">const</span> <span class="nb">float</span> <span class="o">*</span><span class="n">A</span><span class="p">,</span> <span class="nb">int</span> <span class="n">lda</span><span class="p">,</span> <span class="n">long</span> <span class="n">long</span> <span class="n">bsa</span><span class="p">,</span>
             <span class="n">const</span> <span class="nb">float</span> <span class="o">*</span><span class="n">B</span><span class="p">,</span> <span class="nb">int</span> <span class="n">ldb</span><span class="p">,</span> <span class="n">long</span> <span class="n">long</span> <span class="n">bsb</span><span class="p">,</span> <span class="n">const</span> <span class="nb">float</span> <span class="o">*</span><span class="n">beta</span><span class="p">,</span>
             <span class="nb">float</span> <span class="o">*</span><span class="n">C</span><span class="p">,</span> <span class="nb">int</span> <span class="n">ldc</span><span class="p">,</span> <span class="n">long</span> <span class="n">long</span> <span class="n">bsc</span><span class="p">,</span>
             <span class="nb">int</span> <span class="n">batchCount</span><span class="p">);</span>
</pre></div>
</div>
<p>hipBLAS assumes matrices A and vectors x, y are allocated in GPU memory space filled with data. Users are responsible for copying data from/to the host and device memory.</p>
</div>
</div>
<div class="section" id="hcrng">
<h2>hcRNG<a class="headerlink" href="#hcrng" title="Permalink to this headline">¶</a></h2>
<div class="section" id="introduction">
<h3>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h3>
<p>The hcRNG library is an implementation of uniform random number generators targeting the AMD heterogeneous hardware via HCC compiler runtime. The computational resources of underlying AMD heterogenous compute gets exposed and exploited through the HCC C++ frontend. Refer <a class="reference external" href="https://rocm-documentation.readthedocs.io/en/latest/ROCm_Tools/ROCm-Tools.html#hcc">here</a> for more details on HCC compiler.</p>
<p>The following list enumerates the current set of RNG generators that are supported so far.</p>
<blockquote>
<div><ul class="simple">
<li>MRG31k3p</li>
<li>MRG32k3a</li>
<li>LFSR113</li>
<li>Philox-4x32-10</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<p>Random number generator Mrg31k3p example:</p>
<p>file: Randomarray.cpp</p>
<p>#!c++</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>//This example is a simple random array generation and it compares host output with device output
//Random number generator Mrg31k3p
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;stdint.h&gt;
#include &lt;assert.h&gt;
#include &lt;hcRNG/mrg31k3p.h&gt;
#include &lt;hcRNG/hcRNG.h&gt;
#include &lt;hc.hpp&gt;
#include &lt;hc_am.hpp&gt;
using namespace hc;

int main()
{
      hcrngStatus status = HCRNG_SUCCESS;
      bool ispassed = 1;
      size_t streamBufferSize;
      // Number oi streams
      size_t streamCount = 10;
      //Number of random numbers to be generated
      //numberCount must be a multiple of streamCount
      size_t numberCount = 100;
      //Enumerate the list of accelerators
      std::vector&lt;hc::accelerator&gt;acc = hc::accelerator::get_all();
      accelerator_view accl_view = (acc[1].create_view());
      //Allocate memory for host pointers
      float *Random1 = (float*) malloc(sizeof(float) * numberCount);
      float *Random2 = (float*) malloc(sizeof(float) * numberCount);
      float *outBufferDevice = hc::am_alloc(sizeof(float) * numberCount, acc[1], 0);

      //Create streams
      hcrngMrg31k3pStream *streams = hcrngMrg31k3pCreateStreams(NULL, streamCount, &amp;streamBufferSize, NULL);
      hcrngMrg31k3pStream *streams_buffer = hc::am_alloc(sizeof(hcrngMrg31k3pStream) * streamCount, acc[1], 0);
      accl_view.copy(streams, streams_buffer, streamCount* sizeof(hcrngMrg31k3pStream));

      //Invoke random number generators in device (here strean_length and streams_per_thread arguments are default)
      status = hcrngMrg31k3pDeviceRandomU01Array_single(accl_view, streamCount, streams_buffer, numberCount, outBufferDevice);

      if(status) std::cout &lt;&lt; &quot;TEST FAILED&quot; &lt;&lt; std::endl;
      accl_view.copy(outBufferDevice, Random1, numberCount * sizeof(float));

      //Invoke random number generators in host
      for (size_t i = 0; i &lt; numberCount; i++)
        Random2[i] = hcrngMrg31k3pRandomU01(&amp;streams[i % streamCount]);
      // Compare host and device outputs
      for(int i =0; i &lt; numberCount; i++) {
          if (Random1[i] != Random2[i]) {
              ispassed = 0;
              std::cout &lt;&lt;&quot; RANDDEVICE[&quot; &lt;&lt; i&lt;&lt; &quot;] &quot; &lt;&lt; Random1[i] &lt;&lt; &quot;and RANDHOST[&quot; &lt;&lt; i &lt;&lt;&quot;] mismatches&quot;&lt;&lt; Random2[i] &lt;&lt;                   std::endl;
              break;
          }
          else
              continue;
      }
      if(!ispassed) std::cout &lt;&lt; &quot;TEST FAILED&quot; &lt;&lt; std::endl;

      //Free host resources
      free(Random1);
      free(Random2);
      //Release device resources
      hc::am_free(outBufferDevice);
      hc::am_free(streams_buffer);
      return 0;
}
</pre></div>
</div>
<ul>
<li><p class="first">Compiling the example code:</p>
<blockquote>
<div><p>/opt/hcc/bin/clang++ <cite>/opt/hcc/bin/hcc-config –cxxflags –ldflags</cite> -lhc_am -lhcrng Randomarray.cpp</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="installation">
<h3>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h3>
<p><strong>Installation steps</strong></p>
<p>The following are the steps to use the library</p>
<blockquote>
<div><ul class="simple">
<li>ROCM 2.0 Kernel, Driver and Compiler Installation (if not done until now)</li>
<li>Library installation.</li>
</ul>
</div></blockquote>
<p><strong>ROCM 2.0 Installation</strong></p>
<p>To Know more about ROCM refer <a class="reference external" href="https://rocm-documentation.readthedocs.io/en/latest/Current_Release_Notes/Current-Release-Notes.html">https://rocm-documentation.readthedocs.io/en/latest/Current_Release_Notes/Current-Release-Notes.html</a></p>
<p><strong>a. Installing Debian ROCM repositories</strong></p>
<p>Before proceeding, make sure to completely uninstall any pre-release ROCm packages.</p>
<p>Refer <a class="reference external" href="http://rocm-documentation.readthedocs.io/en/latest/Installation_Guide/Installation-Guide.html#removing-pre-release-packages">Here</a> for instructions to remove pre-release ROCM packages</p>
<p>Follow Steps to install rocm package</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="o">-</span><span class="n">qO</span> <span class="o">-</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">packages</span><span class="o">.</span><span class="n">amd</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">rocm</span><span class="o">/</span><span class="n">apt</span><span class="o">/</span><span class="n">debian</span><span class="o">/</span><span class="n">rocm</span><span class="o">.</span><span class="n">gpg</span><span class="o">.</span><span class="n">key</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">key</span> <span class="n">add</span> <span class="o">-</span>
<span class="n">sudo</span> <span class="n">sh</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;echo deb [arch=amd64] http://packages.amd.com/rocm/apt/debian/ xenial main &gt; /etc/apt/sources.list.d/rocm.list&#39;</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">rocm</span>
</pre></div>
</div>
<p>Then, make the ROCm kernel your default kernel. If using grub2 as your bootloader, you can edit the GRUB_DEFAULT variable in the following file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">default</span><span class="o">/</span><span class="n">grub</span>
<span class="n">sudo</span> <span class="n">update</span><span class="o">-</span><span class="n">grub</span>
</pre></div>
</div>
<p>and <strong>Reboot the system</strong></p>
<p><strong>b. Verifying the Installation</strong></p>
<p>Once Reboot, to verify that the ROCm stack completed successfully you can execute HSA vector_copy sample application:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">rocm</span><span class="o">/</span><span class="n">hsa</span><span class="o">/</span><span class="n">sample</span>
<span class="n">make</span>
<span class="o">./</span><span class="n">vector_copy</span>
</pre></div>
</div>
<p><strong>Library Installation</strong></p>
<p><strong>a. Install using Prebuilt debian</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">ROCmSoftwarePlatform</span><span class="o">/</span><span class="n">hcRNG</span><span class="o">/</span><span class="n">blob</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">pre</span><span class="o">-</span><span class="n">builds</span><span class="o">/</span><span class="n">hcrng</span><span class="o">-</span><span class="n">master</span><span class="o">-</span><span class="mi">184472</span><span class="n">e</span><span class="o">-</span><span class="n">Linux</span><span class="o">.</span><span class="n">deb</span>
<span class="n">sudo</span> <span class="n">dpkg</span> <span class="o">-</span><span class="n">i</span> <span class="n">hcrng</span><span class="o">-</span><span class="n">master</span><span class="o">-</span><span class="mi">184472</span><span class="n">e</span><span class="o">-</span><span class="n">Linux</span><span class="o">.</span><span class="n">deb</span>
</pre></div>
</div>
<p><strong>b. Build debian from source</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">ROCmSoftwarePlatform</span><span class="o">/</span><span class="n">hcRNG</span><span class="o">.</span><span class="n">git</span> <span class="o">&amp;&amp;</span> <span class="n">cd</span> <span class="n">hcRNG</span>
<span class="n">chmod</span> <span class="o">+</span><span class="n">x</span> <span class="n">build</span><span class="o">.</span><span class="n">sh</span> <span class="o">&amp;&amp;</span> <span class="o">./</span><span class="n">build</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p><strong>build.sh</strong> execution builds the library and generates a debian under build directory.</p>
</div>
<div class="section" id="key-features">
<h3>Key Features<a class="headerlink" href="#key-features" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li>Support for 4 commonly used uniform random number generators.</li>
<li>Single and Double precision.</li>
<li>Multiple streams, created on the host and generates random numbers either on the host or on computing devices.</li>
</ul>
</div></blockquote>
<p><strong>Prerequisites</strong></p>
<p>This section lists the known set of hardware and software requirements to build this library</p>
<p><strong>Hardware</strong></p>
<blockquote>
<div><ul class="simple">
<li>CPU: mainstream brand, Better if with &gt;=4 Cores Intel Haswell based CPU</li>
<li>System Memory &gt;= 4GB (Better if &gt;10GB for NN application over multiple GPUs)</li>
<li>Hard Drive &gt; 200GB (Better if SSD or NVMe driver for NN application over multiple GPUs)</li>
<li>Minimum GPU Memory (Global) &gt; 2GB</li>
</ul>
</div></blockquote>
<p><strong>GPU cards supported</strong></p>
<blockquote>
<div><ul class="simple">
<li>dGPU: AMD R9 Fury X, R9 Fury, R9 Nano</li>
<li>APU: AMD Kaveri or Carrizo</li>
</ul>
</div></blockquote>
<p><strong>AMD Driver and Runtime</strong></p>
<blockquote>
<div><ul class="simple">
<li>Radeon Open Compute Kernel (ROCK) driver : <a class="reference external" href="https://github.com/RadeonOpenCompute/ROCK-Kernel-Driver">https://github.com/RadeonOpenCompute/ROCK-Kernel-Driver</a></li>
<li>HSA runtime API and runtime for Boltzmann: <a class="reference external" href="https://github.com/RadeonOpenCompute/ROCR-Runtime">https://github.com/RadeonOpenCompute/ROCR-Runtime</a></li>
</ul>
</div></blockquote>
<p><strong>System software</strong></p>
<blockquote>
<div><ul class="simple">
<li>Ubuntu 14.04 trusty and later</li>
<li>GCC 4.6 and later</li>
<li>CPP 4.6 and later (come with GCC package)</li>
<li>python 2.7 and later</li>
<li>python-pip</li>
<li>BeautifulSoup4 (installed using python-pip)</li>
<li>HCC 0.9 from here</li>
</ul>
</div></blockquote>
<p><strong>Tools and Misc</strong></p>
<blockquote>
<div><ul class="simple">
<li>git 1.9 and later</li>
<li>cmake 2.6 and later (2.6 and 2.8 are tested)</li>
<li>firewall off</li>
<li>root privilege or user account in sudo group</li>
</ul>
</div></blockquote>
<p><strong>Ubuntu Packages</strong></p>
<blockquote>
<div><ul class="simple">
<li>libc6-dev-i386</li>
<li>liblapack-dev</li>
<li>graphicsmagick</li>
<li>libblas-dev</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="tested-environments">
<h3>Tested Environments<a class="headerlink" href="#tested-environments" title="Permalink to this headline">¶</a></h3>
<p><strong>Driver versions</strong></p>
<blockquote>
<div><ul class="simple">
<li><dl class="first docutils">
<dt>Boltzmann Early Release Driver + dGPU</dt>
<dd><ul class="first last">
<li>Radeon Open Compute Kernel (ROCK) driver : <a class="reference external" href="https://github.com/RadeonOpenCompute/ROCK-Kernel-Driver">https://github.com/RadeonOpenCompute/ROCK-Kernel-Driver</a></li>
<li>HSA runtime API and runtime for Boltzmann: <a class="reference external" href="https://github.com/RadeonOpenCompute/ROCR-Runtime">https://github.com/RadeonOpenCompute/ROCR-Runtime</a></li>
</ul>
</dd>
</dl>
</li>
<li>Traditional HSA driver + APU (Kaveri)</li>
</ul>
</div></blockquote>
<p><strong>GPU Cards</strong></p>
<blockquote>
<div><ul class="simple">
<li>Radeon R9 Nano</li>
<li>Radeon R9 FuryX</li>
<li>Radeon R9 Fury</li>
<li>Kaveri and Carizo APU</li>
</ul>
</div></blockquote>
<p><strong>Server System</strong></p>
<blockquote>
<div><ul class="simple">
<li>Supermicro SYS 2028GR-THT 6 R9 NANO</li>
<li>Supermicro SYS-1028GQ-TRT 4 R9 NANO</li>
<li>Supermicro SYS-7048GR-TR Tower 4 R9 NANO</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="unit-testing">
<h3>Unit testing<a class="headerlink" href="#unit-testing" title="Permalink to this headline">¶</a></h3>
<p><strong>a) Automated testing:</strong></p>
<p>Follow these steps to start automated testing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">hcRNG</span><span class="o">/</span>
<span class="o">./</span><span class="n">build</span><span class="o">.</span><span class="n">sh</span> <span class="o">--</span><span class="n">test</span><span class="o">=</span><span class="n">on</span>
</pre></div>
</div>
<p><strong>b) Manual testing:</strong></p>
<p>(i) Google testing (GTEST) with Functionality check</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">hcRNG</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">unit</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span>
</pre></div>
</div>
<p>All functions are tested against google test.</p>
</div>
</div>
<div class="section" id="hipeigen">
<h2>hipeigen<a class="headerlink" href="#hipeigen" title="Permalink to this headline">¶</a></h2>
<p>Eigen is a C++ template library for linear algebra: matrices, vectors, numerical solvers, and related algorithms.</p>
<p>For more information go to <a class="reference external" href="http://eigen.tuxfamily.org/">http://eigen.tuxfamily.org/</a>.</p>
<div class="section" id="installation-instructions-for-rocm">
<h3>Installation instructions for ROCm<a class="headerlink" href="#installation-instructions-for-rocm" title="Permalink to this headline">¶</a></h3>
<p>The ROCm Platform brings a rich foundation to advanced computing by seamlessly integrating the CPU and GPU with the goal of solving real-world problems.</p>
<p>To insatll rocm, please follow:</p>
</div>
<div class="section" id="installing-from-amd-rocm-repositories">
<h3>Installing from AMD ROCm repositories<a class="headerlink" href="#installing-from-amd-rocm-repositories" title="Permalink to this headline">¶</a></h3>
<p>AMD is hosting both debian and rpm repositories for the ROCm 2.0 packages. The packages in both repositories have been signed to ensure package integrity. Directions for each repository are given below:</p>
<ul class="simple">
<li>Debian repository - apt-get</li>
<li>Add the ROCm apt repository</li>
</ul>
<p>Complete installation steps of ROCm can be found <a class="reference external" href="https://rocm-documentation.readthedocs.io/en/latest/Installation_Guide/Installation-Guide.html">Here</a></p>
<p>or</p>
<p>For Debian based systems, like Ubuntu, configure the Debian ROCm repository as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="o">-</span><span class="n">qO</span> <span class="o">-</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">packages</span><span class="o">.</span><span class="n">amd</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">rocm</span><span class="o">/</span><span class="n">apt</span><span class="o">/</span><span class="n">debian</span><span class="o">/</span><span class="n">rocm</span><span class="o">.</span><span class="n">gpg</span><span class="o">.</span><span class="n">key</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">key</span> <span class="n">add</span> <span class="o">-</span>
<span class="n">sudo</span> <span class="n">sh</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;echo deb [arch=amd64] http://packages.amd.com/rocm/apt/debian/ xenial main &gt; /etc/apt/sources.list.d/rocm.list&#39;</span>
</pre></div>
</div>
<p>The gpg key might change, so it may need to be updated when installing a new release.</p>
<p><strong>Install or Update</strong></p>
<p>Next, update the apt-get repository list and install/update the rocm package:</p>
<blockquote>
<div><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Before proceeding, make sure to completely uninstall any pre-release ROCm packages</p>
</div>
</div></blockquote>
<dl class="docutils">
<dt>::</dt>
<dd>sudo apt-get update
sudo apt-get install rocm</dd>
</dl>
<p>Then, make the ROCm kernel your default kernel. If using grub2 as your bootloader, you can edit the GRUB_DEFAULT variable in the following file:</p>
<dl class="docutils">
<dt>::</dt>
<dd>sudo vi /etc/default/grub
sudo update-grub</dd>
</dl>
<p>Once complete, <strong>reboot your system.</strong></p>
<p>We recommend you verify your installation to make sure everything completed successfully.</p>
</div>
<div class="section" id="installation-instructions-for-eigen">
<h3>Installation instructions for Eigen<a class="headerlink" href="#installation-instructions-for-eigen" title="Permalink to this headline">¶</a></h3>
<p><strong>Explanation before starting</strong></p>
<p>Eigen consists only of header files, hence there is nothing to compile before you can use it. Moreover, these header files do not depend on your platform, they are the same for everybody.</p>
<p><strong>Method 1. Installing without using CMake</strong></p>
<p>You can use right away the headers in the Eigen/ subdirectory. In order to install, just copy this Eigen/ subdirectory to your favorite location. If you also want the unsupported features, copy the unsupported/ subdirectory too.</p>
<p><strong>Method 2. Installing using CMake</strong></p>
<p>Let’s call this directory ‘source_dir’ (where this INSTALL file is). Before starting, create another directory which we will call ‘build_dir’.</p>
<p>Do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">build_dir</span>
<span class="n">cmake</span> <span class="n">source_dir</span>
<span class="n">make</span> <span class="n">install</span>
</pre></div>
</div>
<p>The make install step may require administrator privileges.</p>
<p>You can adjust the installation destination (the “prefix”) by passing the -DCMAKE_INSTALL_PREFIX=myprefix option to cmake, as is explained in the message that cmake prints at the end.</p>
</div>
<div class="section" id="build-and-run-hipeigen-direct-tests">
<h3>Build and Run hipeigen direct tests<a class="headerlink" href="#build-and-run-hipeigen-direct-tests" title="Permalink to this headline">¶</a></h3>
<p>To build the direct tests for hipeigen:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd build_dir
make check -j $(nproc)
</pre></div>
</div>
<p>Note: All direct tests should pass with ROCm2.0</p>
</div>
</div>
<div class="section" id="clfft">
<h2>clFFT<a class="headerlink" href="#clfft" title="Permalink to this headline">¶</a></h2>
<p>For Github Repository <a class="reference external" href="https://github.com/clMathLibraries/clFFT">clFFT</a></p>
<p>clFFT is a software library containing FFT functions written in OpenCL. In addition to GPU devices, the library also supports running on CPU devices to facilitate debugging and heterogeneous programming.</p>
<p>Pre-built binaries are available here.</p>
<div class="section" id="introduction-to-clfft">
<h3>Introduction to clFFT<a class="headerlink" href="#introduction-to-clfft" title="Permalink to this headline">¶</a></h3>
<p>The FFT is an implementation of the Discrete Fourier Transform (DFT) that makes use of symmetries in the FFT definition to reduce the mathematical intensity required from O(N^2) to O(N log2(N)) when the sequence length N is the product of small prime factors. Currently, there is no standard API for FFT routines. Hardware vendors usually provide a set of high-performance FFTs optimized for their systems: no two vendors employ the same interfaces for their FFT routines. clFFT provides a set of FFT routines that are optimized for AMD graphics processors, but also are functional across CPU and other compute devices.</p>
<p>The clFFT library is an open source OpenCL library implementation of discrete Fast Fourier Transforms. The library:</p>
<blockquote>
<div><ul class="simple">
<li>provides a fast and accurate platform for calculating discrete FFTs.</li>
<li>works on CPU or GPU backends.</li>
<li>supports in-place or out-of-place transforms.</li>
<li>supports 1D, 2D, and 3D transforms with a batch size that can be greater than 1.</li>
<li>supports planar (real and complex components in separate arrays) and interleaved (real and complex components as a pair contiguous in memory) formats.</li>
<li>supports dimension lengths that can be any combination of powers of 2, 3, 5, 7, 11 and 13.</li>
<li>Supports single and double precision floating point formats.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="clfft-library-user-documentation">
<h3>clFFT library user documentation<a class="headerlink" href="#clfft-library-user-documentation" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://clmathlibraries.github.io/clFFT/">Library and API documentation</a> for developers is available online as a GitHub Pages website</p>
</div>
<div class="section" id="api-semantic-versioning">
<h3>API semantic versioning<a class="headerlink" href="#api-semantic-versioning" title="Permalink to this headline">¶</a></h3>
<p>Good software is typically the result of the loop of feedback and iteration; software interfaces no less so. clFFT follows the <a class="reference external" href="http://semver.org/">semantic</a> versioning guidelines. The version number used is of the form MAJOR.MINOR.PATCH.</p>
</div>
<div class="section" id="clfft-wiki">
<h3>clFFT Wiki<a class="headerlink" href="#clfft-wiki" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference external" href="https://github.com/clMathLibraries/clFFT/wiki">project wiki</a> contains helpful documentation, including a <a class="reference external" href="https://github.com/clMathLibraries/clFFT/wiki/Build">build primer</a></p>
</div>
<div class="section" id="contributing-code">
<h3>Contributing code<a class="headerlink" href="#contributing-code" title="Permalink to this headline">¶</a></h3>
<p>Please refer to and read the <a class="reference external" href="https://github.com/clMathLibraries/clFFT/blob/master/CONTRIBUTING.md">Contributing</a> document for guidelines on how to contribute code to this open source project. The code in the /master branch is considered to be stable, and all pull-requests must be made against the /develop branch.</p>
</div>
<div class="section" id="license">
<h3>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h3>
<p>The source for clFFT is licensed under the <a class="reference external" href="http://www.apache.org/licenses/LICENSE-2.0">Apache License</a> , Version 2.0</p>
</div>
<div class="section" id="id12">
<h3>Example<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h3>
<p>The following simple example shows how to use clFFT to compute a simple 1D forward transform</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;stdlib.h&gt;</span>

<span class="o">/*</span> <span class="n">No</span> <span class="n">need</span> <span class="n">to</span> <span class="n">explicitely</span> <span class="n">include</span> <span class="n">the</span> <span class="n">OpenCL</span> <span class="n">headers</span> <span class="o">*/</span>
<span class="c1">#include &lt;clFFT.h&gt;</span>

<span class="nb">int</span> <span class="n">main</span><span class="p">(</span> <span class="n">void</span> <span class="p">)</span>
<span class="p">{</span>
   <span class="n">cl_int</span> <span class="n">err</span><span class="p">;</span>
   <span class="n">cl_platform_id</span> <span class="n">platform</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="n">cl_device_id</span> <span class="n">device</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="n">cl_context_properties</span> <span class="n">props</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="n">CL_CONTEXT_PLATFORM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">};</span>
   <span class="n">cl_context</span> <span class="n">ctx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="n">cl_command_queue</span> <span class="n">queue</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="n">cl_mem</span> <span class="n">bufX</span><span class="p">;</span>
       <span class="nb">float</span> <span class="o">*</span><span class="n">X</span><span class="p">;</span>
   <span class="n">cl_event</span> <span class="n">event</span> <span class="o">=</span> <span class="n">NULL</span><span class="p">;</span>
   <span class="nb">int</span> <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
       <span class="n">size_t</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>

       <span class="o">/*</span> <span class="n">FFT</span> <span class="n">library</span> <span class="n">realted</span> <span class="n">declarations</span> <span class="o">*/</span>
       <span class="n">clfftPlanHandle</span> <span class="n">planHandle</span><span class="p">;</span>
       <span class="n">clfftDim</span> <span class="n">dim</span> <span class="o">=</span> <span class="n">CLFFT_1D</span><span class="p">;</span>
       <span class="n">size_t</span> <span class="n">clLengths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">N</span><span class="p">};</span>

   <span class="o">/*</span> <span class="n">Setup</span> <span class="n">OpenCL</span> <span class="n">environment</span><span class="o">.</span> <span class="o">*/</span>
   <span class="n">err</span> <span class="o">=</span> <span class="n">clGetPlatformIDs</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">platform</span><span class="p">,</span> <span class="n">NULL</span> <span class="p">);</span>
   <span class="n">err</span> <span class="o">=</span> <span class="n">clGetDeviceIDs</span><span class="p">(</span> <span class="n">platform</span><span class="p">,</span> <span class="n">CL_DEVICE_TYPE_GPU</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">device</span><span class="p">,</span> <span class="n">NULL</span> <span class="p">);</span>

   <span class="n">props</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">cl_context_properties</span><span class="p">)</span><span class="n">platform</span><span class="p">;</span>
   <span class="n">ctx</span> <span class="o">=</span> <span class="n">clCreateContext</span><span class="p">(</span> <span class="n">props</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">device</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">err</span> <span class="p">);</span>
   <span class="n">queue</span> <span class="o">=</span> <span class="n">clCreateCommandQueue</span><span class="p">(</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">err</span> <span class="p">);</span>

   <span class="o">/*</span> <span class="n">Setup</span> <span class="n">clFFT</span><span class="o">.</span> <span class="o">*/</span>
       <span class="n">clfftSetupData</span> <span class="n">fftSetup</span><span class="p">;</span>
       <span class="n">err</span> <span class="o">=</span> <span class="n">clfftInitSetupData</span><span class="p">(</span><span class="o">&amp;</span><span class="n">fftSetup</span><span class="p">);</span>
       <span class="n">err</span> <span class="o">=</span> <span class="n">clfftSetup</span><span class="p">(</span><span class="o">&amp;</span><span class="n">fftSetup</span><span class="p">);</span>

       <span class="o">/*</span> <span class="n">Allocate</span> <span class="n">host</span> <span class="o">&amp;</span> <span class="n">initialize</span> <span class="n">data</span><span class="o">.</span> <span class="o">*/</span>
       <span class="o">/*</span> <span class="n">Only</span> <span class="n">allocation</span> <span class="n">shown</span> <span class="k">for</span> <span class="n">simplicity</span><span class="o">.</span> <span class="o">*/</span>
       <span class="n">X</span> <span class="o">=</span> <span class="p">(</span><span class="nb">float</span> <span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">X</span><span class="p">));</span>

   <span class="o">/*</span> <span class="n">Prepare</span> <span class="n">OpenCL</span> <span class="n">memory</span> <span class="n">objects</span> <span class="ow">and</span> <span class="n">place</span> <span class="n">data</span> <span class="n">inside</span> <span class="n">them</span><span class="o">.</span> <span class="o">*/</span>
   <span class="n">bufX</span> <span class="o">=</span> <span class="n">clCreateBuffer</span><span class="p">(</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">CL_MEM_READ_WRITE</span><span class="p">,</span> <span class="n">N</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">X</span><span class="p">),</span> <span class="n">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">err</span> <span class="p">);</span>

   <span class="n">err</span> <span class="o">=</span> <span class="n">clEnqueueWriteBuffer</span><span class="p">(</span> <span class="n">queue</span><span class="p">,</span> <span class="n">bufX</span><span class="p">,</span> <span class="n">CL_TRUE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
       <span class="n">N</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span> <span class="o">*</span><span class="n">X</span> <span class="p">),</span> <span class="n">X</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span> <span class="p">);</span>

       <span class="o">/*</span> <span class="n">Create</span> <span class="n">a</span> <span class="n">default</span> <span class="n">plan</span> <span class="k">for</span> <span class="n">a</span> <span class="nb">complex</span> <span class="n">FFT</span><span class="o">.</span> <span class="o">*/</span>
       <span class="n">err</span> <span class="o">=</span> <span class="n">clfftCreateDefaultPlan</span><span class="p">(</span><span class="o">&amp;</span><span class="n">planHandle</span><span class="p">,</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">clLengths</span><span class="p">);</span>

       <span class="o">/*</span> <span class="n">Set</span> <span class="n">plan</span> <span class="n">parameters</span><span class="o">.</span> <span class="o">*/</span>
       <span class="n">err</span> <span class="o">=</span> <span class="n">clfftSetPlanPrecision</span><span class="p">(</span><span class="n">planHandle</span><span class="p">,</span> <span class="n">CLFFT_SINGLE</span><span class="p">);</span>
       <span class="n">err</span> <span class="o">=</span> <span class="n">clfftSetLayout</span><span class="p">(</span><span class="n">planHandle</span><span class="p">,</span> <span class="n">CLFFT_COMPLEX_INTERLEAVED</span><span class="p">,</span> <span class="n">CLFFT_COMPLEX_INTERLEAVED</span><span class="p">);</span>
       <span class="n">err</span> <span class="o">=</span> <span class="n">clfftSetResultLocation</span><span class="p">(</span><span class="n">planHandle</span><span class="p">,</span> <span class="n">CLFFT_INPLACE</span><span class="p">);</span>

   <span class="o">/*</span> <span class="n">Bake</span> <span class="n">the</span> <span class="n">plan</span><span class="o">.</span> <span class="o">*/</span>
       <span class="n">err</span> <span class="o">=</span> <span class="n">clfftBakePlan</span><span class="p">(</span><span class="n">planHandle</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">queue</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span><span class="p">);</span>

       <span class="o">/*</span> <span class="n">Execute</span> <span class="n">the</span> <span class="n">plan</span><span class="o">.</span> <span class="o">*/</span>
       <span class="n">err</span> <span class="o">=</span> <span class="n">clfftEnqueueTransform</span><span class="p">(</span><span class="n">planHandle</span><span class="p">,</span> <span class="n">CLFFT_FORWARD</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">queue</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">bufX</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span><span class="p">);</span>

       <span class="o">/*</span> <span class="n">Wait</span> <span class="k">for</span> <span class="n">calculations</span> <span class="n">to</span> <span class="n">be</span> <span class="n">finished</span><span class="o">.</span> <span class="o">*/</span>
       <span class="n">err</span> <span class="o">=</span> <span class="n">clFinish</span><span class="p">(</span><span class="n">queue</span><span class="p">);</span>

       <span class="o">/*</span> <span class="n">Fetch</span> <span class="n">results</span> <span class="n">of</span> <span class="n">calculations</span><span class="o">.</span> <span class="o">*/</span>
       <span class="n">err</span> <span class="o">=</span> <span class="n">clEnqueueReadBuffer</span><span class="p">(</span> <span class="n">queue</span><span class="p">,</span> <span class="n">bufX</span><span class="p">,</span> <span class="n">CL_TRUE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">N</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span> <span class="o">*</span><span class="n">X</span> <span class="p">),</span> <span class="n">X</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span> <span class="p">);</span>

   <span class="o">/*</span> <span class="n">Release</span> <span class="n">OpenCL</span> <span class="n">memory</span> <span class="n">objects</span><span class="o">.</span> <span class="o">*/</span>
   <span class="n">clReleaseMemObject</span><span class="p">(</span> <span class="n">bufX</span> <span class="p">);</span>

       <span class="n">free</span><span class="p">(</span><span class="n">X</span><span class="p">);</span>

       <span class="o">/*</span> <span class="n">Release</span> <span class="n">the</span> <span class="n">plan</span><span class="o">.</span> <span class="o">*/</span>
       <span class="n">err</span> <span class="o">=</span> <span class="n">clfftDestroyPlan</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">planHandle</span> <span class="p">);</span>

   <span class="o">/*</span> <span class="n">Release</span> <span class="n">clFFT</span> <span class="n">library</span><span class="o">.</span> <span class="o">*/</span>
   <span class="n">clfftTeardown</span><span class="p">(</span> <span class="p">);</span>

   <span class="o">/*</span> <span class="n">Release</span> <span class="n">OpenCL</span> <span class="n">working</span> <span class="n">objects</span><span class="o">.</span> <span class="o">*/</span>
   <span class="n">clReleaseCommandQueue</span><span class="p">(</span> <span class="n">queue</span> <span class="p">);</span>
   <span class="n">clReleaseContext</span><span class="p">(</span> <span class="n">ctx</span> <span class="p">);</span>

   <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
 <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="build-dependencies">
<h3>Build dependencies<a class="headerlink" href="#build-dependencies" title="Permalink to this headline">¶</a></h3>
<p><strong>Library for Windows</strong></p>
<p>To develop the clFFT library code on a Windows operating system, ensure to install the following packages on your system:</p>
<blockquote>
<div><ul class="simple">
<li>Windows® 7/8.1</li>
<li>Visual Studio 2012 or later</li>
<li>Latest CMake</li>
<li>An OpenCL SDK, such as APP SDK 3.0</li>
</ul>
</div></blockquote>
<p><strong>Library for Linux</strong></p>
<p>To develop the clFFT library code on a Linux operating system, ensure to install the following packages on your system:</p>
<blockquote>
<div><ul class="simple">
<li>GCC 4.6 and onwards</li>
<li>Latest CMake</li>
<li>An OpenCL SDK, such as APP SDK 3.0</li>
</ul>
</div></blockquote>
<p><strong>Library for Mac OSX</strong></p>
<p>To develop the clFFT library code on a Mac OS X, it is recommended to generate Unix makefiles with cmake.</p>
<p><strong>Test infrastructure</strong></p>
<p>To test the developed clFFT library code, ensure to install the following packages on your system:</p>
<blockquote>
<div><ul class="simple">
<li>Googletest v1.6</li>
<li>Latest FFTW</li>
<li>Latest Boost</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="performance-infrastructure">
<h3>Performance infrastructure<a class="headerlink" href="#performance-infrastructure" title="Permalink to this headline">¶</a></h3>
<p>To measure the performance of the clFFT library code, ensure that the Python package is installed on your system.</p>
</div>
</div>
<div class="section" id="clblas">
<h2>clBLAS<a class="headerlink" href="#clblas" title="Permalink to this headline">¶</a></h2>
<p>For Github repository <a class="reference external" href="https://github.com/clMathLibraries/clBLAS">clBLAS</a></p>
<p>This repository houses the code for the OpenCL™ BLAS portion of clMath. The complete set of BLAS level 1, 2 &amp; 3 routines is implemented. Please see Netlib BLAS for the list of supported routines. In addition to GPU devices, the library also supports running on CPU devices to facilitate debugging and multicore programming. APPML 1.12 is the most current generally available pre-packaged binary version of the library available for download for both Linux and Windows platforms.</p>
<p>The primary goal of clBLAS is to make it easier for developers to utilize the inherent performance and power efficiency benefits of heterogeneous computing. clBLAS interfaces do not hide nor wrap OpenCL interfaces, but rather leaves OpenCL state management to the control of the user to allow for maximum performance and flexibility. The clBLAS library does generate and enqueue optimized OpenCL kernels, relieving the user from the task of writing, optimizing and maintaining kernel code themselves.</p>
<p><strong>clBLAS update notes 01/2017</strong></p>
<p>v2.12 is a bugfix release as a rollup of all fixes in /develop branch
Thanks to &#64;pavanky, &#64;iotamudelta, &#64;shahsan10, &#64;psyhtest, &#64;haahh, &#64;hughperkins, &#64;tfauck &#64;abhiShandy, &#64;IvanVergiliev, &#64;zougloub, &#64;mgates3 for contributions to clBLAS v2.12
Summary of fixes available to read on the releases tab</p>
<div class="section" id="clblas-library-user-documentation">
<h3>clBLAS library user documentation<a class="headerlink" href="#clblas-library-user-documentation" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://clmathlibraries.github.io/clBLAS/">Library and API documentation</a> for developers is available online as a GitHub Pages website</p>
<p><strong>clBLAS Wiki</strong></p>
<p>The project <a class="reference external" href="https://github.com/clMathLibraries/clBLAS/wiki">wiki</a> contains helpful documentation, including a <a class="reference external" href="https://github.com/clMathLibraries/clBLAS/wiki">build primer</a></p>
<p><strong>Contributing code</strong></p>
<p>Please refer to and read the <a class="reference external" href="https://github.com/clMathLibraries/clBLAS/blob/master/CONTRIBUTING.md">Contributing document</a> for guidelines on how to contribute code to this open source project. The code in the /master branch is considered to be stable, and all pull-requests should be made against the /develop branch.</p>
</div>
<div class="section" id="id16">
<h3>License<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h3>
<p>The source for clBLAS is licensed under the Apache License, Version 2.0</p>
</div>
<div class="section" id="id17">
<h3>Example<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h3>
<p>The simple example below shows how to use clBLAS to compute an OpenCL accelerated SGEMM</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;sys/types.h&gt;</span>
<span class="c1">#include &lt;stdio.h&gt;</span>

<span class="o">/*</span> <span class="n">Include</span> <span class="n">the</span> <span class="n">clBLAS</span> <span class="n">header</span><span class="o">.</span> <span class="n">It</span> <span class="n">includes</span> <span class="n">the</span> <span class="n">appropriate</span> <span class="n">OpenCL</span> <span class="n">headers</span> <span class="o">*/</span>
<span class="c1">#include &lt;clBLAS.h&gt;</span>

<span class="o">/*</span> <span class="n">This</span> <span class="n">example</span> <span class="n">uses</span> <span class="n">predefined</span> <span class="n">matrices</span> <span class="ow">and</span> <span class="n">their</span> <span class="n">characteristics</span> <span class="k">for</span>
 <span class="o">*</span> <span class="n">simplicity</span> <span class="n">purpose</span><span class="o">.</span>
<span class="o">*/</span>

<span class="c1">#define M  4</span>
<span class="c1">#define N  3</span>
<span class="c1">#define K  5</span>

<span class="n">static</span> <span class="n">const</span> <span class="n">cl_float</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>

<span class="n">static</span> <span class="n">const</span> <span class="n">cl_float</span> <span class="n">A</span><span class="p">[</span><span class="n">M</span><span class="o">*</span><span class="n">K</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span>
<span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span>
<span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span>
<span class="mi">41</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span>
<span class="p">};</span>
<span class="n">static</span> <span class="n">const</span> <span class="n">size_t</span> <span class="n">lda</span> <span class="o">=</span> <span class="n">K</span><span class="p">;</span>        <span class="o">/*</span> <span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span> <span class="n">lda</span> <span class="o">=</span> <span class="n">K</span> <span class="o">*/</span>

<span class="n">static</span> <span class="n">const</span> <span class="n">cl_float</span> <span class="n">B</span><span class="p">[</span><span class="n">K</span><span class="o">*</span><span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span>
<span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span>
<span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span>
<span class="mi">41</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span>
<span class="mi">51</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span>
<span class="p">};</span>
<span class="n">static</span> <span class="n">const</span> <span class="n">size_t</span> <span class="n">ldb</span> <span class="o">=</span> <span class="n">N</span><span class="p">;</span>        <span class="o">/*</span> <span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span> <span class="n">ldb</span> <span class="o">=</span> <span class="n">N</span> <span class="o">*/</span>

<span class="n">static</span> <span class="n">const</span> <span class="n">cl_float</span> <span class="n">beta</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>

<span class="n">static</span> <span class="n">cl_float</span> <span class="n">C</span><span class="p">[</span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span>
    <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span>
    <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span>
    <span class="mi">41</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span>
<span class="p">};</span>
<span class="n">static</span> <span class="n">const</span> <span class="n">size_t</span> <span class="n">ldc</span> <span class="o">=</span> <span class="n">N</span><span class="p">;</span>        <span class="o">/*</span> <span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span> <span class="n">ldc</span> <span class="o">=</span> <span class="n">N</span> <span class="o">*/</span>

<span class="n">static</span> <span class="n">cl_float</span> <span class="n">result</span><span class="p">[</span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="p">];</span>

<span class="nb">int</span> <span class="n">main</span><span class="p">(</span> <span class="n">void</span> <span class="p">)</span>
<span class="p">{</span>
<span class="n">cl_int</span> <span class="n">err</span><span class="p">;</span>
<span class="n">cl_platform_id</span> <span class="n">platform</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">cl_device_id</span> <span class="n">device</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">cl_context_properties</span> <span class="n">props</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="n">CL_CONTEXT_PLATFORM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">};</span>
<span class="n">cl_context</span> <span class="n">ctx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">cl_command_queue</span> <span class="n">queue</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">cl_mem</span> <span class="n">bufA</span><span class="p">,</span> <span class="n">bufB</span><span class="p">,</span> <span class="n">bufC</span><span class="p">;</span>
<span class="n">cl_event</span> <span class="n">event</span> <span class="o">=</span> <span class="n">NULL</span><span class="p">;</span>
<span class="nb">int</span> <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="o">/*</span> <span class="n">Setup</span> <span class="n">OpenCL</span> <span class="n">environment</span><span class="o">.</span> <span class="o">*/</span>
<span class="n">err</span> <span class="o">=</span> <span class="n">clGetPlatformIDs</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">platform</span><span class="p">,</span> <span class="n">NULL</span> <span class="p">);</span>
<span class="n">err</span> <span class="o">=</span> <span class="n">clGetDeviceIDs</span><span class="p">(</span> <span class="n">platform</span><span class="p">,</span> <span class="n">CL_DEVICE_TYPE_GPU</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">device</span><span class="p">,</span> <span class="n">NULL</span> <span class="p">);</span>

<span class="n">props</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">cl_context_properties</span><span class="p">)</span><span class="n">platform</span><span class="p">;</span>
<span class="n">ctx</span> <span class="o">=</span> <span class="n">clCreateContext</span><span class="p">(</span> <span class="n">props</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">device</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">err</span> <span class="p">);</span>
<span class="n">queue</span> <span class="o">=</span> <span class="n">clCreateCommandQueue</span><span class="p">(</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">err</span> <span class="p">);</span>

<span class="o">/*</span> <span class="n">Setup</span> <span class="n">clBLAS</span> <span class="o">*/</span>
<span class="n">err</span> <span class="o">=</span> <span class="n">clblasSetup</span><span class="p">(</span> <span class="p">);</span>

<span class="o">/*</span> <span class="n">Prepare</span> <span class="n">OpenCL</span> <span class="n">memory</span> <span class="n">objects</span> <span class="ow">and</span> <span class="n">place</span> <span class="n">matrices</span> <span class="n">inside</span> <span class="n">them</span><span class="o">.</span> <span class="o">*/</span>
<span class="n">bufA</span> <span class="o">=</span> <span class="n">clCreateBuffer</span><span class="p">(</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">CL_MEM_READ_ONLY</span><span class="p">,</span> <span class="n">M</span> <span class="o">*</span> <span class="n">K</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">A</span><span class="p">),</span>
                      <span class="n">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">err</span> <span class="p">);</span>
<span class="n">bufB</span> <span class="o">=</span> <span class="n">clCreateBuffer</span><span class="p">(</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">CL_MEM_READ_ONLY</span><span class="p">,</span> <span class="n">K</span> <span class="o">*</span> <span class="n">N</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">B</span><span class="p">),</span>
                      <span class="n">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">err</span> <span class="p">);</span>
<span class="n">bufC</span> <span class="o">=</span> <span class="n">clCreateBuffer</span><span class="p">(</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">CL_MEM_READ_WRITE</span><span class="p">,</span> <span class="n">M</span> <span class="o">*</span> <span class="n">N</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">C</span><span class="p">),</span>
                      <span class="n">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">err</span> <span class="p">);</span>

<span class="n">err</span> <span class="o">=</span> <span class="n">clEnqueueWriteBuffer</span><span class="p">(</span> <span class="n">queue</span><span class="p">,</span> <span class="n">bufA</span><span class="p">,</span> <span class="n">CL_TRUE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">M</span> <span class="o">*</span> <span class="n">K</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span> <span class="o">*</span><span class="n">A</span> <span class="p">),</span> <span class="n">A</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span> <span class="p">);</span>
<span class="n">err</span> <span class="o">=</span> <span class="n">clEnqueueWriteBuffer</span><span class="p">(</span> <span class="n">queue</span><span class="p">,</span> <span class="n">bufB</span><span class="p">,</span> <span class="n">CL_TRUE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">K</span> <span class="o">*</span> <span class="n">N</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span> <span class="o">*</span><span class="n">B</span> <span class="p">),</span> <span class="n">B</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span> <span class="p">);</span>
<span class="n">err</span> <span class="o">=</span> <span class="n">clEnqueueWriteBuffer</span><span class="p">(</span> <span class="n">queue</span><span class="p">,</span> <span class="n">bufC</span><span class="p">,</span> <span class="n">CL_TRUE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">M</span> <span class="o">*</span> <span class="n">N</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span> <span class="o">*</span><span class="n">C</span> <span class="p">),</span> <span class="n">C</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span> <span class="p">);</span>

    <span class="o">/*</span> <span class="n">Call</span> <span class="n">clBLAS</span> <span class="n">extended</span> <span class="n">function</span><span class="o">.</span> <span class="n">Perform</span> <span class="n">gemm</span> <span class="k">for</span> <span class="n">the</span> <span class="n">lower</span> <span class="n">right</span> <span class="n">sub</span><span class="o">-</span><span class="n">matrices</span> <span class="o">*/</span>
    <span class="n">err</span> <span class="o">=</span> <span class="n">clblasSgemm</span><span class="p">(</span> <span class="n">clblasRowMajor</span><span class="p">,</span> <span class="n">clblasNoTrans</span><span class="p">,</span> <span class="n">clblasNoTrans</span><span class="p">,</span>
                            <span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span>
                            <span class="n">alpha</span><span class="p">,</span> <span class="n">bufA</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lda</span><span class="p">,</span>
                            <span class="n">bufB</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ldb</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span>
                            <span class="n">bufC</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ldc</span><span class="p">,</span>
                            <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">queue</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">event</span> <span class="p">);</span>

<span class="o">/*</span> <span class="n">Wait</span> <span class="k">for</span> <span class="n">calculations</span> <span class="n">to</span> <span class="n">be</span> <span class="n">finished</span><span class="o">.</span> <span class="o">*/</span>
<span class="n">err</span> <span class="o">=</span> <span class="n">clWaitForEvents</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">event</span> <span class="p">);</span>

<span class="o">/*</span> <span class="n">Fetch</span> <span class="n">results</span> <span class="n">of</span> <span class="n">calculations</span> <span class="kn">from</span> <span class="nn">GPU</span> <span class="n">memory</span><span class="o">.</span> <span class="o">*/</span>
<span class="n">err</span> <span class="o">=</span> <span class="n">clEnqueueReadBuffer</span><span class="p">(</span> <span class="n">queue</span><span class="p">,</span> <span class="n">bufC</span><span class="p">,</span> <span class="n">CL_TRUE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                            <span class="n">M</span> <span class="o">*</span> <span class="n">N</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">result</span><span class="p">),</span>
                            <span class="n">result</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span> <span class="p">);</span>

<span class="o">/*</span> <span class="n">Release</span> <span class="n">OpenCL</span> <span class="n">memory</span> <span class="n">objects</span><span class="o">.</span> <span class="o">*/</span>
<span class="n">clReleaseMemObject</span><span class="p">(</span> <span class="n">bufC</span> <span class="p">);</span>
<span class="n">clReleaseMemObject</span><span class="p">(</span> <span class="n">bufB</span> <span class="p">);</span>
<span class="n">clReleaseMemObject</span><span class="p">(</span> <span class="n">bufA</span> <span class="p">);</span>

<span class="o">/*</span> <span class="n">Finalize</span> <span class="n">work</span> <span class="k">with</span> <span class="n">clBLAS</span> <span class="o">*/</span>
<span class="n">clblasTeardown</span><span class="p">(</span> <span class="p">);</span>

<span class="o">/*</span> <span class="n">Release</span> <span class="n">OpenCL</span> <span class="n">working</span> <span class="n">objects</span><span class="o">.</span> <span class="o">*/</span>
<span class="n">clReleaseCommandQueue</span><span class="p">(</span> <span class="n">queue</span> <span class="p">);</span>
<span class="n">clReleaseContext</span><span class="p">(</span> <span class="n">ctx</span> <span class="p">);</span>

<span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id18">
<h3>Build dependencies<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h3>
<p><strong>Library for Windows</strong></p>
<blockquote>
<div><ul class="simple">
<li>Windows® 7/8</li>
<li>Visual Studio 2010 SP1, 2012</li>
<li>An OpenCL SDK, such as APP SDK 2.8</li>
<li>Latest CMake</li>
</ul>
</div></blockquote>
<p><strong>Library for Linux</strong></p>
<blockquote>
<div><ul class="simple">
<li>GCC 4.6 and onwards</li>
<li>An OpenCL SDK, such as APP SDK 2.9</li>
<li>Latest CMake</li>
</ul>
</div></blockquote>
<p><strong>Library for Mac OSX</strong></p>
<blockquote>
<div><ul class="simple">
<li>Recommended to generate Unix makefiles with cmake</li>
</ul>
</div></blockquote>
<p><strong>Test infrastructure</strong></p>
<blockquote>
<div><ul class="simple">
<li>Googletest v1.6</li>
<li>Latest Boost</li>
<li>CPU BLAS</li>
<li>Netlib CBLAS (recommended) Ubuntu: install by “apt-get install libblas-dev” Windows: download &amp; install lapack-3.6.0 which comes     with CBLAS</li>
<li>or ACML on windows/linux; Accelerate on Mac OSX</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="id19">
<h3>Performance infrastructure<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h3>
<p>Python</p>
</div>
</div>
<div class="section" id="clsparse">
<h2>clSPARSE<a class="headerlink" href="#clsparse" title="Permalink to this headline">¶</a></h2>
<p>For Github repository <a class="reference external" href="https://github.com/clMathLibraries/clSPARSE">clSPARSE</a></p>
<p>an OpenCL™ library implementing Sparse linear algebra routines. This project is a result of a collaboration between <a class="reference external" href="http://www.amd.com/en">AMD Inc.</a> and <a class="reference external" href="http://www.vratis.com/">Vratis Ltd.</a>.</p>
<div class="section" id="what-s-new-in-clsparse-v0-10-1">
<h3>What’s new in clSPARSE v0.10.1<a class="headerlink" href="#what-s-new-in-clsparse-v0-10-1" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><dl class="first docutils">
<dt>bug fix release</dt>
<dd><ul class="first last">
<li>Fixes for travis builds</li>
<li>Fix to the matrix market reader in the cuSPARSE benchmark to synchronize with the regular MM reader</li>
<li>Replace cl.hpp with cl2.hpp (thanks to arrayfire)</li>
<li><dl class="first docutils">
<dt>Fixes for the Nvidia platform; tested 352.79</dt>
<dd><ul class="first last">
<li>Fixed buffer overruns in CSR-Adaptive kernels</li>
<li>Fix invalid memory access on Nvidia GPUs in CSR-Adaptive SpMV kernel</li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="clsparse-features">
<h3>clSPARSE features<a class="headerlink" href="#clsparse-features" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li>Sparse Matrix - dense Vector multiply (SpM-dV)</li>
<li>Sparse Matrix - dense Matrix multiply (SpM-dM)</li>
<li>Sparse Matrix - Sparse Matrix multiply Sparse Matrix Multiply(SpGEMM) - Single Precision</li>
<li>Iterative conjugate gradient solver (CG)</li>
<li>Iterative biconjugate gradient stabilized solver (BiCGStab)</li>
<li>Dense to CSR conversions (&amp; converse)</li>
<li>COO to CSR conversions (&amp; converse)</li>
<li>Functions to read matrix market files in COO or CSR format</li>
</ul>
</div></blockquote>
<p>True in spirit with the other clMath libraries, clSPARSE exports a “C” interface to allow projects to build wrappers around clSPARSE in any language they need. A great deal of thought and effort went into designing the API’s to make them less ‘cluttered’ compared to the older clMath libraries. OpenCL state is not explicitly passed through the API, which enables the library to be forward compatible when users are ready to switch from OpenCL 1.2 to OpenCL 2.0 3</p>
</div>
<div class="section" id="id21">
<h3>API semantic versioning<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h3>
<p>Good software is typically the result of iteration and feedback. clSPARSE follows the <a class="reference external" href="http://semver.org/">semantic</a> versioning guidelines, and while the major version number remains ‘0’, the public API should not be considered stable. We release clSPARSE as beta software (0.y.z) early to the community to elicit feedback and comment. This comes with the expectation that with feedback, we may incorporate breaking changes to the API that might require early users to recompile, or rewrite portions of their code as we iterate on the design.</p>
<p><strong>clSPARSE Wiki</strong></p>
<p>The <a class="reference external" href="https://github.com/clMathLibraries/clSPARSE/wiki">project wiki</a> contains helpful documentation.
A <a class="reference external" href="https://github.com/clMathLibraries/clSPARSE/wiki/Build">build primer</a> is available, which describes how to use cmake to generate platforms specific build files</p>
<p><strong>Samples</strong></p>
<p>clSPARSE contains a directory of simple <a class="reference external" href="https://github.com/clMathLibraries/clSPARSE/tree/master/samples">OpenCL samples</a> that demonstrate the use of the API in both C and C++. The <a class="reference external" href="https://blog.kitware.com/wp-content/uploads/2016/01/kitware_quarterly1009.pdf">superbuild</a> script for clSPARSE also builds the samples as an external project, to demonstrate how an application would find and link to clSPARSE with cmake.</p>
<p><strong>clSPARSE library documentation</strong></p>
<p>API documentation is available at <a class="reference external" href="http://clmathlibraries.github.io/clSPARSE/">http://clmathlibraries.github.io/clSPARSE/</a>. The samples give an excellent starting point to basic library operations.</p>
<p><strong>Contributing code</strong></p>
<p>Please refer to and read the <a class="reference external" href="https://github.com/clMathLibraries/clSPARSE/blob/master/CONTRIBUTING.md">Contributing</a> document for guidelines on how to contribute code to this open source project. Code in the /master branch is considered to be stable and new library releases are made when commits are merged into /master. Active development and pull-requests should be made to the develop branch.</p>
</div>
<div class="section" id="id26">
<h3>License<a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h3>
<p>clSPARSE is licensed under the <a class="reference external" href="http://www.apache.org/licenses/LICENSE-2.0">Apache License</a>, Version 2.0</p>
<p><strong>Compiling for Windows</strong></p>
<blockquote>
<div><ul class="simple">
<li>Windows® 7/8</li>
<li>Visual Studio 2013 and above</li>
<li>CMake 2.8.12 (download from <a class="reference external" href="http://www.cmake.org/download/">Kitware</a>)</li>
<li>Solution (.sln) or</li>
<li>Nmake makefiles</li>
<li>An OpenCL SDK, such as APP SDK 3.0</li>
</ul>
</div></blockquote>
<p><strong>Compiling for Linux</strong></p>
<blockquote>
<div><ul class="simple">
<li>GCC 4.8 and above</li>
<li>CMake 2.8.12 (install with distro package manager )</li>
<li><dl class="first docutils">
<dt>Unix makefiles or</dt>
<dd><ul class="first last">
<li>KDevelop or</li>
<li>QT Creator</li>
<li>An OpenCL SDK, such as APP SDK 3.0</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p><strong>Compiling for Mac OSX</strong></p>
<blockquote>
<div><ul class="simple">
<li>CMake 2.8.12 (install via brew)</li>
<li>Unix makefiles or</li>
<li>XCode</li>
<li>An OpenCL SDK (installed via xcode-select –install)</li>
</ul>
</div></blockquote>
<p><strong>Bench &amp; Test infrastructure dependencies</strong></p>
<blockquote>
<div><ul class="simple">
<li>Googletest v1.7</li>
<li>Boost v1.58</li>
<li>Footnotes</li>
</ul>
</div></blockquote>
<p>[1]: Changed to reflect CppCoreGuidelines: <a class="reference external" href="http://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines.html#a-namerf-out-multia-f21-to-return-multiple-out-values-prefer-returning-a-tuple-or-struct">F.21</a></p>
<p>[2]: Changed to reflect CppCoreGuidelines: <a class="reference external" href="http://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines.html#a-namerl-namea-nl8-use-a-consistent-naming-style">NL.8</a></p>
<p>[3]: OpenCL 2.0 support is not yet fully implemented; only the interfaces have been designed</p>
</div>
</div>
<div class="section" id="clrng">
<h2>clRNG<a class="headerlink" href="#clrng" title="Permalink to this headline">¶</a></h2>
<p>For Github repository <a class="reference external" href="https://github.com/clMathLibraries/clRNG">clRNG</a></p>
<p>A library for uniform random number generation in OpenCL.</p>
<p>Streams of random numbers act as virtual random number generators. They can be created on the host computer in unlimited numbers, and then used either on the host or on computing devices by work items to generate random numbers. Each stream also has equally-spaced substreams, which are occasionally useful. The API is currently implemented for four different RNGs, namely the MRG31k3p, MRG32k3a, LFSR113 and Philox-4×32-10 generators.</p>
<div class="section" id="what-s-new">
<h3>What’s New<a class="headerlink" href="#what-s-new" title="Permalink to this headline">¶</a></h3>
<p>Libraries related to clRNG, for probability distributions and quasi-Monte Carlo methods, are available:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="https://github.com/umontreal-simul/clProbDist">clProbDist</a></li>
<li><a class="reference external" href="https://github.com/umontreal-simul/clQMC">clQMC</a></li>
</ul>
</div></blockquote>
<p><strong>Releases</strong></p>
<p>The first public version of clRNG is v1.0.0 beta. Please go to <a class="reference external" href="https://github.com/clMathLibraries/clRNG/releases">releases</a> for downloads.</p>
</div>
<div class="section" id="building">
<h3>Building<a class="headerlink" href="#building" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ol class="arabic">
<li><dl class="first docutils">
<dt>Install the runtime dependency:</dt>
<dd><ul class="first last simple">
<li>An OpenCL SDK, such as APP SDK.</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">Install the build dependencies:</p>
<blockquote>
<div><ul class="simple">
<li>The CMake cross-platform build system. Visual Studio users can use CMake Tools for Visual Studio.</li>
<li>A recent C compiler, such as <a class="reference external" href="https://gcc.gnu.org/">GCC 4.9</a> , or Visual Studio 2013.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Get the clRNG source code.</p>
</li>
<li><p class="first">Configure the project using <a class="reference external" href="https://cmake.org/">CMake</a> (to generate standard makefiles) or <a class="reference external" href="https://cmaketools.codeplex.com/">CMake Tools for Visual Studio</a> (to generate solution and project files).</p>
</li>
<li><p class="first">Build the project.</p>
</li>
<li><p class="first">Install the project (by default, the library will be installed in the package directory under the build directory).</p>
</li>
<li><p class="first">Point the environment variable CLRNG_ROOT to the installation directory, i.e., the directory under which include/clRNG can be       found. This step is optional if the library is installed under /usr, which is the default.</p>
</li>
<li><p class="first">In order to execute the example programs (under the bin subdirectory of the installation directory) or to link clRNG into other     software, the dynamic linker must be informed where to find the clRNG shared library. The name and location of the shared library         generally depend on the platform.</p>
</li>
<li><p class="first">Optionally run the tests.</p>
</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="example-instructions-for-linux">
<h3>Example Instructions for Linux<a class="headerlink" href="#example-instructions-for-linux" title="Permalink to this headline">¶</a></h3>
<p>On a 64-bit Linux platform, steps 3 through 9 from above, executed in a Bash-compatible shell, could consist of:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/clMathLibraries/clRNG.git
mkdir clRNG.build; cd clRNG.build; cmake ../clRNG/src
make
make install
export CLRNG_ROOT=$PWD/package
export LD_LIBRARY_PATH=$CLRNG_ROOT/lib64:$LD_LIBRARY_PATH
$CLRNG_ROOT/bin/CTest
</pre></div>
</div>
<p><strong>Examples</strong></p>
<p>Examples can be found in src/client. The compiled client program examples can be found under the bin subdirectory of the installation package ($CLRNG_ROOT/bin under Linux). Note that the examples expect an OpenCL GPU device to be available.</p>
<p><strong>Simple example</strong></p>
<p>The simple example below shows how to use clRNG to generate random numbers by directly using device side headers (.clh) in your OpenCL kernel.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;stdlib.h&gt;</span>
<span class="c1">#include &lt;string.h&gt;</span>

<span class="c1">#include &quot;clRNG/clRNG.h&quot;</span>
<span class="c1">#include &quot;clRNG/mrg31k3p.h&quot;</span>

<span class="nb">int</span> <span class="n">main</span><span class="p">(</span> <span class="n">void</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">cl_int</span> <span class="n">err</span><span class="p">;</span>
    <span class="n">cl_platform_id</span> <span class="n">platform</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">cl_device_id</span> <span class="n">device</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">cl_context_properties</span> <span class="n">props</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="n">CL_CONTEXT_PLATFORM</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">};</span>
    <span class="n">cl_context</span> <span class="n">ctx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">cl_command_queue</span> <span class="n">queue</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">cl_program</span> <span class="n">program</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">cl_kernel</span> <span class="n">kernel</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">cl_event</span> <span class="n">event</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">cl_mem</span> <span class="n">bufIn</span><span class="p">,</span> <span class="n">bufOut</span><span class="p">;</span>
    <span class="nb">float</span> <span class="o">*</span><span class="n">out</span><span class="p">;</span>
    <span class="n">char</span> <span class="o">*</span><span class="n">clrng_root</span><span class="p">;</span>
    <span class="n">char</span> <span class="n">include_str</span><span class="p">[</span><span class="mi">1024</span><span class="p">];</span>
    <span class="n">char</span> <span class="n">build_log</span><span class="p">[</span><span class="mi">4096</span><span class="p">];</span>
    <span class="n">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">size_t</span> <span class="n">numWorkItems</span> <span class="o">=</span> <span class="mi">64</span><span class="p">;</span>
    <span class="n">clrngMrg31k3pStream</span> <span class="o">*</span><span class="n">streams</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">size_t</span> <span class="n">streamBufferSize</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">size_t</span> <span class="n">kernelLines</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="o">/*</span> <span class="n">Sample</span> <span class="n">kernel</span> <span class="n">that</span> <span class="n">calls</span> <span class="n">clRNG</span> <span class="n">device</span><span class="o">-</span><span class="n">side</span> <span class="n">interfaces</span> <span class="n">to</span> <span class="n">generate</span> <span class="n">random</span> <span class="n">numbers</span> <span class="o">*/</span>
    <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">kernelSrc</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;    #define CLRNG_SINGLE_PRECISION                                   </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="s2">&quot;    #include &lt;clRNG/mrg31k3p.clh&gt;                                    </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="s2">&quot;                                                                     </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="s2">&quot;    __kernel void example(__global clrngMrg31k3pHostStream *streams, </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="s2">&quot;                          __global float *out)                       </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="s2">&quot;    {                                                                </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="s2">&quot;        int gid = get_global_id(0);                                  </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="s2">&quot;                                                                     </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="s2">&quot;        clrngMrg31k3pStream workItemStream;                          </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="s2">&quot;        clrngMrg31k3pCopyOverStreamsFromGlobal(1, &amp;workItemStream,   </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="s2">&quot;                                                     &amp;streams[gid]); </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="s2">&quot;                                                                     </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="s2">&quot;        out[gid] = clrngMrg31k3pRandomU01(&amp;workItemStream);          </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="s2">&quot;    }                                                                </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="s2">&quot;                                                                     </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">};</span>

  <span class="o">/*</span> <span class="n">Setup</span> <span class="n">OpenCL</span> <span class="n">environment</span><span class="o">.</span> <span class="o">*/</span>
  <span class="n">err</span> <span class="o">=</span> <span class="n">clGetPlatformIDs</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">platform</span><span class="p">,</span> <span class="n">NULL</span> <span class="p">);</span>
  <span class="n">err</span> <span class="o">=</span> <span class="n">clGetDeviceIDs</span><span class="p">(</span> <span class="n">platform</span><span class="p">,</span> <span class="n">CL_DEVICE_TYPE_GPU</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">device</span><span class="p">,</span> <span class="n">NULL</span> <span class="p">);</span>

  <span class="n">props</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">cl_context_properties</span><span class="p">)</span><span class="n">platform</span><span class="p">;</span>
  <span class="n">ctx</span> <span class="o">=</span> <span class="n">clCreateContext</span><span class="p">(</span> <span class="n">props</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">device</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">err</span> <span class="p">);</span>
  <span class="n">queue</span> <span class="o">=</span> <span class="n">clCreateCommandQueue</span><span class="p">(</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">err</span> <span class="p">);</span>

  <span class="o">/*</span> <span class="n">Make</span> <span class="n">sure</span> <span class="n">CLRNG_ROOT</span> <span class="ow">is</span> <span class="n">specified</span> <span class="n">to</span> <span class="n">get</span> <span class="n">library</span> <span class="n">path</span> <span class="o">*/</span>
  <span class="n">clrng_root</span> <span class="o">=</span> <span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;CLRNG_ROOT&quot;</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="n">clrng_root</span> <span class="o">==</span> <span class="n">NULL</span><span class="p">)</span> <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Specify environment variable CLRNG_ROOT as described</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
  <span class="n">strcpy</span><span class="p">(</span><span class="n">include_str</span><span class="p">,</span> <span class="s2">&quot;-I &quot;</span><span class="p">);</span>
  <span class="n">strcat</span><span class="p">(</span><span class="n">include_str</span><span class="p">,</span> <span class="n">clrng_root</span><span class="p">);</span>
  <span class="n">strcat</span><span class="p">(</span><span class="n">include_str</span><span class="p">,</span> <span class="s2">&quot;/include&quot;</span><span class="p">);</span>

  <span class="o">/*</span> <span class="n">Create</span> <span class="n">sample</span> <span class="n">kernel</span> <span class="o">*/</span>
  <span class="n">kernelLines</span> <span class="o">=</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">kernelSrc</span><span class="p">)</span> <span class="o">/</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">kernelSrc</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
  <span class="n">program</span> <span class="o">=</span> <span class="n">clCreateProgramWithSource</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">kernelLines</span><span class="p">,</span> <span class="n">kernelSrc</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">err</span><span class="p">);</span>
  <span class="n">err</span> <span class="o">=</span> <span class="n">clBuildProgram</span><span class="p">(</span><span class="n">program</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">device</span><span class="p">,</span> <span class="n">include_str</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="n">err</span> <span class="o">!=</span> <span class="n">CL_SUCCESS</span><span class="p">)</span>
  <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">clBuildProgram has failed</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
      <span class="n">clGetProgramBuildInfo</span><span class="p">(</span><span class="n">program</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">CL_PROGRAM_BUILD_LOG</span><span class="p">,</span> <span class="mi">4096</span><span class="p">,</span> <span class="n">build_log</span><span class="p">,</span> <span class="n">NULL</span><span class="p">);</span>
      <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">build_log</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">kernel</span> <span class="o">=</span> <span class="n">clCreateKernel</span><span class="p">(</span><span class="n">program</span><span class="p">,</span> <span class="s2">&quot;example&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">err</span><span class="p">);</span>

  <span class="o">/*</span> <span class="n">Create</span> <span class="n">streams</span> <span class="o">*/</span>
  <span class="n">streams</span> <span class="o">=</span> <span class="n">clrngMrg31k3pCreateStreams</span><span class="p">(</span><span class="n">NULL</span><span class="p">,</span> <span class="n">numWorkItems</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">streamBufferSize</span><span class="p">,</span> <span class="p">(</span><span class="n">clrngStatus</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">err</span><span class="p">);</span>

  <span class="o">/*</span> <span class="n">Create</span> <span class="n">buffers</span> <span class="k">for</span> <span class="n">the</span> <span class="n">kernel</span> <span class="o">*/</span>
  <span class="n">bufIn</span> <span class="o">=</span> <span class="n">clCreateBuffer</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">CL_MEM_READ_ONLY</span> <span class="o">|</span> <span class="n">CL_MEM_COPY_HOST_PTR</span><span class="p">,</span> <span class="n">streamBufferSize</span><span class="p">,</span> <span class="n">streams</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">err</span><span class="p">);</span>
  <span class="n">bufOut</span> <span class="o">=</span> <span class="n">clCreateBuffer</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">CL_MEM_WRITE_ONLY</span> <span class="o">|</span> <span class="n">CL_MEM_HOST_READ_ONLY</span><span class="p">,</span> <span class="n">numWorkItems</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">cl_float</span><span class="p">),</span> <span class="n">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">err</span><span class="p">);</span>

  <span class="o">/*</span> <span class="n">Setup</span> <span class="n">the</span> <span class="n">kernel</span> <span class="o">*/</span>
  <span class="n">err</span> <span class="o">=</span> <span class="n">clSetKernelArg</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">bufIn</span><span class="p">),</span>  <span class="o">&amp;</span><span class="n">bufIn</span><span class="p">);</span>
  <span class="n">err</span> <span class="o">=</span> <span class="n">clSetKernelArg</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">bufOut</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">bufOut</span><span class="p">);</span>

  <span class="o">/*</span> <span class="n">Execute</span> <span class="n">the</span> <span class="n">kernel</span> <span class="ow">and</span> <span class="n">read</span> <span class="n">back</span> <span class="n">results</span> <span class="o">*/</span>
  <span class="n">err</span> <span class="o">=</span> <span class="n">clEnqueueNDRangeKernel</span><span class="p">(</span><span class="n">queue</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">numWorkItems</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">event</span><span class="p">);</span>
  <span class="n">err</span> <span class="o">=</span> <span class="n">clWaitForEvents</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">event</span><span class="p">);</span>
  <span class="n">out</span> <span class="o">=</span> <span class="p">(</span><span class="nb">float</span> <span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">numWorkItems</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">]));</span>
  <span class="n">err</span> <span class="o">=</span> <span class="n">clEnqueueReadBuffer</span><span class="p">(</span><span class="n">queue</span><span class="p">,</span> <span class="n">bufOut</span><span class="p">,</span> <span class="n">CL_TRUE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">numWorkItems</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">out</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span><span class="p">);</span>

  <span class="o">/*</span> <span class="n">Release</span> <span class="n">allocated</span> <span class="n">resources</span> <span class="o">*/</span>
  <span class="n">clReleaseEvent</span><span class="p">(</span><span class="n">event</span><span class="p">);</span>
  <span class="n">free</span><span class="p">(</span><span class="n">out</span><span class="p">);</span>
  <span class="n">clReleaseMemObject</span><span class="p">(</span><span class="n">bufIn</span><span class="p">);</span>
  <span class="n">clReleaseMemObject</span><span class="p">(</span><span class="n">bufOut</span><span class="p">);</span>

  <span class="n">clReleaseKernel</span><span class="p">(</span><span class="n">kernel</span><span class="p">);</span>
  <span class="n">clReleaseProgram</span><span class="p">(</span><span class="n">program</span><span class="p">);</span>

  <span class="n">clReleaseCommandQueue</span><span class="p">(</span><span class="n">queue</span><span class="p">);</span>
  <span class="n">clReleaseContext</span><span class="p">(</span><span class="n">ctx</span><span class="p">);</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="building-the-documentation-manually">
<h3>Building the documentation manually<a class="headerlink" href="#building-the-documentation-manually" title="Permalink to this headline">¶</a></h3>
<p>The documentation can be generated by running make from within the doc directory. This requires Doxygen to be installed.</p>
</div>
</div>
<div class="section" id="hcfft">
<h2>hcFFT<a class="headerlink" href="#hcfft" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id29">
<h3>Installation<a class="headerlink" href="#id29" title="Permalink to this headline">¶</a></h3>
<p>The following are the steps to use the library</p>
<blockquote>
<div><ul class="simple">
<li>ROCM 2.0 Kernel, Driver and Compiler Installation (if not done until now)</li>
<li>Library installation.</li>
</ul>
</div></blockquote>
<p><strong>ROCM 2.0 Installation</strong></p>
<p>To Know more about ROCM refer
<a class="reference external" href="https://github.com/RadeonOpenCompute/ROCm/blob/master/README.md">https://github.com/RadeonOpenCompute/ROCm/blob/master/README.md</a></p>
<p><strong>a. Installing Debian ROCM repositories</strong></p>
<p>Before proceeding, make sure to completely uninstall any pre-release ROCm packages.</p>
<p>Refer <a class="reference external" href="https://github.com/RadeonOpenCompute/ROCm#removing-pre-release-packages">https://github.com/RadeonOpenCompute/ROCm#removing-pre-release-packages</a> for instructions to remove pre-release ROCM packages.</p>
<p>Steps to install rocm package are,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="o">-</span><span class="n">qO</span> <span class="o">-</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">packages</span><span class="o">.</span><span class="n">amd</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">rocm</span><span class="o">/</span><span class="n">apt</span><span class="o">/</span><span class="n">debian</span><span class="o">/</span><span class="n">rocm</span><span class="o">.</span><span class="n">gpg</span><span class="o">.</span><span class="n">key</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">key</span> <span class="n">add</span> <span class="o">-</span>

<span class="n">sudo</span> <span class="n">sh</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;echo deb [arch=amd64] http://packages.amd.com/rocm/apt/debian/ xenial main &gt; /etc/apt/sources.list.d/rocm.list&#39;</span>

<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span>

<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">rocm</span>
</pre></div>
</div>
<p>Then, make the ROCm kernel your default kernel. If using grub2 as your bootloader, you can edit the GRUB_DEFAULT variable in the following file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">default</span><span class="o">/</span><span class="n">grub</span>

<span class="n">sudo</span> <span class="n">update</span><span class="o">-</span><span class="n">grub</span>
</pre></div>
</div>
<p>and Reboot the system</p>
<p><strong>b. Verifying the Installation</strong></p>
<p>Once Reboot, to verify that the ROCm stack completed successfully you can execute HSA vector_copy sample application:</p>
<blockquote>
<div><ul class="simple">
<li>cd /opt/rocm/hsa/sample</li>
<li>make</li>
<li>./vector_copy</li>
</ul>
</div></blockquote>
<p><strong>Library Installation</strong></p>
<p><strong>a. Install using Prebuilt debian</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">ROCmSoftwarePlatform</span><span class="o">/</span><span class="n">hcFFT</span><span class="o">/</span><span class="n">blob</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">pre</span><span class="o">-</span><span class="n">builds</span><span class="o">/</span><span class="n">hcfft</span><span class="o">-</span><span class="n">master</span><span class="o">-</span><span class="mi">87</span><span class="n">a37f5</span><span class="o">-</span><span class="n">Linux</span><span class="o">.</span><span class="n">deb</span>
<span class="n">sudo</span> <span class="n">dpkg</span> <span class="o">-</span><span class="n">i</span> <span class="n">hcfft</span><span class="o">-</span><span class="n">master</span><span class="o">-</span><span class="mi">87</span><span class="n">a37f5</span><span class="o">-</span><span class="n">Linux</span><span class="o">.</span><span class="n">deb</span>
</pre></div>
</div>
<p><strong>b. Build debian from source</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">ROCmSoftwarePlatform</span><span class="o">/</span><span class="n">hcFFT</span><span class="o">.</span><span class="n">git</span> <span class="o">&amp;&amp;</span> <span class="n">cd</span> <span class="n">hcFFT</span>

<span class="n">chmod</span> <span class="o">+</span><span class="n">x</span> <span class="n">build</span><span class="o">.</span><span class="n">sh</span> <span class="o">&amp;&amp;</span> <span class="o">./</span><span class="n">build</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>build.sh execution builds the library and generates a debian under build directory.</p>
<p><strong>c. Install CPU based FFTW3 library</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">fftw3</span> <span class="n">fftw3</span><span class="o">-</span><span class="n">dev</span> <span class="n">pkg</span><span class="o">-</span><span class="n">config</span>
</pre></div>
</div>
</div>
<div class="section" id="id30">
<h3>Introduction<a class="headerlink" href="#id30" title="Permalink to this headline">¶</a></h3>
<p>This repository hosts the HCC based FFT Library, that targets GPU acceleration of FFT routines on AMD devices. To know what HCC compiler features, refer <a class="reference external" href="https://github.com/RadeonOpenCompute/hcc">here</a>.</p>
<p>The following are the sub-routines that are implemented</p>
<blockquote>
<div><ol class="arabic simple">
<li>R2C : Transforms Real valued input in Time domain to Complex valued output in Frequency domain.</li>
<li>C2R : Transforms Complex valued input in Frequency domain to Real valued output in Real domain.</li>
<li>C2C : Transforms Complex valued input in Frequency domain to Complex valued output in Real domain or vice versa</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="keyfeature">
<h3>KeyFeature<a class="headerlink" href="#keyfeature" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li>Support 1D, 2D and 3D Fast Fourier Transforms</li>
<li>Supports R2C, C2R, C2C, D2Z, Z2D and Z2Z Transforms</li>
<li>Support Out-Of-Place data storage</li>
<li>Ability to Choose desired target accelerator</li>
<li>Single and Double precision</li>
</ul>
</div></blockquote>
<p><strong>Prerequisites</strong></p>
<p>This section lists the known set of hardware and software requirements to build this library</p>
<p><strong>Hardware</strong></p>
<blockquote>
<div><ul class="simple">
<li>CPU: mainstream brand, Better if with &gt;=4 Cores Intel Haswell based CPU</li>
<li>System Memory &gt;= 4GB (Better if &gt;10GB for NN application over multiple GPUs)</li>
<li>Hard Drive &gt; 200GB (Better if SSD or NVMe driver for NN application over multiple GPUs)</li>
<li>Minimum GPU Memory (Global) &gt; 2GB</li>
</ul>
</div></blockquote>
<p><strong>GPU cards supported</strong></p>
<blockquote>
<div><ul class="simple">
<li>dGPU: AMD R9 Fury X, R9 Fury, R9 Nano</li>
<li>APU: AMD Kaveri or Carrizo</li>
</ul>
</div></blockquote>
<p><strong>AMD Driver and Runtime</strong></p>
<blockquote>
<div><ul class="simple">
<li>Radeon Open Compute Kernel (ROCK) driver : <a class="reference external" href="https://github.com/RadeonOpenCompute/ROCK-Kernel-Driver">https://github.com/RadeonOpenCompute/ROCK-Kernel-Driver</a></li>
<li>HSA runtime API and runtime for Boltzmann: <a class="reference external" href="https://github.com/RadeonOpenCompute/ROCR-Runtime">https://github.com/RadeonOpenCompute/ROCR-Runtime</a></li>
</ul>
</div></blockquote>
<p><strong>System software</strong></p>
<blockquote>
<div><ul class="simple">
<li>Ubuntu 14.04 trusty and later</li>
<li>GCC 4.6 and later</li>
<li>CPP 4.6 and later (come with GCC package)</li>
<li>python 2.7 and later</li>
<li>python-pip</li>
<li>BeautifulSoup4 (installed using python-pip)</li>
<li>HCC 0.9 from here</li>
</ul>
</div></blockquote>
<p><strong>Tools and Misc</strong></p>
<blockquote>
<div><ul class="simple">
<li>git 1.9 and later</li>
<li>cmake 2.6 and later (2.6 and 2.8 are tested)</li>
<li>firewall off</li>
<li>root privilege or user account in sudo group</li>
</ul>
</div></blockquote>
<p><strong>Ubuntu Packages</strong></p>
<blockquote>
<div><ul class="simple">
<li>libc6-dev-i386</li>
<li>liblapack-dev</li>
<li>graphicsmagick</li>
<li>libblas-dev</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="id32">
<h3>Examples<a class="headerlink" href="#id32" title="Permalink to this headline">¶</a></h3>
<p>FFT 1D R2C example:</p>
<p>file: hcfft_1D_R2C.cpp</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!c++

#include &lt;iostream&gt;
#include &lt;cstdlib&gt;
#include &quot;hcfft.h&quot;
#include &quot;hc_am.hpp&quot;
#include &quot;hcfftlib.h&quot;

int main(int argc, char* argv[]) {
  int N = argc &gt; 1 ? atoi(argv[1]) : 1024;
  // HCFFT work flow
  hcfftHandle plan;
  hcfftResult status  = hcfftPlan1d(&amp;plan, N, HCFFT_R2C);
  assert(status == HCFFT_SUCCESS);
  int Rsize = N;
  int Csize = (N / 2) + 1;
  hcfftReal* input = (hcfftReal*)calloc(Rsize, sizeof(hcfftReal));
  int seed = 123456789;
  srand(seed);

  // Populate the input
  for(int i = 0; i &lt; Rsize ; i++) {
    input[i] = rand();
  }

  hcfftComplex* output = (hcfftComplex*)calloc(Csize, sizeof(hcfftComplex));

  std::vector&lt;hc::accelerator&gt; accs = hc::accelerator::get_all();
  assert(accs.size() &amp;&amp; &quot;Number of Accelerators == 0!&quot;);
  hc::accelerator_view accl_view = accs[1].get_default_view();

  hcfftReal* idata = hc::am_alloc(Rsize * sizeof(hcfftReal), accs[1], 0);
  accl_view.copy(input, idata, sizeof(hcfftReal) * Rsize);
  hcfftComplex* odata = hc::am_alloc(Csize * sizeof(hcfftComplex), accs[1], 0);
  accl_view.copy(output,  odata, sizeof(hcfftComplex) * Csize);
  status = hcfftExecR2C(plan, idata, odata);
  assert(status == HCFFT_SUCCESS);
  accl_view.copy(odata, output, sizeof(hcfftComplex) * Csize);
  status =  hcfftDestroy(plan);
  assert(status == HCFFT_SUCCESS);
  free(input);
  free(output);
  hc::am_free(idata);
  hc::am_free(odata);
}
</pre></div>
</div>
<ul class="simple">
<li>Compiling the example code:</li>
</ul>
<p>Assuming the library and compiler installation is followed as in installation.</p>
<p>/opt/rocm/hcc/bin/clang++ <cite>/opt/rocm/hcc/bin/hcc-config –cxxflags –ldflags</cite> -lhc_am -lhcfft -I../lib/include -L../build/lib/src hcfft_1D_R2C.cpp</p>
</div>
<div class="section" id="id33">
<h3>Tested Environments<a class="headerlink" href="#id33" title="Permalink to this headline">¶</a></h3>
<p>This sections enumerates the list of tested combinations of Hardware and system softwares.</p>
<p><strong>Driver versions</strong></p>
<blockquote>
<div><ul class="simple">
<li><dl class="first docutils">
<dt>Boltzmann Early Release Driver + dGPU</dt>
<dd><ul class="first last">
<li>Radeon Open Compute Kernel (ROCK) driver : <a class="reference external" href="https://github.com/RadeonOpenCompute/ROCK-Kernel-Driver">https://github.com/RadeonOpenCompute/ROCK-Kernel-Driver</a></li>
<li>HSA runtime API and runtime for Boltzmann: <a class="reference external" href="https://github.com/RadeonOpenCompute/ROCR-Runtime">https://github.com/RadeonOpenCompute/ROCR-Runtime</a></li>
</ul>
</dd>
</dl>
</li>
<li>Traditional HSA driver + APU (Kaveri)</li>
</ul>
</div></blockquote>
<p><strong>GPU Cards</strong></p>
<blockquote>
<div><ul class="simple">
<li>Radeon R9 Nano</li>
<li>Radeon R9 FuryX</li>
<li>Radeon R9 Fury</li>
<li>Kaveri and Carizo APU</li>
</ul>
</div></blockquote>
<p><strong>Server System</strong></p>
<blockquote>
<div><ul class="simple">
<li>Supermicro SYS 2028GR-THT 6 R9 NANO</li>
<li>Supermicro SYS-1028GQ-TRT 4 R9 NANO</li>
<li>Supermicro SYS-7048GR-TR Tower 4 R9 NANO</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="tensile">
<h2>Tensile<a class="headerlink" href="#tensile" title="Permalink to this headline">¶</a></h2>
<p>A tool for creating a benchmark-driven backend library for GEMMs, GEMM-like problems (such as batched GEMM), N-dimensional tensor contractions, and anything else that multiplies two multi-dimensional objects together on a GPU.</p>
<p>Overview for creating a custom TensileLib backend library for your application:</p>
<ol class="arabic">
<li><p class="first">Install Tensile (optional), or at least install the PyYAML dependency (mandatory).</p>
</li>
<li><p class="first">Create a benchmark config.yaml file.</p>
</li>
<li><p class="first">Run the benchmark to produce a library logic.yaml file.</p>
</li>
<li><p class="first">Add the Tensile library to your application’s CMake target. The Tensile library will be written, compiled and linked to your application at application-compile-time.</p>
<blockquote>
<div><ul class="simple">
<li>GPU kernels, written in HIP or OpenCL.</li>
<li>Solution classes which enqueue the kernels.</li>
<li>APIs which call the fastest solution for a problem.</li>
</ul>
</div></blockquote>
</li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="n">yaml</span>
<span class="n">mkdir</span> <span class="n">Tensile</span>
<span class="n">cd</span> <span class="n">Tensile</span>
<span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">RadeonOpenCompute</span><span class="o">/</span><span class="n">Tensile</span><span class="o">.</span><span class="n">git</span> <span class="n">repo</span>
<span class="n">mkdir</span> <span class="n">build</span>
<span class="n">cd</span> <span class="n">build</span>
<span class="n">python</span> <span class="o">../</span><span class="n">repo</span><span class="o">/</span><span class="n">Tensile</span><span class="o">/</span><span class="n">Tensile</span><span class="o">.</span><span class="n">py</span> <span class="o">../</span><span class="n">repo</span><span class="o">/</span><span class="n">Tensile</span><span class="o">/</span><span class="n">Configs</span><span class="o">/</span><span class="n">sgemm_5760</span><span class="o">.</span><span class="n">yaml</span> <span class="o">./</span>
</pre></div>
</div>
<p>After a while of benchmarking, Tensile will print out the path to the client you can run.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="mi">4</span><span class="n">_LibraryClient</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">client</span> <span class="o">-</span><span class="n">h</span>
<span class="o">./</span><span class="mi">4</span><span class="n">_LibraryClient</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">client</span> <span class="o">--</span><span class="n">sizes</span> <span class="mi">5760</span> <span class="mi">5760</span> <span class="mi">5760</span>
</pre></div>
</div>
<div class="section" id="benchmark-config">
<h3>Benchmark Config<a class="headerlink" href="#benchmark-config" title="Permalink to this headline">¶</a></h3>
<p>Example Benchmark config.yaml</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GlobalParameters</span><span class="p">:</span>
  <span class="n">PrintLevel</span><span class="p">:</span> <span class="mi">1</span>
  <span class="n">ForceRedoBenchmarkProblems</span><span class="p">:</span> <span class="kc">False</span>
  <span class="n">ForceRedoLibraryLogic</span><span class="p">:</span> <span class="kc">True</span>
  <span class="n">ForceRedoLibraryClient</span><span class="p">:</span> <span class="kc">True</span>
  <span class="n">CMakeBuildType</span><span class="p">:</span> <span class="n">Release</span>
  <span class="n">EnqueuesPerSync</span><span class="p">:</span> <span class="mi">1</span>
  <span class="n">SyncsPerBenchmark</span><span class="p">:</span> <span class="mi">1</span>
  <span class="n">LibraryPrintDebug</span><span class="p">:</span> <span class="kc">False</span>
  <span class="n">NumElementsToValidate</span><span class="p">:</span> <span class="mi">128</span>
  <span class="n">ValidationMaxToPrint</span><span class="p">:</span> <span class="mi">16</span>
  <span class="n">ValidationPrintValids</span><span class="p">:</span> <span class="kc">False</span>
  <span class="n">ShortNames</span><span class="p">:</span> <span class="kc">False</span>
  <span class="n">MergeFiles</span><span class="p">:</span> <span class="kc">True</span>
  <span class="n">PlatformIdx</span><span class="p">:</span> <span class="mi">0</span>
  <span class="n">DeviceIdx</span><span class="p">:</span> <span class="mi">0</span>
  <span class="n">DataInitTypeAB</span><span class="p">:</span> <span class="mi">0</span>

<span class="n">BenchmarkProblems</span><span class="p">:</span>
  <span class="o">-</span> <span class="c1"># sgemm NN</span>
    <span class="o">-</span> <span class="c1"># ProblemType</span>
      <span class="n">OperationType</span><span class="p">:</span> <span class="n">GEMM</span>
      <span class="n">DataType</span><span class="p">:</span> <span class="n">s</span>
      <span class="n">TransposeA</span><span class="p">:</span> <span class="kc">False</span>
      <span class="n">TransposeB</span><span class="p">:</span> <span class="kc">False</span>
      <span class="n">UseBeta</span><span class="p">:</span> <span class="kc">True</span>
      <span class="n">Batched</span><span class="p">:</span> <span class="kc">False</span>

    <span class="o">-</span> <span class="c1"># BenchmarkProblemSizeGroup</span>
      <span class="n">InitialSolutionParameters</span><span class="p">:</span>
      <span class="n">BenchmarkCommonParameters</span><span class="p">:</span>
        <span class="o">-</span> <span class="n">ProblemSizes</span><span class="p">:</span>
          <span class="o">-</span> <span class="n">Range</span><span class="p">:</span> <span class="p">[</span> <span class="p">[</span><span class="mi">5760</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">]</span>
        <span class="o">-</span> <span class="n">LoopDoWhile</span><span class="p">:</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span>
        <span class="o">-</span> <span class="n">NumLoadsCoalescedA</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="o">-</span> <span class="n">NumLoadsCoalescedB</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="o">-</span> <span class="n">WorkGroupMapping</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
      <span class="n">ForkParameters</span><span class="p">:</span>
         <span class="o">-</span> <span class="n">ThreadTile</span><span class="p">:</span>
         <span class="o">-</span> <span class="p">[</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span> <span class="p">]</span>
         <span class="o">-</span> <span class="p">[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span> <span class="p">]</span>
         <span class="o">-</span> <span class="p">[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span> <span class="p">]</span>
        <span class="o">-</span> <span class="n">WorkGroup</span><span class="p">:</span>
          <span class="o">-</span> <span class="p">[</span>  <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span>  <span class="mi">1</span> <span class="p">]</span>
          <span class="o">-</span> <span class="p">[</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span>  <span class="mi">1</span> <span class="p">]</span>
        <span class="o">-</span> <span class="n">LoopTail</span><span class="p">:</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
        <span class="o">-</span> <span class="n">EdgeType</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;None&quot;</span><span class="p">,</span> <span class="s2">&quot;Branch&quot;</span><span class="p">,</span> <span class="s2">&quot;ShiftPtr&quot;</span><span class="p">]</span>
        <span class="o">-</span> <span class="n">DepthU</span><span class="p">:</span> <span class="p">[</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">]</span>
        <span class="o">-</span> <span class="n">VectorWidth</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
      <span class="n">BenchmarkForkParameters</span><span class="p">:</span>
      <span class="n">JoinParameters</span><span class="p">:</span>
        <span class="o">-</span> <span class="n">MacroTile</span>
      <span class="n">BenchmarkJoinParameters</span><span class="p">:</span>
      <span class="n">BenchmarkFinalParameters</span><span class="p">:</span>
        <span class="o">-</span> <span class="n">ProblemSizes</span><span class="p">:</span>
          <span class="o">-</span> <span class="n">Range</span><span class="p">:</span> <span class="p">[</span> <span class="p">[</span><span class="mi">5760</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">]</span>

<span class="n">LibraryLogic</span><span class="p">:</span>

<span class="n">LibraryClient</span><span class="p">:</span>
</pre></div>
</div>
<p><strong>Structure of config.yaml</strong></p>
<p>Top level data structure whose keys are Parameters, BenchmarkProblems, LibraryLogic and LibraryClient.</p>
<blockquote>
<div><ul class="simple">
<li>Parameters contains a dictionary storing global parameters used for all parts of the benchmarking.</li>
<li>BenchmarkProblems contains a list of dictionaries representing the benchmarks to conduct; each element, i.e. dictionary, in the list is for benchmarking a single ProblemType. The keys for these dictionaries are ProblemType, InitialSolutionParameters,           BenchmarkCommonParameters, ForkParameters, BenchmarkForkParameters, JoinParameters, BenchmarkJoinParameters and                         BenchmarkFinalParameters. See Benchmark Protocol for more information on these steps.</li>
<li>LibraryLogic contains a dictionary storing parameters for analyzing the benchmark data and designing how the backend library will select which Solution for certain ProblemSizes.</li>
<li>LibraryClient contains a dictionary storing parameters for actually creating the library and creating a client which calls into the library.</li>
</ul>
</div></blockquote>
<p><strong>Global Parameters</strong></p>
<ul class="simple">
<li>Name: Prefix to add to API function names; typically name of device.</li>
<li>MinimumRequiredVersion: Which version of Tensile is required to interpret this yaml file</li>
<li>RuntimeLanguage: Use HIP or OpenCL runtime.</li>
<li>KernelLanguage: For OpenCL runtime, kernel language must be set to OpenCL. For HIP runtime, kernel language can be set to HIP or assembly (gfx803, gfx900).</li>
<li>PrintLevel: 0=Tensile prints nothing, 1=prints some, 2=prints a lot.</li>
<li>ForceRedoBenchmarkProblems: False means don’t redo a benchmark phase if results for it already exist.</li>
<li>ForceRedoLibraryLogic: False means don’t re-generate library logic if it already exist.</li>
<li>ForceRedoLibraryClient: False means don’t re-generate library client if it already exist.</li>
<li>CMakeBuildType: Release or Debug</li>
<li>EnqueuesPerSync: Num enqueues before syncing the queue.</li>
<li>SyncsPerBenchmark: Num queue syncs for each problem size.</li>
<li>LibraryPrintDebug: True means Tensile solutions will print kernel enqueue info to stdout</li>
<li>NumElementsToValidate: Number of elements to validate; 0 means no validation.</li>
<li>ValidationMaxToPrint: How many invalid results to print.</li>
<li>ValidationPrintValids: True means print validation comparisons that are valid, not just invalids.</li>
<li>ShortNames: Convert long kernel, solution and files names to short serial ids.</li>
<li>MergeFiles: False means write each solution and kernel to its own file.</li>
<li>PlatformIdx: OpenCL platform id.</li>
<li>DeviceIdx: OpenCL or HIP device id.</li>
<li>DataInitType[AB,C]: Initialize validation data with 0=0’s, 1=1’s, 2=serial, 3=random.</li>
<li>KernelTime: Use kernel time reported from runtime rather than api times from cpu clocks to compare kernel performance.</li>
</ul>
<p>The exhaustive list of global parameters and their defaults is stored in Common.py.</p>
<p><strong>Problem Type Parameters</strong></p>
<ul class="simple">
<li>OperationType: GEMM or TensorContraction.</li>
<li>DataType: s, d, c, z, h</li>
<li>UseBeta: False means library/solutions/kernel won’t accept a beta parameter; thus beta=0.</li>
<li>UseInitialStrides: False means data is contiguous in memory.</li>
<li>HighPrecisionAccumulate: For tmpC += a*b, use twice the precision for tmpC as for DataType. Not yet implemented.</li>
<li>ComplexConjugateA: True or False; ignored for real precision.</li>
<li>ComplexConjugateB: True or False; ignored for real precision.</li>
</ul>
<p>For OperationType=GEMM only:
* TransposeA: True or False.
* TransposeB: True or False.
* Batched: True or False.</p>
<p>For OperationType=TensorContraction only (showing batched gemm NT: C[ijk] = Sum[l] A[ilk] * B[jlk])
* IndexAssignmentsA: [0, 3, 2]
* IndexAssignmentsB: [1, 3, 2]
* NumDimensionsC: 3.</p>
<p><strong>Defaults</strong></p>
<p>Because of the flexibility / complexity of the benchmarking process and, therefore, of the config.yaml files; Tensile has a default value for every parameter. If you neglect to put LoopUnroll anywhere in your benchmark, rather than crashing or complaining, Tensile will put the default LoopUnroll options into the default phase (common, fork, join…). This guarantees ease of use and more importantly backward compatibility; every time we add a new possible solution parameter, you don’t necessarily need to update your configs; we’ll have a default figured out for you.</p>
<p>However, this may cause some confusion. If your config fork 2 parameters, but you see that 3 were forked during benchmarking, that’s because you didn’t specify the 3rd parameter anywhere, so Tensile stuck it in its default phase, which was forking (for example). Also, specifying ForkParameters: and leaving it empty isn’t the same as leaving JoinParameter out of your config. If you leave ForkParameters out of your config, Tensile will add a ForkParameters step and put the default parameters into it (unless you put all the parameters elsewhere), but if you specify ForkParameters and leave it empty, then you won’t work anything.</p>
<p>Therefore, it is safest to specify all parameters in your config.yaml files; that way you’ll guarantee the behavior you want. See /Tensile/Common.py for the current list of parameters.</p>
</div>
<div class="section" id="benchmark-protocol">
<h3>Benchmark Protocol<a class="headerlink" href="#benchmark-protocol" title="Permalink to this headline">¶</a></h3>
<p><strong>Old Benchmark Architecture was Intractable</strong></p>
<dl class="docutils">
<dt>The benchmarking strategy from version 1 was vanilla flavored brute force:</dt>
<dd><div class="first last line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">(8</span> <span class="pre">WorkGroups)*</span> <span class="pre">(12</span> <span class="pre">ThreadTiles)*</span> <span class="pre">(4</span> <span class="pre">NumLoadsCoalescedAs)*</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">(4</span> <span class="pre">NumLoadsCoalescedBs)*</span> <span class="pre">(3</span> <span class="pre">LoopUnrolls)*</span> <span class="pre">(5</span> <span class="pre">BranchTypes)*</span> <span class="pre">...*(1024</span> <span class="pre">ProblemSizes)=23,592,960</span></code> is a multiplicative series</div>
</div>
</dd>
</dl>
<p>which grows very quickly.Adding one more boolean parameter doubles the number of kernel enqueues of the benchmark.</p>
<p><strong>Incremental Benchmark is Faster</strong></p>
<dl class="docutils">
<dt>Tensile version 2 allows the user to manually interrupt the multiplicative series with “additions” instead of “multiplies”, i.e.,</dt>
<dd><div class="first last line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">(8</span> <span class="pre">WorkGroups)*</span> <span class="pre">(12</span> <span class="pre">ThreadTiles)+</span> <span class="pre">(4</span> <span class="pre">NumLoadsCoalescedAs)*</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">(4</span> <span class="pre">NumLoadsCoalescedBs)*(3</span> <span class="pre">LoopUnrolls)+</span> <span class="pre">(5</span> <span class="pre">BranchTypes)*</span> <span class="pre">...+(1024</span> <span class="pre">ProblemSizes)=1,151</span></code>  is a dramatically smaller number of enqueues.Now, adding one more boolean parameter may only add on 2 more enqueues.</div>
</div>
</dd>
</dl>
<p><strong>Phases of Benchmark</strong></p>
<p>To make the Tensile’s programability more manageable for the user and developer, the benchmarking protocol has been split up into several steps encoded in a config.yaml file. The below sections reference the following config.yaml. Note that this config.yaml has been created to be a simple illustration and doesn’t not represent an actual good benchmark protocol. See the configs included in the repository (/Tensile/Configs) for examples of good benchmarking configs.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BenchmarkProblems</span><span class="p">:</span>
 <span class="o">-</span> <span class="c1"># sgemm</span>
   <span class="o">-</span> <span class="c1"># Problem Type</span>
     <span class="n">OperationType</span><span class="p">:</span> <span class="n">GEMM</span>
   <span class="o">-</span> <span class="c1"># Benchmark Size-Group</span>
    <span class="n">InitialSolutionParameters</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">WorkGroup</span><span class="p">:</span> <span class="p">[</span> <span class="p">[</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">1</span> <span class="p">]</span> <span class="p">]</span>
      <span class="o">-</span> <span class="n">NumLoadsCoalescedA</span><span class="p">:</span> <span class="p">[</span> <span class="mi">1</span> <span class="p">]</span>
      <span class="o">-</span> <span class="n">NumLoadsCoalescedB</span><span class="p">:</span> <span class="p">[</span> <span class="mi">1</span> <span class="p">]</span>
      <span class="o">-</span> <span class="n">ThreadTile</span><span class="p">:</span> <span class="p">[</span> <span class="p">[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span> <span class="p">]</span> <span class="p">]</span>

    <span class="n">BenchmarkCommonParameters</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">ProblemSizes</span><span class="p">:</span>
        <span class="o">-</span> <span class="n">Range</span><span class="p">:</span> <span class="p">[</span> <span class="p">[</span><span class="mi">512</span><span class="p">],</span> <span class="p">[</span><span class="mi">512</span><span class="p">],</span> <span class="p">[</span><span class="mi">512</span><span class="p">]</span> <span class="p">]</span>
      <span class="o">-</span> <span class="n">EdgeType</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Branch&quot;</span><span class="p">,</span> <span class="s2">&quot;ShiftPtr&quot;</span><span class="p">]</span>
        <span class="n">PrefetchGlobalRead</span><span class="p">:</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>

    <span class="n">ForkParameters</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">WorkGroup</span><span class="p">:</span> <span class="p">[</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="p">]</span>
        <span class="n">ThreadTile</span><span class="p">:</span> <span class="p">[</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="p">]</span>

    <span class="n">BenchmarkForkParameters</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">ProblemSizes</span><span class="p">:</span>
        <span class="o">-</span> <span class="n">Exact</span><span class="p">:</span> <span class="p">[</span> <span class="mi">2880</span><span class="p">,</span> <span class="mi">2880</span><span class="p">,</span> <span class="mi">2880</span> <span class="p">]</span>
      <span class="o">-</span> <span class="n">NumLoadsCoalescedA</span><span class="p">:</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span> <span class="p">]</span>
      <span class="o">-</span> <span class="n">NumLoadsCoalescedB</span><span class="p">:</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span> <span class="p">]</span>

    <span class="n">JoinParameters</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">MacroTile</span>

    <span class="n">BenchmarkJoinParameters</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">LoopUnroll</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">]</span>

    <span class="n">BenchmarkFinalParameters</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">ProblemSizes</span><span class="p">:</span>
        <span class="o">-</span> <span class="n">Range</span><span class="p">:</span> <span class="p">[</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">128</span><span class="p">],</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">128</span><span class="p">],</span> <span class="p">[</span><span class="mi">256</span><span class="p">]</span> <span class="p">]</span>
</pre></div>
</div>
<p><strong>Initial Solution Parameters</strong></p>
<p>A Solution is comprised of ~20 parameters, and all are needed to create a kernel. Therefore, during the first benchmark which determines which WorkGroupShape is fastest, what are the other 19 solution parameters which are used to describe the kernels that we benchmark? That’s what InitialSolutionParameters are for. The solution used for benchmarking WorkGroupShape will use the parameters from InitialSolutionParameters. The user must choose good default solution parameters in order to correctly identify subsequent optimal parameters.</p>
<p><strong>Problem Sizes</strong></p>
<p>Each step of the benchmark can override what problem sizes will be benchmarked. A ProblemSizes entry of type Range is a list whose length is the number of indices in the ProblemType. A GEMM ProblemSizes must have 3 elements while a batched-GEMM ProblemSizes must have 4 elements. So, for a ProblemType of C[ij] = Sum[k] A[ik]*B[jk], the ProblemSizes elements represent [SizeI, SizeJ, SizeK]. For each index, there are 5 ways of specifying the sizes of that index:</p>
<blockquote>
<div><dl class="docutils">
<dt>1.[1968]</dt>
<dd><ul class="first last simple">
<li>Benchmark only size 1968; n = 1.</li>
</ul>
</dd>
<dt>2.[16, 1920]</dt>
<dd><ul class="first last simple">
<li>Benchmark sizes 16 to 1968 using the default step size (=16); n = 123.</li>
</ul>
</dd>
<dt>3.[16, 32, 1968]</dt>
<dd><ul class="first last simple">
<li>Benchmark sizes 16 to 1968 using a step size of 32; n = 61.</li>
</ul>
</dd>
<dt>4.[64, 32, 16, 1968]</dt>
<dd><ul class="first last simple">
<li>Benchmark sizes from 64 to 1968 with a step size of 32. Also, increase the step size by 16 each iteration.</li>
<li>This causes fewer sizes to be benchmarked when the sizes are large, and more benchmarks where the sizes are small; this is          typically desired behavior.</li>
<li>n = 16 (64, 96, 144, 208, 288, 384, 496, 624, 768, 928, 1104, 1296, 1504, 1728, 1968). The stride at the beginning is 32, but       the stride at the end is 256.</li>
</ul>
</dd>
<dt>5.[0]</dt>
<dd><ul class="first last simple">
<li>The size of this index is just whatever size index 0 is. For a 3-dimensional ProblemType, this allows benchmarking only a 2-                dimensional or 1-dimensional slice of problem sizes.</li>
</ul>
</dd>
</dl>
</div></blockquote>
<p>Here are a few examples of valid ProblemSizes for 3D GEMMs:</p>
<p>Range: [ [16, 128], [16, 128], [16, 128] ] # n = 512
Range: [ [16, 128], 0, 0] # n = 8
Range: [ [16, 16, 16, 5760], 0, [1024, 1024, 4096] ] # n = 108</p>
<div class="section" id="benchmark-common-parameters">
<h4>Benchmark Common Parameters<a class="headerlink" href="#benchmark-common-parameters" title="Permalink to this headline">¶</a></h4>
<p>During this first phase of benchmarking, we examine parameters which will be the same for all solutions for this ProblemType. During each step of benchmarking, there is only 1 winner. In the above example we are benchmarking the dictionary {EdgeType: [ Branch, ShiftPtr], PrefetchGlobalRead: [False, True]}.; therefore, this benchmark step generates 4 solution candidates, and the winner will be the fastest EdgeType/PrefetchGlobalRead combination. Assuming the winner is ET=SP and PGR=T, then all solutions for this ProblemType will have ET=SP and PGR=T. Also, once a parameter has been determined, all subsequent benchmarking steps will use this determined parameter rather than pulling values from InitialSolutionParameters. Because the common parameters will apply to all kernels, they are typically the parameters which are compiler-dependent or hardware-dependent rather than being tile-dependent.</p>
</div>
<div class="section" id="fork-parameters">
<h4><strong>Fork Parameters</strong><a class="headerlink" href="#fork-parameters" title="Permalink to this headline">¶</a></h4>
<p>If we continued to determine every parameter in the above manner, we’d end up with a single fastest solution for the specified ProblemSizes; we usually desire multiple different solutions with varying parameters which may be fastest for different groups of ProblemSizes. One simple example of this is small tiles sizes are fastest for small problem sizes, and large tiles are fastest for large tile sizes.</p>
<p>Therefore, we allow “forking” parameters; this means keeping multiple winners after each benchmark steps. In the above example we fork {WorkGroup: […], ThreadTile: […]}. This means that in subsequent benchmarking steps, rather than having one winning parameter, we’ll have one winning parameter per fork permutation; we’ll have 9 winners.</p>
<p><strong>Benchmark Fork Parameters</strong></p>
<p>When we benchmark the fork parameters, we retain one winner per permutation. Therefore, we first determine the fastest NumLoadsCoalescedA for each of the WG,TT permutations, then we determine the fastest NumLoadsCoalescedB for each permutation.</p>
</div>
<div class="section" id="join-parameters">
<h4>Join Parameters<a class="headerlink" href="#join-parameters" title="Permalink to this headline">¶</a></h4>
<p>After determining fastest parameters for all the forked solution permutations, we have the option of reducing the number of winning solutions. When a parameter is listed in the JoinParameters section, that means that of the kept winning solutions, each will have a different value for that parameter. Listing more parameters to join results in more winners being kept, while having a JoinParameters section with no parameters listed results on only 1 fastest solution.</p>
<p>In our example we join over the MacroTile (work-group x thread-tile). After forking tiles, there were 9 solutions that we kept. After joining MacroTile, we’ll only keep six: 16x256, 32x128, 64x64, 128x32 and 256x16. The solutions that are kept are based on their performance during the last BenchmarkForkParameters benchmark, or, if there weren’t any, JoinParameters will conduct a benchmark of all solution candidates then choose the fastest.</p>
<p><strong>Benchmark Join Parameters</strong></p>
<p>After narrowing the list of fastest solutions through joining, you can continue to benchmark parameters, keeping one winning parameter per solution permutation.</p>
</div>
<div class="section" id="benchmark-final-parameters">
<h4>Benchmark Final Parameters<a class="headerlink" href="#benchmark-final-parameters" title="Permalink to this headline">¶</a></h4>
<p>After all the parameter benchmarking has been completed and the final list of fastest solution has been assembled, we can benchmark all the solution over a large set of ProblemSizes. This benchmark represent the final output of benchmarking; it outputs a .csv file where the rows are all the problem sizes and the columns are all the solutions. This is the information which gets analysed to produce the library logic.</p>
</div>
</div>
<div class="section" id="dependencies">
<h3>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h3>
<p><strong>CMake</strong></p>
<blockquote>
<div><ul class="simple">
<li>CMake 2.8</li>
</ul>
</div></blockquote>
<p><strong>Python</strong></p>
<blockquote>
<div><ul class="simple">
<li>Python 2.7</li>
<li>PyYAML (Can be installed via apt, apt-get, yum, pip…; module is typically named python-yaml, pyyaml or PyYAML.)</li>
</ul>
</div></blockquote>
<p><strong>Compilers</strong></p>
<blockquote>
<div><ul class="simple">
<li><dl class="first docutils">
<dt>For Tensile_BACKEND = OpenCL1.2</dt>
<dd><ul class="first last">
<li>Visual Studio 14 (2015). (VS 2012 may also be supported; c++11 should no longer be required by Tensile. Need to verify.)</li>
<li>GCC 4.8</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>For Tensile_BACKEND = HIP</dt>
<dd><ul class="first last">
<li>ROCM 2.0</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p><strong>Installation</strong></p>
<p>Tensile can be installed via:</p>
<ol class="arabic simple">
<li>Install directly from repo using pip:</li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">git</span><span class="o">+</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">RadeonOpenCompute</span><span class="o">/</span><span class="n">Tensile</span><span class="o">.</span><span class="n">git</span><span class="nd">@develop</span>
<span class="n">tensile</span> <span class="n">config</span><span class="o">.</span><span class="n">yaml</span> <span class="n">benchmark_path</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li>Download repo and install manually:</li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">RadeonOpenCompute</span><span class="o">/</span><span class="n">Tensile</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">Tensile</span>
<span class="n">sudo</span> <span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
<span class="n">tensile</span> <span class="n">config</span><span class="o">.</span><span class="n">yaml</span> <span class="n">benchmark_path</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li>Download repo and don’t install; install PyYAML dependency manually and call python scripts manually:</li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">RadeonOpenCompute</span><span class="o">/</span><span class="n">Tensile</span><span class="o">.</span><span class="n">git</span>
<span class="n">python</span> <span class="n">Tensile</span><span class="o">/</span><span class="n">Tensile</span><span class="o">/</span><span class="n">Tensile</span><span class="o">.</span><span class="n">py</span> <span class="n">config</span><span class="o">.</span><span class="n">yaml</span> <span class="n">benchmark_path</span>
</pre></div>
</div>
</div>
<div class="section" id="kernel-parameters">
<h3>Kernel Parameters<a class="headerlink" href="#kernel-parameters" title="Permalink to this headline">¶</a></h3>
<div class="section" id="solution-kernel-parameters">
<h4>Solution / Kernel Parameters<a class="headerlink" href="#solution-kernel-parameters" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>LoopDoWhile: True=DoWhile loop, False=While or For loop</li>
<li>LoopTail: Additional loop with LoopUnroll=1.</li>
<li>EdgeType: Branch, ShiftPtr or None</li>
<li>WorkGroup: [dim0, dim1, LocalSplitU]</li>
<li>ThreadTile: [dim0, dim1]</li>
<li>GlobalSplitU: Split up summation among work-groups to create more concurrency. This option launches a kernel to handle the beta       scaling, then a second kernel where the writes to global memory are atomic.</li>
<li>PrefetchGlobalRead: True means outer loop should prefetch global data one iteration ahead.</li>
<li>PrefetchLocalRead: True means inner loop should prefetch lds data one iteration ahead.</li>
<li>WorkGroupMapping: In what order will work-groups compute C; affects cacheing.</li>
<li>LoopUnroll: How many iterations to unroll inner loop; helps loading coalesced memory.</li>
<li>MacroTile: Derrived from WorkGroup*ThreadTile.</li>
<li>DepthU: Derrived from LoopUnroll*SplitU.</li>
<li>NumLoadsCoalescedA,B: Number of loads from A in coalesced dimension.</li>
<li>GlobalReadCoalesceGroupA,B: True means adjacent threads map to adjacent global read elements (but, if transposing data then write     to lds is scattered).</li>
<li>GlobalReadCoalesceVectorA,B: True means vector components map to adjacent global read elements (but, if transposing data then write   to lds is scattered).</li>
<li>VectorWidth: Thread tile elements are contiguous for faster memory accesses. For example VW=4 means a thread will read a float4        from memory rather than 4 non-contiguous floats.</li>
</ul>
<p>The exhaustive list of solution parameters and their defaults is stored in Common.py.</p>
</div>
<div class="section" id="kernel-parameters-affect-performance">
<h4>Kernel Parameters Affect Performance<a class="headerlink" href="#kernel-parameters-affect-performance" title="Permalink to this headline">¶</a></h4>
<p>The kernel parameters affect many aspects of performance. Changing a parameter may help address one performance bottleneck but worsen another. That is why searching through the parameter space is vital to discovering the fastest kernel for a given problem.</p>
<blockquote>
<div><img alt="ROCm_Libraries/img1.png" class="align-center" src="ROCm_Libraries/img1.png" />
</div></blockquote>
<p><strong>How N-Dimensional Tensor Contractions Are Mapped to Finite-Dimensional GPU Kernels</strong></p>
<p>For a traditional GEMM, the 2-dimensional output, C[i,j], is mapped to launching a 2-dimensional grid of work groups, each of which has a 2-dimensional grid of work items; one dimension belongs to i and one dimension belongs to j. The 1-dimensional summation is represented by a single loop within the kernel body.</p>
<p><strong>Special Dimensions: D0, D1 and DU</strong></p>
<p>To handle arbitrary dimensionality, Tensile begins by determining 3 special dimensions: D0, D1 and DU.</p>
<p>D0 and D1 are the free indices of A and B (one belongs to A and one to B) which have the shortest strides. This allows the inner-most loops to read from A and B the fastest via coalescing. In a traditional GEMM, every matrix has a dimension with a shortest stride of 1, but Tensile doesn’t make that assumption. Of these two dimensions, D0 is the dimension which has the shortest tensor C stride which allows for fast writing.</p>
<p>DU represents the summation index with the shortest combined stride (stride in A + stride in B); it becomes the inner most loop which gets “U”nrolled. This assignment is also mean’t to assure fast reading in the inner-most summation loop. There can be multiple summation indices (i.e. embedded loops) and DU will be iterated over in the inner most loop.</p>
</div>
<div class="section" id="gpu-kernel-dimension">
<h4>GPU Kernel Dimension<a class="headerlink" href="#gpu-kernel-dimension" title="Permalink to this headline">¶</a></h4>
<p>OpenCL allows for 3-dimensional grid of work-groups, and each work-group can be a 3-dimensional grid of work-items. Tensile assigns D0 to be dimension-0 of the work-group and work-item grid; it assigns D1 to be dimension-1 of the work-group and work-item grids. All other free or batch dimensions are flattened down into the final dimension-2 of the work-group and work-item grids. Withing the GPU kernel, dimensions-2 is reconstituted back into whatever dimensions it represents.</p>
</div>
</div>
<div class="section" id="languages">
<h3>Languages<a class="headerlink" href="#languages" title="Permalink to this headline">¶</a></h3>
<p><strong>Tensile Benchmarking is Python</strong></p>
<p>The benchmarking module, Tensile.py, is written in python. The python scripts write solution, kernels, cmake files and all other C/C++ files used for benchmarking.</p>
<p><strong>Tensile Library</strong></p>
<p>The Tensile API, Tensile.h, is confined to C89 so that it will be usable by most software. The code behind the API is allowed to be c++11.</p>
<p><strong>Device Languages</strong></p>
<p>The device languages Tensile supports for the gpu kernels is</p>
<ul class="simple">
<li>OpenCL 1.2</li>
<li>HIP</li>
<li><dl class="first docutils">
<dt>Assembly</dt>
<dd><ul class="first last">
<li>gfx803</li>
<li>gfx900</li>
</ul>
</dd>
</dl>
</li>
</ul>
<p><strong>Library Logic</strong></p>
<p>Running the LibraryLogic phase of benchmarking analyses the benchmark data and encodes a mapping for each problem type. For each problem type, it maps problem sizes to best solution (i.e. kernel).</p>
<p>When you build Tensile.lib, you point the TensileCreateLibrary function to a directory where your library logic yaml files are.</p>
</div>
<div class="section" id="problem-nomenclature">
<h3>Problem Nomenclature<a class="headerlink" href="#problem-nomenclature" title="Permalink to this headline">¶</a></h3>
<p><strong>Example Problems</strong></p>
<ul class="simple">
<li>C[i,j] = Sum[k] A[i,k] * B[k,j] (GEMM; 2 free indices and 1 summation index)</li>
<li>C[i,j,k] = Sum[l] A[i,l,k] * B[l,j,k] (batched-GEMM; 2 free indices, 1 batched index and 1 summation index)</li>
<li>C[i,j] = Sum[k,l] A[i,k,l] * B[j,l,k] (2D summation)</li>
<li>C[i,j,k,l,m] = Sum[n] A[i,k,m,l,n] * B[j,k,l,n,m] (GEMM with 3 batched indices)</li>
<li>C[i,j,k,l,m] = Sum[n,o] A[i,k,m,o,n] * B[j,m,l,n,o] (4 free indices, 2 summation indices and 1 batched index)</li>
<li>C[i,j,k,l] = Sum[m,n] A[i,j,m,n,l] * B[m,n,k,j,l] (batched image convolution mapped to 7D tensor contraction)</li>
<li>and even crazier</li>
</ul>
<p><strong>Nomenclature</strong></p>
<p>The indices describe the dimensionality of the problem being solved. A GEMM operation takes 2 2-dimensional matrices as input (totaling 4 input dimensions) and contracts them along one dimension (which cancels out 2 of the dimensions), resulting in a 2-dimensional result.</p>
<p>Whenever an index shows up in multiple tensors, those tensors must be the same size along that dimension but they may have different strides.</p>
<p>There are 3 categories of indices/dimensions that Tensile deals with: free, batch and bound.</p>
<p><strong>Free Indices</strong></p>
<p>Free indices are the indices of tensor C which come in pairs; one of the pair shows up in tensor A while the other shows up in tensor B. In the really crazy example above, i/j/k/l are the 4 free indices of tensor C. Indices i and k come from tensor A and indices j and l come from tensor B.</p>
<p><strong>Batch Indices</strong></p>
<p>Batch indices are the indices of tensor C which shows up in both tensor A and tensor B. For example, the difference between the GEMM example and the batched-GEMM example above is the additional index. In the batched-GEMM example, the index K is the batch index which is batching together multiple independent GEMMs.</p>
<p><strong>Bound/Summation Indices</strong></p>
<p>The final type of indices are called bound indices or summation indices. These indices do not show up in tensor C; they show up in the summation symbol (Sum[k]) and in tensors A and B. It is along these indices that we perform the inner products (pairwise multiply then sum).</p>
<p><strong>Limitations</strong></p>
<p>Problem supported by Tensile must meet the following conditions:</p>
<p>There must be at least one pair of free indices.</p>
</div>
<div class="section" id="tensile-lib">
<h3>Tensile.lib<a class="headerlink" href="#tensile-lib" title="Permalink to this headline">¶</a></h3>
<p>After running the benchmark and generating library config files, you’re ready to add Tensile.lib to your project. Tensile provides a TensileCreateLibrary function, which can be called:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>set(Tensile_BACKEND &quot;HIP&quot;)
set( Tensile_LOGIC_PATH &quot;~/LibraryLogic&quot; CACHE STRING &quot;Path to Tensile logic.yaml files&quot;)
option( Tensile_MERGE_FILES &quot;Tensile to merge kernels and solutions files?&quot; OFF)
option( Tensile_SHORT_NAMES &quot;Tensile to use short file/function names? Use if compiler complains they&#39;re too long.&quot; OFF)
option( Tensile_PRINT_DEBUG &quot;Tensile to print runtime debug info?&quot; OFF)

find_package(Tensile) # use if Tensile has been installed

TensileCreateLibrary(
  ${Tensile_LOGIC_PATH}
  ${Tensile_BACKEND}
  ${Tensile_MERGE_FILES}
  ${Tensile_SHORT_NAMES}
  ${Tensile_PRINT_DEBUG}
  Tensile_ROOT ${Tensile_ROOT} # optional; use if tensile not installed
  )
target_link_libraries( TARGET Tensile )
</pre></div>
</div>
<p><strong>Versioning</strong></p>
<p>Tensile follows semantic versioning practices, i.e. Major.Minor.Patch, in BenchmarkConfig.yaml files, LibraryConfig.yaml files and in cmake find_package. Tensile is compatible with a “MinimumRequiredVersion” if Tensile.Major==MRV.Major and Tensile.Minor.Patch &gt;= MRV.Minor.Patch.</p>
<ul class="simple">
<li>Major: Tensile increments the major version if the public API changes, or if either the benchmark.yaml or library-config.yaml files   change format in a non-backwards-compatible manner.</li>
<li>Minor: Tensile increments the minor version when new kernel, solution or benchmarking features are introduced in a backwards-         compatible manner.</li>
<li>Patch: Bug fixes or minor improvements.</li>
</ul>
</div>
</div>
<div class="section" id="rocalution">
<h2>rocALUTION<a class="headerlink" href="#rocalution" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id34">
<h3>Introduction<a class="headerlink" href="#id34" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="overview">
<h3>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h3>
<p>rocALUTION is a sparse linear algebra library with focus on exploring fine-grained parallelism, targeting modern processors and accelerators including multi/many-core CPU and GPU platforms. The main goal of this package is to provide a portable library for iterative sparse methods on state of the art hardware. rocALUTION can be seen as middle-ware between different parallel backends and application specific packages.</p>
<p>The major features and characteristics of the library are</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>Various backends</dt>
<dd><ul class="first last">
<li>Host - fallback backend, designed for CPUs</li>
<li>GPU/HIP - accelerator backend, designed for HIP capable AMD GPUs</li>
<li>OpenMP - designed for multi-core CPUs</li>
<li>MPI - designed for multi-node and multi-GPU configurations</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Easy to use</dt>
<dd>The syntax and structure of the library provide easy learning curves. With the help of the examples, anyone can try out the library - no knowledge in HIP, OpenMP or MPI programming required.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>No special hardware requirements</dt>
<dd>There are no hardware requirements to install and run rocALUTION. If a GPU device and HIP is available, the library will use them.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Variety of iterative solvers</dt>
<dd><ul class="first last">
<li>Fixed-Point iteration - Jacobi, Gauss-Seidel, Symmetric-Gauss Seidel, SOR and SSOR</li>
<li>Krylov subspace methods - CR, CG, BiCGStab, BiCGStab(l), GMRES, IDR, QMRCGSTAB, Flexible CG/GMRES</li>
<li>Mixed-precision defect-correction scheme</li>
<li>Chebyshev iteration</li>
<li>Multiple MultiGrid schemes, geometric and algebraic</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Various preconditioners</dt>
<dd><ul class="first last">
<li>Matrix splitting - Jacobi, (Multi-colored) Gauss-Seidel, Symmetric Gauss-Seidel, SOR, SSOR</li>
<li>Factorization - ILU(0), ILU(p) (based on levels), ILU(p,q) (power(q)-pattern method), Multi-Elimination ILU (nested/recursive), ILUT (based on threshold) and IC(0)</li>
<li>Approximate Inverse - Chebyshev matrix-valued polynomial, SPAI, FSAI and TNS</li>
<li>Diagonal-based preconditioner for Saddle-point problems</li>
<li>Block-type of sub-preconditioners/solvers</li>
<li>Additive Schwarz and Restricted Additive Schwarz</li>
<li>Variable type preconditioners</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Generic and robust design</dt>
<dd>rocALUTION is based on a generic and robust design allowing expansion in the direction of new solvers and preconditioners and support for various hardware types. Furthermore, the design of the library allows the use of all solvers as preconditioners in other solvers. For example you can easily define a CG solver with a Multi-Elimination preconditioner, where the last-block is preconditioned with another Chebyshev iteration method which is preconditioned with a multi-colored Symmetric Gauss-Seidel scheme.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Portable code and results</dt>
<dd>All code based on rocALUTION is portable and independent of HIP or OpenMP. The code will compile and run everywhere. All solvers and preconditioners are based on a single source code, which delivers portable results across all supported backends (variations are possible due to different rounding modes on the hardware). The only difference which you can see for a hardware change is the performance variation.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Support for several sparse matrix formats</dt>
<dd>Compressed Sparse Row (CSR), Modified Compressed Sparse Row (MCSR), Dense (DENSE), Coordinate (COO), ELL, Diagonal (DIA), Hybrid format of ELL and COO (HYB).</dd>
</dl>
</li>
</ul>
<p>The code is open-source under MIT license and hosted on here: <a class="reference external" href="https://github.com/ROCmSoftwarePlatform/rocALUTION">https://github.com/ROCmSoftwarePlatform/rocALUTION</a></p>
</div>
<div class="section" id="building-and-installing">
<h3>Building and Installing<a class="headerlink" href="#building-and-installing" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="id35">
<h3>Installing from AMD ROCm repositories<a class="headerlink" href="#id35" title="Permalink to this headline">¶</a></h3>
<p>TODO, not yet available</p>
</div>
<div class="section" id="building-rocalution-from-open-source-repository">
<h3>Building rocALUTION from Open-Source repository<a class="headerlink" href="#building-rocalution-from-open-source-repository" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="download-rocalution">
<h3>Download rocALUTION<a class="headerlink" href="#download-rocalution" title="Permalink to this headline">¶</a></h3>
<p>The rocALUTION source code is available at the <a class="reference external" href="https://github.com/ROCmSoftwarePlatform/rocALUTION">rocALUTION github page</a>.
Download the master branch using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="o">-</span><span class="n">b</span> <span class="n">master</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">ROCmSoftwarePlatform</span><span class="o">/</span><span class="n">rocALUTION</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">rocALUTION</span>
</pre></div>
</div>
<p>Note that if you want to contribute to rocALUTION, you will need to checkout the develop branch instead of the master branch. See <span class="xref std std-ref">rocalution_contributing</span> for further details.
Below are steps to build different packages of the library, including dependencies and clients.
It is recommended to install rocALUTION using the <em>install.sh</em> script.</p>
</div>
<div class="section" id="using-install-sh-to-build-dependencies-library">
<h3>Using <em>install.sh</em> to build dependencies + library<a class="headerlink" href="#using-install-sh-to-build-dependencies-library" title="Permalink to this headline">¶</a></h3>
<p>The following table lists common uses of <em>install.sh</em> to build dependencies + library. Accelerator support via HIP and OpenMP will be enabled by default, whereas MPI is disabled.</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Command</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><cite>./install.sh -h</cite></td>
<td>Print help information.</td>
</tr>
<tr class="row-odd"><td><cite>./install.sh -d</cite></td>
<td>Build dependencies and library in your local directory. The <cite>-d</cite> flag only needs to be <a href="#id48"><span class="problematic" id="id49">|br|</span></a> used once. For subsequent invocations of <em>install.sh</em> it is not necessary to rebuild the <a href="#id50"><span class="problematic" id="id51">|br|</span></a> dependencies.</td>
</tr>
<tr class="row-even"><td><cite>./install.sh</cite></td>
<td>Build library in your local directory. It is assumed dependencies are available.</td>
</tr>
<tr class="row-odd"><td><cite>./install.sh -i</cite></td>
<td>Build library, then build and install rocALUTION package in <cite>/opt/rocm/rocalution</cite>. You will <a href="#id52"><span class="problematic" id="id53">|br|</span></a> be prompted for sudo access. This will install for all users.</td>
</tr>
<tr class="row-even"><td><cite>./install.sh –host</cite></td>
<td>Build library in your local directory without HIP support. It is assumed dependencies <a href="#id54"><span class="problematic" id="id55">|br|</span></a> are available.</td>
</tr>
<tr class="row-odd"><td><cite>./install.sh –mpi</cite></td>
<td>Build library in your local directory with HIP and MPI support. It is assumed <a href="#id56"><span class="problematic" id="id57">|br|</span></a> dependencies are available.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="using-install-sh-to-build-dependencies-library-client">
<h3>Using <em>install.sh</em> to build dependencies + library + client<a class="headerlink" href="#using-install-sh-to-build-dependencies-library-client" title="Permalink to this headline">¶</a></h3>
<p>The client contains example code, unit tests and benchmarks. Common uses of <em>install.sh</em> to build them are listed in the table below.</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="92%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Command</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><cite>./install.sh -h</cite></td>
<td>Print help information.</td>
</tr>
<tr class="row-odd"><td><cite>./install.sh -dc</cite></td>
<td>Build dependencies, library and client in your local directory. The <cite>-d</cite> flag only needs to <a href="#id58"><span class="problematic" id="id59">|br|</span></a> be used once. For subsequent invocations of <em>install.sh</em> it is not necessary to rebuild the <a href="#id60"><span class="problematic" id="id61">|br|</span></a> dependencies.</td>
</tr>
<tr class="row-even"><td><cite>./install.sh -c</cite></td>
<td>Build library and client in your local directory. It is assumed dependencies are available.</td>
</tr>
<tr class="row-odd"><td><cite>./install.sh -idc</cite></td>
<td>Build library, dependencies and client, then build and install rocALUTION package in <a href="#id62"><span class="problematic" id="id63">|br|</span></a> <cite>/opt/rocm/rocalution</cite>. You will be prompted for sudo access. This will install for all users.</td>
</tr>
<tr class="row-even"><td><cite>./install.sh -ic</cite></td>
<td>Build library and client, then build and install rocALUTION package in <a href="#id64"><span class="problematic" id="id65">|br|</span></a> <cite>opt/rocm/rocalution</cite>. You will be prompted for sudo access. This will install for all users.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="using-individual-commands-to-build-rocalution">
<h3>Using individual commands to build rocALUTION<a class="headerlink" href="#using-individual-commands-to-build-rocalution" title="Permalink to this headline">¶</a></h3>
<p>CMake 3.5 or later is required in order to build rocALUTION.</p>
<p>rocALUTION can be built with cmake using the following commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># Create and change to build directory
mkdir -p build/release ; cd build/release

# Default install path is /opt/rocm, use -DCMAKE_INSTALL_PREFIX=&lt;path&gt; to adjust it
cmake ../.. -DSUPPORT_HIP=ON \
            -DSUPPORT_MPI=OFF \
            -DSUPPORT_OMP=ON

# Compile rocALUTION library
make -j$(nproc)

# Install rocALUTION to /opt/rocm
sudo make install
</pre></div>
</div>
<p>GoogleTest is required in order to build rocALUTION client.</p>
<p>rocALUTION with dependencies and client can be built using the following commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># Install googletest
mkdir -p build/release/deps ; cd build/release/deps
cmake ../../../deps
sudo make -j$(nproc) install

# Change to build directory
cd ..

# Default install path is /opt/rocm, use -DCMAKE_INSTALL_PREFIX=&lt;path&gt; to adjust it
cmake ../.. -DBUILD_CLIENTS_TESTS=ON \
            -DBUILD_CLIENTS_SAMPLES=ON

# Compile rocALUTION library
make -j$(nproc)

# Install rocALUTION to /opt/rocm
sudo make install
</pre></div>
</div>
<p>The compilation process produces a shared library file <em>librocalution.so</em> and <em>librocalution_hip.so</em> if HIP support is enabled. Ensure that the library objects can be found in your library path. If you do not copy the library to a specific location you can add the path under Linux in the <em>LD_LIBRARY_PATH</em> variable.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:&lt;path_to_rocalution&gt;
</pre></div>
</div>
</div>
<div class="section" id="common-build-problems">
<h3>Common build problems<a class="headerlink" href="#common-build-problems" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first"><strong>Issue:</strong> HIP (/opt/rocm/hip) was built using hcc 1.0.xxx-xxx-xxx-xxx, but you are using /opt/rocm/bin/hcc with version 1.0.yyy-yyy-yyy-yyy from hipcc (version mismatch). Please rebuild HIP including cmake or update HCC_HOME variable.</p>
<p><strong>Solution:</strong> Download HIP from github and use hcc to <a class="reference external" href="https://github.com/ROCm-Developer-Tools/HIP/blob/master/INSTALL.md">build from source</a> and then use the built HIP instead of /opt/rocm/hip.</p>
</li>
<li><p class="first"><strong>Issue:</strong> For Carrizo - HCC RUNTIME ERROR: Failed to find compatible kernel</p>
<p><strong>Solution:</strong> Add the following to the cmake command when configuring: <cite>-DCMAKE_CXX_FLAGS=”–amdgpu-target=gfx801”</cite></p>
</li>
<li><p class="first"><strong>Issue:</strong> For MI25 (Vega10 Server) - HCC RUNTIME ERROR: Failed to find compatible kernel</p>
<p><strong>Solution:</strong> <cite>export HCC_AMDGPU_TARGET=gfx900</cite></p>
</li>
<li><dl class="first docutils">
<dt><strong>Issue:</strong> Could not find a package configuration file provided by “ROCM” with any of the following names:</dt>
<dd><p class="first last">ROCMConfig.cmake <a href="#id66"><span class="problematic" id="id67">|br|</span></a>
rocm-config.cmake</p>
</dd>
</dl>
<p><strong>Solution:</strong> Install <a class="reference external" href="https://github.com/RadeonOpenCompute/rocm-cmake">ROCm cmake modules</a></p>
</li>
<li><dl class="first docutils">
<dt><strong>Issue:</strong> Could not find a package configuration file provided by “ROCSPARSE” with any of the following names:</dt>
<dd><p class="first last">ROCSPARSE.cmake <a href="#id68"><span class="problematic" id="id69">|br|</span></a>
rocsparse-config.cmake</p>
</dd>
</dl>
<p><strong>Solution:</strong> Install <a class="reference external" href="https://github.com/ROCmSoftwarePlatform/rocSPARSE">rocSPARSE</a></p>
</li>
<li><dl class="first docutils">
<dt><strong>Issue:</strong> Could not find a package configuration file provided by “ROCBLAS” with any of the following names:</dt>
<dd><p class="first last">ROCBLAS.cmake <a href="#id70"><span class="problematic" id="id71">|br|</span></a>
rocblas-config.cmake</p>
</dd>
</dl>
<p><strong>Solution:</strong> Install <a class="reference external" href="https://github.com/ROCmSoftwarePlatform/rocBLAS">rocBLAS</a></p>
</li>
</ol>
</div>
<div class="section" id="simple-test">
<h3>Simple Test<a class="headerlink" href="#simple-test" title="Permalink to this headline">¶</a></h3>
<p>You can test the installation by running a CG solver on a Laplace matrix. After compiling the library you can perform the CG solver test by executing</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">rocALUTION</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">release</span><span class="o">/</span><span class="n">examples</span>

<span class="n">wget</span> <span class="n">ftp</span><span class="p">:</span><span class="o">//</span><span class="n">math</span><span class="o">.</span><span class="n">nist</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">MatrixMarket2</span><span class="o">/</span><span class="n">Harwell</span><span class="o">-</span><span class="n">Boeing</span><span class="o">/</span><span class="n">laplace</span><span class="o">/</span><span class="n">gr_30_30</span><span class="o">.</span><span class="n">mtx</span><span class="o">.</span><span class="n">gz</span>
<span class="n">gzip</span> <span class="o">-</span><span class="n">d</span> <span class="n">gr_30_30</span><span class="o">.</span><span class="n">mtx</span><span class="o">.</span><span class="n">gz</span>

<span class="o">./</span><span class="n">cg</span> <span class="n">gr_30_30</span><span class="o">.</span><span class="n">mtx</span>
</pre></div>
</div>
<p>For more information regarding rocALUTION library and corresponding API documentation, refer
<a class="reference external" href="https://rocalution.readthedocs.io/en/latest/library.html">rocALUTION</a></p>
</div>
</div>
<div class="section" id="id38">
<h2>rocSPARSE<a class="headerlink" href="#id38" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id39">
<h3>Introduction<a class="headerlink" href="#id39" title="Permalink to this headline">¶</a></h3>
<p>rocSPARSE is a library that contains basic linear algebra subroutines for sparse matrices and vectors written in HiP for GPU devices. It is designed to be used from C and C++ code.</p>
<p>The code is open and hosted here: <a class="reference external" href="https://github.com/ROCmSoftwarePlatform/rocSPARSE">https://github.com/ROCmSoftwarePlatform/rocSPARSE</a></p>
</div>
<div class="section" id="device-and-stream-management">
<h3>Device and Stream Management<a class="headerlink" href="#device-and-stream-management" title="Permalink to this headline">¶</a></h3>
<p><em>hipSetDevice()</em> and <em>hipGetDevice()</em> are HIP device management APIs. They are NOT part of the rocSPARSE API.</p>
</div>
<div class="section" id="asynchronous-execution">
<h3>Asynchronous Execution<a class="headerlink" href="#asynchronous-execution" title="Permalink to this headline">¶</a></h3>
<p>All rocSPARSE library functions, unless otherwise stated, are non blocking and executed asynchronously with respect to the host. They may return before the actual computation has finished. To force synchronization, <em>hipDeviceSynchronize()</em> or <em>hipStreamSynchronize()</em> can be used. This will ensure that all previously executed rocSPARSE functions on the device / this particular stream have completed.</p>
</div>
<div class="section" id="hip-device-management">
<h3>HIP Device Management<a class="headerlink" href="#hip-device-management" title="Permalink to this headline">¶</a></h3>
<p>Before a HIP kernel invocation, users need to call <em>hipSetDevice()</em> to set a device, e.g. device 1. If users do not explicitly call it, the system by default sets it as device 0. Unless users explicitly call <em>hipSetDevice()</em> to set to another device, their HIP kernels are always launched on device 0.</p>
<p>The above is a HIP (and CUDA) device management approach and has nothing to do with rocSPARSE. rocSPARSE honors the approach above and assumes users have already set the device before a rocSPARSE routine call.</p>
</div>
<div class="section" id="hip-stream-management">
<h3>HIP Stream Management<a class="headerlink" href="#hip-stream-management" title="Permalink to this headline">¶</a></h3>
<p>HIP kernels are always launched in a queue (also known as stream).</p>
<p>If users do not explicitly specify a stream, the system provides a default stream, maintained by the system. Users cannot create or destroy the default stream. However, users can freely create new streams (with <em>hipStreamCreate()</em>) and bind it to the rocSPARSE handle. HIP kernels are invoked in rocSPARSE routines. The rocSPARSE handle is always associated with a stream, and rocSPARSE passes its stream to the kernels inside the routine. One rocSPARSE routine only takes one stream in a single invocation. If users create a stream, they are responsible for destroying it.</p>
</div>
<div class="section" id="multiple-streams-and-multiple-devices">
<h3>Multiple Streams and Multiple Devices<a class="headerlink" href="#multiple-streams-and-multiple-devices" title="Permalink to this headline">¶</a></h3>
<p>If the system under test has multiple HIP devices, users can run multiple rocSPARSE handles concurrently, but can NOT run a single rocSPARSE handle on different discrete devices. Each handle is associated with a particular singular device, and a new handle should be created for each additional device.</p>
</div>
<div class="section" id="id40">
<h3>Building and Installing<a class="headerlink" href="#id40" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="id41">
<h3>Installing from AMD ROCm repositories<a class="headerlink" href="#id41" title="Permalink to this headline">¶</a></h3>
<p>rocSPARSE can be installed from <a class="reference external" href="https://rocm.github.io/ROCmInstall.html#installing-from-amd-rocm-repositories">AMD ROCm repositories</a> by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">rocsparse</span>
</pre></div>
</div>
</div>
<div class="section" id="building-rocsparse-from-open-source-repository">
<h3>Building rocSPARSE from Open-Source repository<a class="headerlink" href="#building-rocsparse-from-open-source-repository" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="download-rocsparse">
<h3>Download rocSPARSE<a class="headerlink" href="#download-rocsparse" title="Permalink to this headline">¶</a></h3>
<p>The rocSPARSE source code is available at the <a class="reference external" href="https://github.com/ROCmSoftwarePlatform/rocSPARSE">rocSPARSE github page</a>.
Download the master branch using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="o">-</span><span class="n">b</span> <span class="n">master</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">ROCmSoftwarePlatform</span><span class="o">/</span><span class="n">rocSPARSE</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">rocSPARSE</span>
</pre></div>
</div>
<p>Note that if you want to contribute to rocSPARSE, you will need to checkout the develop branch instead of the master branch.</p>
<p>Below are steps to build different packages of the library, including dependencies and clients.
It is recommended to install rocSPARSE using the <em>install.sh</em> script.</p>
</div>
<div class="section" id="id42">
<h3>Using <em>install.sh</em> to build dependencies + library<a class="headerlink" href="#id42" title="Permalink to this headline">¶</a></h3>
<p>The following table lists common uses of <em>install.sh</em> to build dependencies + library.</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="92%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Command</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><cite>./install.sh -h</cite></td>
<td>Print help information.</td>
</tr>
<tr class="row-odd"><td><cite>./install.sh -d</cite></td>
<td>Build dependencies and library in your local directory. The <cite>-d</cite> flag only needs to be <a href="#id72"><span class="problematic" id="id73">|br|</span></a> used once. For subsequent invocations of <em>install.sh</em> it is not necessary to rebuild the <a href="#id74"><span class="problematic" id="id75">|br|</span></a> dependencies.</td>
</tr>
<tr class="row-even"><td><cite>./install.sh</cite></td>
<td>Build library in your local directory. It is assumed dependencies are available.</td>
</tr>
<tr class="row-odd"><td><cite>./install.sh -i</cite></td>
<td>Build library, then build and install rocSPARSE package in <cite>/opt/rocm/rocsparse</cite>. You will be <a href="#id76"><span class="problematic" id="id77">|br|</span></a> prompted for sudo access. This will install for all users.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id43">
<h3>Using <em>install.sh</em> to build dependencies + library + client<a class="headerlink" href="#id43" title="Permalink to this headline">¶</a></h3>
<p>The client contains example code, unit tests and benchmarks. Common uses of <em>install.sh</em> to build them are listed in the table below.</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="92%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Command</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><cite>./install.sh -h</cite></td>
<td>Print help information.</td>
</tr>
<tr class="row-odd"><td><cite>./install.sh -dc</cite></td>
<td>Build dependencies, library and client in your local directory. The <cite>-d</cite> flag only needs to be <a href="#id78"><span class="problematic" id="id79">|br|</span></a> used once. For subsequent invocations of <em>install.sh</em> it is not necessary to rebuild the <a href="#id80"><span class="problematic" id="id81">|br|</span></a> dependencies.</td>
</tr>
<tr class="row-even"><td><cite>./install.sh -c</cite></td>
<td>Build library and client in your local directory. It is assumed dependencies are available.</td>
</tr>
<tr class="row-odd"><td><cite>./install.sh -idc</cite></td>
<td>Build library, dependencies and client, then build and install rocSPARSE package in <a href="#id82"><span class="problematic" id="id83">|br|</span></a> <cite>/opt/rocm/rocsparse</cite>. You will be prompted for sudo access. This will install for all users.</td>
</tr>
<tr class="row-even"><td><cite>./install.sh -ic</cite></td>
<td>Build library and client, then build and install rocSPARSE package in <cite>opt/rocm/rocsparse</cite>. <a href="#id84"><span class="problematic" id="id85">|br|</span></a> You will be prompted for sudo access. This will install for all users.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="using-individual-commands-to-build-rocsparse">
<h3>Using individual commands to build rocSPARSE<a class="headerlink" href="#using-individual-commands-to-build-rocsparse" title="Permalink to this headline">¶</a></h3>
<p>CMake 3.5 or later is required in order to build rocSPARSE.
The rocSPARSE library contains both, host and device code, therefore the HCC compiler must be specified during cmake configuration process.</p>
<p>rocSPARSE can be built using the following commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># Create and change to build directory
mkdir -p build/release ; cd build/release

# Default install path is /opt/rocm, use -DCMAKE_INSTALL_PREFIX=&lt;path&gt; to adjust it
CXX=/opt/rocm/bin/hcc cmake ../..

# Compile rocSPARSE library
make -j$(nproc)

# Install rocSPARSE to /opt/rocm
sudo make install
</pre></div>
</div>
<p>Boost and GoogleTest is required in order to build rocSPARSE client.</p>
<p>rocSPARSE with dependencies and client can be built using the following commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># Install boost on Ubuntu
sudo apt install libboost-program-options-dev
# Install boost on Fedora
sudo dnf install boost-program-options

# Install googletest
mkdir -p build/release/deps ; cd build/release/deps
cmake -DBUILD_BOOST=OFF ../../../deps
sudo make -j$(nproc) install

# Change to build directory
cd ..

# Default install path is /opt/rocm, use -DCMAKE_INSTALL_PREFIX=&lt;path&gt; to adjust it
CXX=/opt/rocm/bin/hcc cmake ../.. -DBUILD_CLIENTS_TESTS=ON \
                                  -DBUILD_CLIENTS_BENCHMARKS=ON \
                                  -DBUILD_CLIENTS_SAMPLES=ON

# Compile rocSPARSE library
make -j$(nproc)

# Install rocSPARSE to /opt/rocm
sudo make install
</pre></div>
</div>
</div>
<div class="section" id="id44">
<h3>Common build problems<a class="headerlink" href="#id44" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first"><strong>Issue:</strong> HIP (/opt/rocm/hip) was built using hcc 1.0.xxx-xxx-xxx-xxx, but you are using /opt/rocm/bin/hcc with version 1.0.yyy-yyy-yyy-yyy from hipcc (version mismatch). Please rebuild HIP including cmake or update HCC_HOME variable.</p>
<p><strong>Solution:</strong> Download HIP from github and use hcc to <a class="reference external" href="https://github.com/ROCm-Developer-Tools/HIP/blob/master/INSTALL.md">build from source</a> and then use the built HIP instead of /opt/rocm/hip.</p>
</li>
<li><p class="first"><strong>Issue:</strong> For Carrizo - HCC RUNTIME ERROR: Failed to find compatible kernel</p>
<p><strong>Solution:</strong> Add the following to the cmake command when configuring: <cite>-DCMAKE_CXX_FLAGS=”–amdgpu-target=gfx801”</cite></p>
</li>
<li><p class="first"><strong>Issue:</strong> For MI25 (Vega10 Server) - HCC RUNTIME ERROR: Failed to find compatible kernel</p>
<p><strong>Solution:</strong> <cite>export HCC_AMDGPU_TARGET=gfx900</cite></p>
</li>
<li><dl class="first docutils">
<dt><strong>Issue:</strong> Could not find a package configuration file provided by “ROCM” with any of the following names:</dt>
<dd><p class="first last">ROCMConfig.cmake <a href="#id86"><span class="problematic" id="id87">|br|</span></a>
rocm-config.cmake</p>
</dd>
</dl>
<p><strong>Solution:</strong> Install <a class="reference external" href="https://github.com/RadeonOpenCompute/rocm-cmake">ROCm cmake modules</a></p>
</li>
</ol>
<p>Regarding more information about rocSPARSE and it’s functions, corresponding API’s, Please refer
<a class="reference external" href="https://rocsparse.readthedocs.io/en/latest/library.html">rocsparse</a></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../ROCm_Compiler_SDK/ROCm-Compiler-SDK.html" class="btn btn-neutral float-right" title="ROCm Compiler SDK" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../ROCm_Tools/ROCm-Tools.html" class="btn btn-neutral" title="ROCm Tools" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Thomas Edvalson.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>