

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ROCm Tools &mdash; ReadTheDocs-Breathe 1.0.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ROCm Libraries" href="../ROCm_Libraries/ROCm_Libraries.html" />
    <link rel="prev" title="ROCm API References" href="../ROCm_API_References/ROCm-API-References.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> ReadTheDocs-Breathe
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../ROCm.html">Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Current_Release_Notes/Current-Release-Notes.html">Current Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Installation_Guide/Installation-Guide.html">ROCm Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Programming_Guides/Programming-Guides.html">Programming Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ROCm_GPU_Tunning_Guides/ROCm-GPU-Tunning-Guides.html">ROCm GPU Tuning Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GCN_ISA_Manuals/GCN-ISA-Manuals.html">GCN ISA Manuals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ROCm_API_References/ROCm-API-References.html">ROCm API References</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">ROCm Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#hcc">HCC</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#download-hcc">Download HCC</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-hcc-from-source">Build HCC from source</a></li>
<li class="toctree-l3"><a class="reference internal" href="#use-hcc">Use HCC</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multiple-isa">Multiple ISA</a></li>
<li class="toctree-l3"><a class="reference internal" href="#codexl-activity-logger">CodeXL Activity Logger</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hcc-with-thinlto-linking">HCC with ThinLTO Linking</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gcn-assembler-and-disassembler">GCN Assembler and Disassembler</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gcn-assembler-tools">GCN Assembler Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="#roc-profiler">ROC Profiler</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#download">Download</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build">Build</a></li>
<li class="toctree-l3"><a class="reference internal" href="#profiling-tool-rocprof-usage">Profiling Tool ‘rocprof’ Usage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#rocr-debug-agent">ROCr Debug Agent</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rocm-gdb">ROCm-GDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rocm-profiler">ROCm-Profiler</a></li>
<li class="toctree-l2"><a class="reference internal" href="#codexl">CodeXL</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#motivation">Motivation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation-and-build">Installation and Build</a></li>
<li class="toctree-l3"><a class="reference internal" href="#contributors">Contributors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#license">License</a></li>
<li class="toctree-l3"><a class="reference internal" href="#attribution-and-copyrights">Attribution and Copyrights</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gpuperfapi">GPUperfAPI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#major-features">Major Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="#what-s-new">What’s New</a></li>
<li class="toctree-l3"><a class="reference internal" href="#system-requirements">System Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cloning-the-repository">Cloning the Repository</a></li>
<li class="toctree-l3"><a class="reference internal" href="#source-code-directory-layout">Source Code Directory Layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="#public-vs-internal-versions">Public” vs “Internal” Versions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#known-issues">Known Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#rocm-binary-utilities">ROCm Binary Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mivisionx">MIVisionX</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#amd-openvx-amd-openvx">AMD OpenVX (amd_openvx)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#features">Features</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pre-requisites">Pre-requisites:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#build-instructions">Build Instructions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#build-using-visual-studio-professional-2013-on-64-bit-windows-10-8-1-7">Build using Visual Studio Professional 2013 on 64-bit Windows 10/8.1/7</a></li>
<li class="toctree-l4"><a class="reference internal" href="#build-using-cmake">Build using CMake</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#amd-openvx-extensions-amd-openvx-extensions">AMD OpenVX Extensions (amd_openvx_extensions)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#radeon-loom-stitching-library-vx-loomsl">Radeon Loom Stitching Library (vx_loomsl)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#openvx-neural-network-extension-library-vx-nn">OpenVX Neural Network Extension Library (vx_nn)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#amd-module-for-opencv-interop-from-openvx-vx-opencv">AMD Module for OpenCV-interop from OpenVX (vx_opencv)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#applications">Applications</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cloud-inference-application-cloud-inference">Cloud Inference Application (cloud_inference)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#convert-neural-net-models-into-amd-nnir-and-openvx-code">Convert Neural Net models into AMD NNIR and OpenVX Code</a></li>
<li class="toctree-l4"><a class="reference internal" href="#currently-supported">Currently supported</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#samples">Samples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#gdf-graph-description-format">GDF - Graph Description Format</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mivisionx-toolkit">MIVisionX Toolkit</a></li>
<li class="toctree-l3"><a class="reference internal" href="#utilities">Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id19">Pre-requisites</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pre-requisites-setup-script-mivisionx-setup-py">Pre-requisites setup script - MIVisionX-setup.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="#prerequisites-for-running-the-scripts">Prerequisites for running the scripts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#build-mivisionx">Build MIVisionX</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#build-using-cmake-on-linux-ubuntu-16-04-64-bit-with-rocm">Build using CMake on Linux (Ubuntu 16.04 64-bit) with ROCm</a></li>
<li class="toctree-l4"><a class="reference internal" href="#build-anninferenceapp-using-qt-creator">Build annInferenceApp using Qt Creator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#build-radeon-loom-using-visual-studio-professional-2013-on-64-bit-windows-10-8-1-7">Build Radeon LOOM using Visual Studio Professional 2013 on 64-bit Windows 10/8.1/7</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#docker">Docker</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mivisionx-docker">MIVisionX Docker</a></li>
<li class="toctree-l4"><a class="reference internal" href="#docker-workflow-sample-on-ubuntu-16-04">Docker Workflow Sample on Ubuntu 16.04</a></li>
<li class="toctree-l4"><a class="reference internal" href="#workflow">Workflow</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#release-notes">Release Notes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#supported-neural-net-layers">Supported Neural Net Layers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id27">Known issues</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tested-configurations">Tested configurations</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ROCm_Libraries/ROCm_Libraries.html">ROCm Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ROCm_Compiler_SDK/ROCm-Compiler-SDK.html">ROCm Compiler SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ROCm_System_Managment/ROCm-System-Managment.html">ROCm System Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ROCm_Virtualization_Containers/ROCm-Virtualization-&amp;-Containers.html">ROCm Virtualization &amp; Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Remote_Device_Programming/Remote-Device-Programming.html">Remote Device Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Deep_learning/Deep-learning.html">Deep Learning on ROCm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Other_Solutions/Other-Solutions.html">System Level Debug</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorial/Tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ROCm_Glossary/ROCm-Glossary.html">ROCm Glossary</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ReadTheDocs-Breathe</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>ROCm Tools</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/ROCm_Tools/ROCm-Tools.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="rocm-tools">
<span id="id1"></span><h1>ROCm Tools<a class="headerlink" href="#rocm-tools" title="Permalink to this headline">¶</a></h1>
<div class="section" id="hcc">
<h2>HCC<a class="headerlink" href="#hcc" title="Permalink to this headline">¶</a></h2>
<p><strong>HCC is an Open Source, Optimizing C++ Compiler for Heterogeneous Compute</strong></p>
<p>This repository hosts the HCC compiler implementation project. The goal is to implement a compiler that takes a program that conforms to a parallel programming standard such as C++ AMP, HC, C++ 17 ParallelSTL, or OpenMP, and transforms it into the AMD GCN ISA.</p>
<p>The project is based on LLVM+CLANG. For more information, please visit the <a class="reference internal" href="HCC_WIKI.html#hccwiki"><span class="std std-ref">HCC WIKI</span></a></p>
<div class="section" id="download-hcc">
<h3>Download HCC<a class="headerlink" href="#download-hcc" title="Permalink to this headline">¶</a></h3>
<p>The project now employs git submodules to manage external components it depends upon. It it advised to add –recursive when you clone the project so all submodules are fetched automatically.</p>
<p>For example:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># automatically fetches all submodules</span>
<span class="n">git</span> <span class="n">clone</span> <span class="o">--</span><span class="n">recursive</span> <span class="o">-</span><span class="n">b</span> <span class="n">clang_tot_upgrade</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">RadeonOpenCompute</span><span class="o">/</span><span class="n">hcc</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<p>For more information about git submodules, please refer to <a class="reference external" href="https://git-scm.com/book/en/v2/Git-Tools-Submodules">git documentation</a>.</p>
</div>
<div class="section" id="build-hcc-from-source">
<h3>Build HCC from source<a class="headerlink" href="#build-hcc-from-source" title="Permalink to this headline">¶</a></h3>
<p>To configure and build HCC from source, use the following steps:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="n">build</span><span class="p">;</span> <span class="n">cd</span> <span class="n">build</span>
<span class="n">cmake</span> <span class="o">-</span><span class="n">DCMAKE_BUILD_TYPE</span><span class="o">=</span><span class="n">Release</span> <span class="o">..</span>
<span class="n">make</span>
</pre></div>
</div>
<p>To install it, use the following steps:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">make</span> <span class="n">install</span>
</pre></div>
</div>
</div>
<div class="section" id="use-hcc">
<h3>Use HCC<a class="headerlink" href="#use-hcc" title="Permalink to this headline">¶</a></h3>
<p>For C++AMP source codes:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span>hcc `clamp-config --cxxflags --ldflags` foo.cpp
</pre></div>
</div>
<p><strong>WARNING: From ROCm version 2.0 onwards C++AMP is no longer available in HCC.</strong></p>
<p>For HC source codes:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span>hcc `hcc-config --cxxflags --ldflags` foo.cpp
</pre></div>
</div>
<p>In case you build HCC from source and want to use the compiled binaries directly in the build directory:</p>
<p>For C++AMP source codes:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span># notice the --build flag
bin/hcc `bin/clamp-config --build --cxxflags --ldflags` foo.cpp
</pre></div>
</div>
<p><strong>WARNING: From ROCm version 2.0 onwards C++AMP is no longer available in HCC.</strong></p>
<p>For HC source codes:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span># notice the --build flag
bin/hcc `bin/hcc-config --build --cxxflags --ldflags` foo.cpp
</pre></div>
</div>
</div>
<div class="section" id="multiple-isa">
<h3>Multiple ISA<a class="headerlink" href="#multiple-isa" title="Permalink to this headline">¶</a></h3>
<p>HCC now supports having multiple GCN ISAs in one executable file. You can do it in different ways:
<strong>use :: ``–amdgpu-target=`` command line option</strong></p>
<p>It’s possible to specify multiple <a href="#id2"><span class="problematic" id="id3">``</span></a>–amdgpu-target=``option.</p>
<p>Example:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span># ISA for Hawaii(gfx701), Carrizo(gfx801), Tonga(gfx802) and Fiji(gfx803) would
# be produced
 hcc `hcc-config --cxxflags --ldflags` \
   --amdgpu-target=gfx701 \
   --amdgpu-target=gfx801 \
   --amdgpu-target=gfx802 \
   --amdgpu-target=gfx803 \
   foo.cpp
</pre></div>
</div>
<p><strong>use ``HCC_AMDGPU_TARGET`` env var</strong></p>
<p>use <code class="docutils literal notranslate"><span class="pre">,</span></code> to delimit each AMDGPU target in HCC. Example:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span>export HCC_AMDGPU_TARGET=gfx701,gfx801,gfx802,gfx803
# ISA for Hawaii(gfx701), Carrizo(gfx801), Tonga(gfx802) and Fiji(gfx803) would
# be produced
hcc `hcc-config --cxxflags --ldflags` foo.cpp
</pre></div>
</div>
<p><strong>configure HCC use CMake ``HSA_AMDGPU_GPU_TARGET`` variable</strong></p>
<p>If you build HCC from source, it’s possible to configure it to automatically produce multiple ISAs via <cite>HSA_AMDGPU_GPU_TARGET</cite> CMake variable.</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">;</span></code> to delimit each AMDGPU target.
Example:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># ISA for Hawaii(gfx701), Carrizo(gfx801), Tonga(gfx802) and Fiji(gfx803) would</span>
<span class="c1"># be produced by default</span>
<span class="n">cmake</span> \
   <span class="o">-</span><span class="n">DCMAKE_BUILD_TYPE</span><span class="o">=</span><span class="n">Release</span> \
   <span class="o">-</span><span class="n">DROCM_DEVICE_LIB_DIR</span><span class="o">=~</span><span class="n">hcc</span><span class="o">/</span><span class="n">ROCm</span><span class="o">-</span><span class="n">Device</span><span class="o">-</span><span class="n">Libs</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">dist</span><span class="o">/</span><span class="n">lib</span> \
   <span class="o">-</span><span class="n">DHSA_AMDGPU_GPU_TARGET</span><span class="o">=</span><span class="s2">&quot;gfx701;gfx801;gfx802;gfx803&quot;</span> \
   <span class="o">../</span><span class="n">hcc</span>
</pre></div>
</div>
</div>
<div class="section" id="codexl-activity-logger">
<h3>CodeXL Activity Logger<a class="headerlink" href="#codexl-activity-logger" title="Permalink to this headline">¶</a></h3>
<p>To enable the <a class="reference external" href="https://github.com/RadeonOpenCompute/ROCm-Profiler/tree/master/CXLActivityLogger">CodeXL Activity Logger</a>, use the  <code class="docutils literal notranslate"><span class="pre">USE_CODEXL_ACTIVITY_LOGGER</span></code> environment variable.</p>
<p>Configure the build in the following way:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cmake</span> \
  <span class="o">-</span><span class="n">DCMAKE_BUILD_TYPE</span><span class="o">=</span><span class="n">Release</span> \
  <span class="o">-</span><span class="n">DHSA_AMDGPU_GPU_TARGET</span><span class="o">=&lt;</span><span class="n">AMD</span> <span class="n">GPU</span> <span class="n">ISA</span> <span class="n">version</span> <span class="n">string</span><span class="o">&gt;</span> \
  <span class="o">-</span><span class="n">DROCM_DEVICE_LIB_DIR</span><span class="o">=&lt;</span><span class="n">location</span> <span class="n">of</span> <span class="n">the</span> <span class="n">ROCm</span><span class="o">-</span><span class="n">Device</span><span class="o">-</span><span class="n">Libs</span> <span class="n">bitcode</span><span class="o">&gt;</span> \
  <span class="o">-</span><span class="n">DUSE_CODEXL_ACTIVITY_LOGGER</span><span class="o">=</span><span class="mi">1</span> \
  <span class="o">&lt;</span><span class="n">ToT</span> <span class="n">HCC</span> <span class="n">checkout</span> <span class="n">directory</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>In your application compiled using hcc, include the CodeXL Activiy Logger header:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;CXLActivityLogger.h&gt;</span>
</pre></div>
</div>
<p>For information about the usage of the Activity Logger for profiling, please refer to its <a class="reference external" href="https://github.com/RadeonOpenCompute/ROCm-Profiler/blob/master/CXLActivityLogger/doc/AMDTActivityLogger.pdf">documentation</a>.</p>
</div>
<div class="section" id="hcc-with-thinlto-linking">
<h3>HCC with ThinLTO Linking<a class="headerlink" href="#hcc-with-thinlto-linking" title="Permalink to this headline">¶</a></h3>
<p>To enable the ThinLTO link time, use the <code class="docutils literal notranslate"><span class="pre">KMTHINLTO</span></code> environment variable.</p>
<p>Set up your environment in the following way:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">KMTHINLTO</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
<p><strong>ThinLTO Phase 1 - Implemented</strong></p>
<p>For applications compiled using hcc, ThinLTO could significantly improve link-time performance. This implementation will maintain kernels in their .bc file format, create module-summaries for each, perform llvm-lto’s cross-module function importing and then perform clamp-device (which uses opt and llc tools) on each of the kernel files. These files are linked with lld into one .hsaco per target specified.</p>
<p><strong>ThinLTO Phase 2 - Under development</strong>
This ThinLTO implementation which will use llvm-lto LLVM tool to replace clamp-device bash script. It adds an optllc option into ThinLTOGenerator, which will perform in-program opt and codegen in parallel.</p>
</div>
</div>
<div class="section" id="gcn-assembler-and-disassembler">
<h2>GCN Assembler and Disassembler<a class="headerlink" href="#gcn-assembler-and-disassembler" title="Permalink to this headline">¶</a></h2>
<p>The ability to write code in assembly is essential to achieving the best performance for a GPU program. In a previous blog we described how to combine several languages in a single program using ROCm and Hsaco. This article explains how to produce Hsaco from assembly code and also takes a closer look at some new features of the GCN architecture. I’d like to thank Ilya Perminov of Luxsoft for co-authoring this blog post. Programs written for GPUs should achieve the highest performance possible. Even carefully written ones, however, won’t always employ 100% of the GPU’s capabilities. Some reasons are the following:</p>
<blockquote>
<div><ul class="simple">
<li>The program may be written in a high level language that does not expose all of the features available on the hardware.</li>
<li>The compiler is unable to produce optimal ISA code, either because the compiler needs to ‘play it safe’ while adhering to the        semantics of a language or because the compiler itself is generating un-optimized code.</li>
</ul>
</div></blockquote>
<p>Consider a program that uses one of GCN’s new features (source code is available on <a class="reference external" href="https://github.com/RadeonOpenCompute/LLVM-AMDGPU-Assembler-Extra">GitHub</a>). Recent hardware architecture updates—DPP and DS Permute instructions—enable efficient data sharing between wavefront lanes. To become more familiar with the instruction set, review the <a class="reference external" href="https://github.com/olvaffe/gpu-docs/blob/master/amd-open-gpu-docs/AMD_GCN3_Instruction_Set_Architecture.pdf">GCN ISA Reference Guide</a>. Note: the assembler is currently experimental; some of syntax we describe may change.</p>
<p>Two new instructions, ds_permute_b32 and ds_bpermute_b32, allow VGPR data to move between lanes on the basis of an index from another VGPR. These instructions use LDS hardware to route data between the 64 lanes, but they don’t write to LDS memory. The difference between them is what to index: the source-lane ID or the destination-lane ID. In other words, ds_permute_b32 says “put my lane data in lane i,” and ds_bpermute_b32 says “read data from lane i.” The GCN ISA Reference Guide provides a more formal description. The test kernel is simple: read the initial data and indices from memory into GPRs, do the permutation in the GPRs and write the data back to memory. An analogous OpenCL kernel would have this form:</p>
<div class="code cpp highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">__kernel</span> <span class="n">void</span> <span class="n">hello_world</span><span class="p">(</span><span class="n">__global</span> <span class="n">const</span> <span class="n">uint</span> <span class="o">*</span> <span class="ow">in</span><span class="p">,</span> <span class="n">__global</span> <span class="n">const</span> <span class="n">uint</span> <span class="o">*</span> <span class="n">index</span><span class="p">,</span> <span class="n">__global</span> <span class="n">uint</span> <span class="o">*</span> <span class="n">out</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="n">get_global_id</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="ow">in</span><span class="p">[</span> <span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Formal HSA arguments are passed to a kernel using a special read-only memory segment called kernarg. Before a wavefront starts, the base address of the kernarg segment is written to an SGPR pair. The memory layout of variables in kernarg must employ the same order as the list of kernel formal arguments, starting at offset 0, with no padding between variables—except to honor the requirements of natural alignment and any align qualifier. The example host program must create the kernarg segment and fill it with the buffer base addresses. The HSA host code might look like the following:</p>
<div class="code cpp highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span>
<span class="o">*</span> <span class="n">This</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">host</span><span class="o">-</span><span class="n">side</span> <span class="n">representation</span> <span class="n">of</span> <span class="n">the</span> <span class="n">kernel</span> <span class="n">arguments</span> <span class="n">that</span> <span class="n">the</span> <span class="n">simplePermute</span> <span class="n">kernel</span> <span class="n">expects</span><span class="o">.</span>
<span class="o">*/</span>
<span class="n">struct</span> <span class="n">simplePermute_args_t</span> <span class="p">{</span>
      <span class="n">uint32_t</span> <span class="o">*</span> <span class="ow">in</span><span class="p">;</span>
      <span class="n">uint32_t</span> <span class="o">*</span> <span class="n">index</span><span class="p">;</span>
      <span class="n">uint32_t</span> <span class="o">*</span> <span class="n">out</span><span class="p">;</span>
<span class="p">};</span>
<span class="o">/*</span>
 <span class="o">*</span> <span class="n">Allocate</span> <span class="n">the</span> <span class="n">kernel</span><span class="o">-</span><span class="n">argument</span> <span class="n">buffer</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">correct</span> <span class="n">region</span><span class="o">.</span>
<span class="o">*/</span>
<span class="n">hsa_status_t</span> <span class="n">status</span><span class="p">;</span>
<span class="n">simplePermute_args_t</span> <span class="o">*</span> <span class="n">args</span> <span class="o">=</span> <span class="n">NULL</span><span class="p">;</span>
<span class="n">status</span> <span class="o">=</span> <span class="n">hsa_memory_allocate</span><span class="p">(</span><span class="n">kernarg_region</span><span class="p">,</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">simplePermute_args_t</span><span class="p">),</span> <span class="p">(</span><span class="n">void</span><span class="o">**</span><span class="p">)(</span><span class="o">&amp;</span><span class="n">args</span><span class="p">));</span>
<span class="k">assert</span><span class="p">(</span><span class="n">HSA_STATUS_SUCCESS</span> <span class="o">==</span> <span class="n">status</span><span class="p">);</span>
<span class="n">aql</span><span class="o">-&gt;</span><span class="n">kernarg_address</span> <span class="o">=</span> <span class="n">args</span><span class="p">;</span>
<span class="o">/*</span>
<span class="o">*</span> <span class="n">Write</span> <span class="n">the</span> <span class="n">args</span> <span class="n">directly</span> <span class="n">to</span> <span class="n">the</span> <span class="n">kernargs</span> <span class="n">buffer</span><span class="p">;</span>
<span class="o">*</span> <span class="n">the</span> <span class="n">code</span> <span class="n">assumes</span> <span class="n">that</span> <span class="n">memory</span> <span class="ow">is</span> <span class="n">already</span> <span class="n">allocated</span> <span class="k">for</span> <span class="n">the</span>
<span class="o">*</span> <span class="n">buffers</span> <span class="n">that</span> <span class="n">in_ptr</span><span class="p">,</span> <span class="n">index_ptr</span> <span class="ow">and</span> <span class="n">out_ptr</span> <span class="n">point</span> <span class="n">to</span>
<span class="o">*/</span>
<span class="n">args</span><span class="o">-&gt;</span><span class="ow">in</span> <span class="o">=</span> <span class="n">in_ptr</span><span class="p">;</span>
<span class="n">args</span><span class="o">-&gt;</span><span class="n">index</span> <span class="o">=</span> <span class="n">index_ptr</span><span class="p">;</span>
<span class="n">args</span><span class="o">-&gt;</span><span class="n">out</span> <span class="o">=</span> <span class="n">out_ptr</span><span class="p">;</span>
</pre></div>
</div>
<p>The host program should also allocate memory for the in, index and out buffers. In the GitHub repository, all the run-time-related  stuff is hidden in the Dispatch and Buffer classes, so the sample code looks much cleaner:</p>
<div class="code cpp highlight-default notranslate"><div class="highlight"><pre><span></span>// Create Kernarg segment
if (!AllocateKernarg(3 * sizeof(void*))) { return false; }

// Create buffers
Buffer *in, *index, *out;
in = AllocateBuffer(size);
index = AllocateBuffer(size);
out = AllocateBuffer(size);

// Fill Kernarg memory
Kernarg(in); // Add base pointer to “in” buffer
Kernarg(index); // Append base pointer to “index” buffer
Kernarg(out); // Append base pointer to “out” buffer
</pre></div>
</div>
<p>Initial Wavefront and Register State To launch a kernel in real hardware, the run time needs information about the kernel, such as</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li>The LDS size</li>
<li>The number of GPRs</li>
<li>Which registers need initialization before the kernel starts</li>
</ul>
</div></blockquote>
<p>All this data resides in the amd_kernel_code_t structure. A full description of the structure is available in the <a class="reference external" href="http://rocm-documentation.readthedocs.io/en/latest/ROCm_Compiler_SDK/ROCm-Codeobj-format.html?highlight=finalizer">AMDGPU-ABI</a>           specification. This is what it looks like in source code:</p>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">hsa_code_object_version</span> <span class="mi">2</span><span class="p">,</span><span class="mi">0</span>
<span class="o">.</span><span class="n">hsa_code_object_isa</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;AMD&quot;</span><span class="p">,</span> <span class="s2">&quot;AMDGPU&quot;</span>

<span class="o">.</span><span class="n">text</span>
<span class="o">.</span><span class="n">p2align</span> <span class="mi">8</span>
<span class="o">.</span><span class="n">amdgpu_hsa_kernel</span> <span class="n">hello_world</span>

<span class="n">hello_world</span><span class="p">:</span>

<span class="o">.</span><span class="n">amd_kernel_code_t</span>
<span class="n">enable_sgpr_kernarg_segment_ptr</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">is_ptr64</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">compute_pgm_rsrc1_vgprs</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">compute_pgm_rsrc1_sgprs</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">compute_pgm_rsrc2_user_sgpr</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">kernarg_segment_byte_size</span> <span class="o">=</span> <span class="mi">24</span>
<span class="n">wavefront_sgpr_count</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">workitem_vgpr_count</span> <span class="o">=</span> <span class="mi">5</span>
<span class="o">.</span><span class="n">end_amd_kernel_code_t</span>

<span class="n">s_load_dwordx2</span>  <span class="n">s</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">],</span> <span class="mh">0x10</span>
<span class="n">s_load_dwordx4</span>  <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">],</span> <span class="mh">0x00</span>
<span class="n">v_lshlrev_b32</span>  <span class="n">v0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">v0</span>
<span class="n">s_waitcnt</span>     <span class="n">lgkmcnt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">v_add_u32</span>     <span class="n">v1</span><span class="p">,</span> <span class="n">vcc</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">v0</span>
<span class="n">v_mov_b32</span>     <span class="n">v2</span><span class="p">,</span> <span class="n">s3</span>
<span class="n">v_addc_u32</span>    <span class="n">v2</span><span class="p">,</span> <span class="n">vcc</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">vcc</span>
<span class="n">v_add_u32</span>     <span class="n">v3</span><span class="p">,</span> <span class="n">vcc</span><span class="p">,</span> <span class="n">s0</span><span class="p">,</span> <span class="n">v0</span>
<span class="n">v_mov_b32</span>     <span class="n">v4</span><span class="p">,</span> <span class="n">s1</span>
<span class="n">v_addc_u32</span>    <span class="n">v4</span><span class="p">,</span> <span class="n">vcc</span><span class="p">,</span> <span class="n">v4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">vcc</span>
<span class="n">flat_load_dword</span>  <span class="n">v1</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">flat_load_dword</span>  <span class="n">v2</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
<span class="n">s_waitcnt</span>     <span class="n">vmcnt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">lgkmcnt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">v_lshlrev_b32</span>  <span class="n">v1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">v1</span>
<span class="n">ds_bpermute_b32</span>  <span class="n">v1</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span>
<span class="n">v_add_u32</span>     <span class="n">v3</span><span class="p">,</span> <span class="n">vcc</span><span class="p">,</span> <span class="n">s4</span><span class="p">,</span> <span class="n">v0</span>
<span class="n">v_mov_b32</span>     <span class="n">v2</span><span class="p">,</span> <span class="n">s5</span>
<span class="n">v_addc_u32</span>    <span class="n">v4</span><span class="p">,</span> <span class="n">vcc</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">vcc</span>
<span class="n">s_waitcnt</span>     <span class="n">lgkmcnt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">flat_store_dword</span>  <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> <span class="n">v1</span>
<span class="n">s_endpgm</span>
</pre></div>
</div>
<p>Currently, a programmer must manually set all non-default values to provide the necessary information. Hopefully, this situation will change with new updates that bring automatic register counting and possibly a new syntax to fill that structure. Before the start of every wavefront execution, the GPU sets up the register state on the basis of the enable_sgpr_* and enable_vgpr_* flags. VGPR v0 is always initialized with a work-item ID in the x dimension. Registers v1 and v2 can be initialized with work-item IDs in the y and z dimensions, respectively. Scalar GPRs can be initialized with a work-group ID and work-group count in each dimension, a dispatch ID, and pointers to kernarg, the aql packet, the aql queue, and so on. Again, the AMDGPU-ABI specification contains a full list in in the section on initial register state. For this example, a 64-bit base kernarg address will be stored in the s[0:1] registers (enable_sgpr_kernarg_segment_ptr = 1), and the work-item thread ID will occupy v0 (by default). Below is the scheme showing initial state for our kernel. initial_state</p>
<p>The next amd_kernel_code_t fields are obvious: is_ptr64 = 1 says we are in 64-bit mode, and kernarg_segment_byte_size = 24 describes the kernarg segment size. The GPR counting is less straightforward, however. The workitem_vgpr_count holds the number of vector registers that each work item uses, and wavefront_sgpr_count holds the number of scalar registers that a wavefront uses. The code above employs v0–v4, so workitem_vgpr_count = 5. But wavefront_sgpr_count = 8 even though the code only shows s0–s5, since the special registers VCC, FLAT_SCRATCH and XNACK are physically stored as part of the wavefront’s SGPRs in the highest-numbered SGPRs. In this example, FLAT_SCRATCH and XNACK are disabled, so VCC has only two additional registers. In current GCN3 hardware, VGPRs are allocated in groups of 4 registers and SGPRs in groups of 16. Previous generations (GCN1 and GCN2) have a VGPR granularity of 4 registers and an SGPR granularity of 8 registers. The fields compute_pgm_rsrc1_*gprs contain a device-specific number for each register-block type to allocate for a wavefront. As we said previously, future updates may enable automatic counting, but for now you can use following formulas for all three GCN GPU generations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">compute_pgm_rsrc1_vgprs</span> <span class="o">=</span> <span class="p">(</span><span class="n">workitem_vgpr_count</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span>

<span class="n">compute_pgm_rsrc1_sgprs</span> <span class="o">=</span> <span class="p">(</span><span class="n">wavefront_sgpr_count</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span>
</pre></div>
</div>
<p>Now consider the corresponding assembly:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">initial</span> <span class="n">state</span><span class="p">:</span>
<span class="o">//</span>   <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">kernarg</span> <span class="n">base</span> <span class="n">address</span>
<span class="o">//</span>   <span class="n">v0</span> <span class="o">-</span> <span class="n">workitem</span> <span class="nb">id</span>

<span class="n">s_load_dwordx2</span>  <span class="n">s</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">],</span> <span class="mh">0x10</span>  <span class="o">//</span> <span class="n">load</span> <span class="n">out_ptr</span> <span class="n">into</span> <span class="n">s</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="kn">from</span> <span class="nn">kernarg</span>
<span class="n">s_load_dwordx4</span>  <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">],</span> <span class="mh">0x00</span>  <span class="o">//</span> <span class="n">load</span> <span class="n">in_ptr</span> <span class="n">into</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">index_ptr</span> <span class="n">into</span> <span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="kn">from</span> <span class="nn">kernarg</span>
<span class="n">v_lshlrev_b32</span>  <span class="n">v0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">v0</span>              <span class="o">//</span> <span class="n">v0</span> <span class="o">*=</span> <span class="mi">4</span><span class="p">;</span>
<span class="n">s_waitcnt</span>     <span class="n">lgkmcnt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>              <span class="o">//</span> <span class="n">wait</span> <span class="k">for</span> <span class="n">memory</span> <span class="n">reads</span> <span class="n">to</span> <span class="n">finish</span>

<span class="o">//</span> <span class="n">compute</span> <span class="n">address</span> <span class="n">of</span> <span class="n">corresponding</span> <span class="n">element</span> <span class="n">of</span> <span class="n">index</span> <span class="n">buffer</span>
<span class="o">//</span> <span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">index</span><span class="p">[</span><span class="n">workitem_id</span><span class="p">]</span>
<span class="n">v_add_u32</span>     <span class="n">v1</span><span class="p">,</span> <span class="n">vcc</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">v0</span>
<span class="n">v_mov_b32</span>     <span class="n">v2</span><span class="p">,</span> <span class="n">s3</span>
<span class="n">v_addc_u32</span>    <span class="n">v2</span><span class="p">,</span> <span class="n">vcc</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">vcc</span>

<span class="o">//</span> <span class="n">compute</span> <span class="n">address</span> <span class="n">of</span> <span class="n">corresponding</span> <span class="n">element</span> <span class="n">of</span> <span class="ow">in</span> <span class="n">buffer</span>
<span class="o">//</span> <span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="o">&amp;</span><span class="ow">in</span><span class="p">[</span><span class="n">workitem_id</span><span class="p">]</span>
<span class="n">v_add_u32</span>     <span class="n">v3</span><span class="p">,</span> <span class="n">vcc</span><span class="p">,</span> <span class="n">s0</span><span class="p">,</span> <span class="n">v0</span>
<span class="n">v_mov_b32</span>     <span class="n">v4</span><span class="p">,</span> <span class="n">s1</span>
<span class="n">v_addc_u32</span>    <span class="n">v4</span><span class="p">,</span> <span class="n">vcc</span><span class="p">,</span> <span class="n">v4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">vcc</span>

<span class="n">flat_load_dword</span>  <span class="n">v1</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">//</span> <span class="n">load</span> <span class="n">index</span><span class="p">[</span><span class="n">workitem_id</span><span class="p">]</span> <span class="n">into</span> <span class="n">v1</span>
<span class="n">flat_load_dword</span>  <span class="n">v2</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">//</span> <span class="n">load</span> <span class="ow">in</span><span class="p">[</span><span class="n">workitem_id</span><span class="p">]</span> <span class="n">into</span> <span class="n">v2</span>
<span class="n">s_waitcnt</span>     <span class="n">vmcnt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">lgkmcnt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">//</span> <span class="n">wait</span> <span class="k">for</span> <span class="n">memory</span> <span class="n">reads</span> <span class="n">to</span> <span class="n">finish</span>

<span class="o">//</span> <span class="n">v1</span> <span class="o">*=</span> <span class="mi">4</span><span class="p">;</span> <span class="n">ds_bpermute_b32</span> <span class="n">uses</span> <span class="n">byte</span> <span class="n">offset</span> <span class="ow">and</span> <span class="n">registers</span> <span class="n">are</span> <span class="n">dwords</span>
<span class="n">v_lshlrev_b32</span>  <span class="n">v1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">v1</span>

<span class="o">//</span> <span class="n">perform</span> <span class="n">permutation</span>
<span class="o">//</span> <span class="n">temp</span><span class="p">[</span><span class="n">thread_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">v2</span>
<span class="o">//</span> <span class="n">v1</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">v1</span><span class="p">]</span>
<span class="o">//</span> <span class="n">effectively</span> <span class="n">we</span> <span class="n">got</span> <span class="n">v1</span> <span class="o">=</span> <span class="ow">in</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="n">thread_id</span><span class="p">]]</span>
<span class="n">ds_bpermute_b32</span>  <span class="n">v1</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span>

<span class="o">//</span> <span class="n">compute</span> <span class="n">address</span> <span class="n">of</span> <span class="n">corresponding</span> <span class="n">element</span> <span class="n">of</span> <span class="n">out</span> <span class="n">buffer</span>
<span class="o">//</span> <span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span> <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">out</span><span class="p">[</span><span class="n">workitem_id</span><span class="p">]</span>
<span class="n">v_add_u32</span>     <span class="n">v3</span><span class="p">,</span> <span class="n">vcc</span><span class="p">,</span> <span class="n">s4</span><span class="p">,</span> <span class="n">v0</span>
<span class="n">v_mov_b32</span>     <span class="n">v2</span><span class="p">,</span> <span class="n">s5</span>
<span class="n">v_addc_u32</span>    <span class="n">v4</span><span class="p">,</span> <span class="n">vcc</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">vcc</span>

<span class="n">s_waitcnt</span>     <span class="n">lgkmcnt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">//</span> <span class="n">wait</span> <span class="k">for</span> <span class="n">permutation</span> <span class="n">to</span> <span class="n">finish</span>

<span class="o">//</span> <span class="n">store</span> <span class="n">final</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">out</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span> <span class="n">out</span><span class="p">[</span><span class="n">workitem_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">v1</span>
<span class="n">flat_store_dword</span>  <span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> <span class="n">v1</span>

<span class="n">s_endpgm</span>
</pre></div>
</div>
<p>The next step is to produce a Hsaco from the ASM source. LLVM has added support for the AMDGCN assembler, so you can use Clang to do all the necessary magic:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">clang</span> <span class="o">-</span><span class="n">x</span> <span class="n">assembler</span> <span class="o">-</span><span class="n">target</span> <span class="n">amdgcn</span><span class="o">--</span><span class="n">amdhsa</span> <span class="o">-</span><span class="n">mcpu</span><span class="o">=</span><span class="n">fiji</span> <span class="o">-</span><span class="n">c</span> <span class="o">-</span><span class="n">o</span> <span class="n">test</span><span class="o">.</span><span class="n">o</span> <span class="n">asm_source</span><span class="o">.</span><span class="n">s</span>

<span class="n">clang</span> <span class="o">-</span><span class="n">target</span> <span class="n">amdgcn</span><span class="o">--</span><span class="n">amdhsa</span> <span class="n">test</span><span class="o">.</span><span class="n">o</span> <span class="o">-</span><span class="n">o</span> <span class="n">test</span><span class="o">.</span><span class="n">co</span>
</pre></div>
</div>
<p>The first command assembles an object file from the assembly source, and the second one links everything (you could have multiple source files) into a Hsaco. Now, you can load and run kernels from that Hsaco in a program. The <a class="reference external" href="https://github.com/RadeonOpenCompute/LLVM-AMDGPU-Assembler-Extra">GitHub examples</a> use Cmake to automatically compile ASM sources. In a future post we will cover DPP, another GCN cross-lane feature that allows vector instructions to grab operands from a neighboring lane.</p>
</div>
<div class="section" id="gcn-assembler-tools">
<h2>GCN Assembler Tools<a class="headerlink" href="#gcn-assembler-tools" title="Permalink to this headline">¶</a></h2>
<p>This repository contains the following useful items related to AMDGPU ISA assembler:</p>
<blockquote>
<div><ul class="simple">
<li>amdphdrs: utility to convert ELF produced by llvm-mc into AMD Code Object (v1)</li>
<li>examples/asm-kernel: example of AMDGPU kernel code</li>
<li>examples/gfx8/ds_bpermute: transfer data between lanes in a wavefront with ds_bpermute_b32</li>
<li>examples/gfx8/dpp_reduce: calculate prefix sum in a wavefront with DPP instructions</li>
<li>examples/gfx8/s_memrealtime: use s_memrealtime instruction to create a delay</li>
<li>examples/gfx8/s_memrealtime_inline: inline assembly in OpenCL kernel version of s_memrealtime</li>
<li>examples/api/assemble: use LLVM API to assemble a kernel</li>
<li>examples/api/disassemble: use LLVM API to disassemble a stream of instructions</li>
<li>bin/sp3_to_mc.pl: script to convert some AMD sp3 legacy assembler syntax into LLVM MC</li>
<li>examples/sp3: examples of sp3 convertable code</li>
</ul>
</div></blockquote>
<p>At the time of this writing (February 2016), LLVM trunk build and latest ROCR runtime is needed.</p>
<p>LLVM trunk (May or later) now uses lld as linker and produces AMD Code Object (v2).</p>
<p>Top-level CMakeLists.txt is provided to build everything included. The following CMake variables should be set:</p>
<blockquote>
<div><ul class="simple">
<li>HSA_DIR (default /opt/hsa/bin): path to ROCR Runtime</li>
<li>LLVM_DIR: path to LLVM build directory</li>
</ul>
</div></blockquote>
<p>To build everything, create build directory and run cmake and make:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="n">build</span>
<span class="n">cd</span> <span class="n">build</span>
<span class="n">cmake</span> <span class="o">-</span><span class="n">DLLVM_DIR</span><span class="o">=/</span><span class="n">srv</span><span class="o">/</span><span class="n">git</span><span class="o">/</span><span class="n">llvm</span><span class="o">.</span><span class="n">git</span><span class="o">/</span><span class="n">build</span> <span class="o">..</span>
<span class="n">make</span>
</pre></div>
</div>
<p>Examples that require clang will only be built if clang is built as part of llvm.</p>
<p><strong>Assembling to code object with llvm-mc from command line</strong></p>
<p>The following llvm-mc command line produces ELF object asm.o from assembly source asm.s:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">llvm</span><span class="o">-</span><span class="n">mc</span> <span class="o">-</span><span class="n">arch</span><span class="o">=</span><span class="n">amdgcn</span> <span class="o">-</span><span class="n">mcpu</span><span class="o">=</span><span class="n">fiji</span> <span class="o">-</span><span class="n">filetype</span><span class="o">=</span><span class="n">obj</span> <span class="o">-</span><span class="n">o</span> <span class="n">asm</span><span class="o">.</span><span class="n">o</span> <span class="n">asm</span><span class="o">.</span><span class="n">s</span>
</pre></div>
</div>
<p><strong>Assembling to raw instruction stream with llvm-mc from command line</strong></p>
<p>It is possible to extract contents of .text section after assembling to code object:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">llvm</span><span class="o">-</span><span class="n">mc</span> <span class="o">-</span><span class="n">arch</span><span class="o">=</span><span class="n">amdgcn</span> <span class="o">-</span><span class="n">mcpu</span><span class="o">=</span><span class="n">fiji</span> <span class="o">-</span><span class="n">filetype</span><span class="o">=</span><span class="n">obj</span> <span class="o">-</span><span class="n">o</span> <span class="n">asm</span><span class="o">.</span><span class="n">o</span> <span class="n">asm</span><span class="o">.</span><span class="n">s</span>
<span class="n">objdump</span> <span class="o">-</span><span class="n">h</span> <span class="n">asm</span><span class="o">.</span><span class="n">o</span> <span class="o">|</span> <span class="n">grep</span> <span class="o">.</span><span class="n">text</span> <span class="o">|</span> <span class="n">awk</span> <span class="s1">&#39;{print &quot;dd if=&#39;</span><span class="n">asm</span><span class="o">.</span><span class="n">o</span><span class="s1">&#39; of=&#39;</span><span class="n">asm</span><span class="s1">&#39; bs=1 count=$[0x&quot; $3 &quot;] skip=$[0x&quot; $6 &quot;]&quot;}&#39;</span> <span class="o">|</span> <span class="n">bash</span>
</pre></div>
</div>
<p><strong>Disassembling code object from command line</strong></p>
<p>The following command line may be used to dump contents of code object:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">llvm</span><span class="o">-</span><span class="n">objdump</span> <span class="o">-</span><span class="n">disassemble</span> <span class="o">-</span><span class="n">mcpu</span><span class="o">=</span><span class="n">fiji</span> <span class="n">asm</span><span class="o">.</span><span class="n">o</span>
</pre></div>
</div>
<p>This includes text disassembly of .text section.</p>
<p><strong>Disassembling raw instruction stream from command line</strong></p>
<p>The following command line may be used to disassemble raw instruction stream (without ELF structure):</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hexdump</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">e</span> <span class="s1">&#39;/1 &quot;0x</span><span class="si">%02X</span><span class="s1"> &quot;&#39;</span> <span class="n">asm</span> <span class="o">|</span> <span class="n">llvm</span><span class="o">-</span><span class="n">mc</span> <span class="o">-</span><span class="n">arch</span><span class="o">=</span><span class="n">amdgcn</span> <span class="o">-</span><span class="n">mcpu</span><span class="o">=</span><span class="n">fiji</span> <span class="o">-</span><span class="n">disassemble</span>
</pre></div>
</div>
<p>Here, hexdump is used to display contents of file in hexadecimal (0x.. form) which is then consumed by llvm-mc.</p>
<p>Refer to examples/api/assemble.</p>
<p>Refer to examples/api/disassemble.</p>
<p><strong>Using amdphdrs</strong></p>
<p>Note that normally standard lld and Code Object version 2 should be used which is closer to standard ELF format.</p>
<p>amdphdrs (now obsolete) is complimentary utility that can be used to produce AMDGPU Code Object version 1.
For example, given assembly source in asm.s, the following will assemble it and link using amdphdrs:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">llvm</span><span class="o">-</span><span class="n">mc</span> <span class="o">-</span><span class="n">arch</span><span class="o">=</span><span class="n">amdgcn</span> <span class="o">-</span><span class="n">mcpu</span><span class="o">=</span><span class="n">fiji</span> <span class="o">-</span><span class="n">filetype</span><span class="o">=</span><span class="n">obj</span> <span class="o">-</span><span class="n">o</span> <span class="n">asm</span><span class="o">.</span><span class="n">o</span> <span class="n">asm</span><span class="o">.</span><span class="n">s</span>
<span class="n">andphdrs</span> <span class="n">asm</span><span class="o">.</span><span class="n">o</span> <span class="n">asm</span><span class="o">.</span><span class="n">co</span>
</pre></div>
</div>
<p><strong>Macro support</strong></p>
<p>SP3 supports proprietary set of macros/tools. sp3_to_mc.pl script attempts to translate them into GAS syntax understood by llvm-mc.
flat_atomic_cmpswap instruction has 32-bit destination</p>
<p>LLVM AMDGPU:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">flat_atomic_cmpswap</span> <span class="n">v7</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
<p>SP3:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">flat_atomic_cmpswap</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">:</span><span class="mi">8</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">9</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">7</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
<p>Atomic instructions that return value should have glc flag explicitly</p>
<p>LLVM AMDGPU:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">flat_atomic_swap_x2</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="n">glc</span>
</pre></div>
</div>
<p>SP3:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">flat_atomic_swap_x2</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="http://llvm.org/docs/AMDGPUUsage.html">LLVM Use Guide for AMDGPU Back-End</a></li>
<li><dl class="first docutils">
<dt>AMD ISA Documents</dt>
<dd><ul class="first last">
<li><a class="reference external" href="http://developer.amd.com/wordpress/media/2013/12/AMD_GCN3_Instruction_Set_Architecture_rev1.1.pdf">AMD GCN3 Instruction Set Architecture (2016)</a></li>
<li><a class="reference external" href="https://developer.amd.com/wordpress/media/2012/12/AMD_Southern_Islands_Instruction_Set_Architecture.pdf">AMD_Southern_Islands_Instruction_Set_Architecture</a></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="roc-profiler">
<h2>ROC Profiler<a class="headerlink" href="#roc-profiler" title="Permalink to this headline">¶</a></h2>
<p>HW specific low-level performance analysis API, ‘rocprofiler’ library and ‘rocprof’ tool for profiling of GPU compute applications. The profiling includes HW performance counters with complex performance metrics and HW traces.
Supports GFX8/GFX9.</p>
<dl class="docutils">
<dt>Profiling tool ‘rocprof’:</dt>
<dd><ul class="first last simple">
<li>Cmd-line tool for dumping public per kernel perf-counters/metrics and kernel timestamps</li>
<li>Input file with counters list and kernels selecting parameters</li>
<li>Multiple counters groups and app runs supported</li>
<li>Kernel execution is serialized</li>
<li>Output results in CSV format</li>
</ul>
</dd>
</dl>
<div class="section" id="download">
<h3>Download<a class="headerlink" href="#download" title="Permalink to this headline">¶</a></h3>
<p>To clone ROC Profiler from GitHub use the folowing command:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">ROCmSoftwarePlatform</span><span class="o">/</span><span class="n">rocprofiler</span>
</pre></div>
</div>
<p>The library source tree:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="first docutils">
<dt>bin</dt>
<dd><ul class="first last">
<li>rpl_run.sh - Profiling tool run script</li>
</ul>
</dd>
</dl>
</li>
<li>doc - Documentation</li>
<li>inc/rocprofiler.h - Library public API</li>
<li><dl class="first docutils">
<dt>src - Library sources</dt>
<dd><ul class="first last">
<li>core - Library API sources</li>
<li>util - Library utils sources</li>
<li>xml - XML parser</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>test - Library test suite</dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt>tool - Profiling tool</dt>
<dd><ul class="first last">
<li>tool.cpp - tool sources</li>
<li>metrics.xml - metrics config file</li>
</ul>
</dd>
</dl>
</li>
<li>ctrl - Test controll</li>
<li>util - Test utils</li>
<li>simple_convolution - Simple convolution test kernel</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="build">
<h3>Build<a class="headerlink" href="#build" title="Permalink to this headline">¶</a></h3>
<p>Build environment:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">CMAKE_PREFIX_PATH</span><span class="o">=&lt;</span><span class="n">path</span> <span class="n">to</span> <span class="n">hsa</span><span class="o">-</span><span class="n">runtime</span> <span class="n">includes</span><span class="o">&gt;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">path</span> <span class="n">to</span> <span class="n">hsa</span><span class="o">-</span><span class="n">runtime</span> <span class="n">library</span><span class="o">&gt;</span>
<span class="n">export</span> <span class="n">CMAKE_BUILD_TYPE</span><span class="o">=&lt;</span><span class="n">debug</span><span class="o">|</span><span class="n">release</span><span class="o">&gt;</span> <span class="c1"># release by default</span>
<span class="n">export</span> <span class="n">CMAKE_DEBUG_TRACE</span><span class="o">=</span><span class="mi">1</span> <span class="c1"># to enable debug tracing</span>
</pre></div>
</div>
<p>To configure, build, install to /opt/rocm/rocprofiler:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="n">build</span>
<span class="n">cd</span> <span class="n">build</span>
<span class="n">export</span> <span class="n">CMAKE_PREFIX_PATH</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">rocm</span><span class="o">/</span><span class="n">lib</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">rocm</span><span class="o">/</span><span class="n">include</span><span class="o">/</span><span class="n">hsa</span>
<span class="n">cmake</span> <span class="o">-</span><span class="n">DCMAKE_INSTALL_PREFIX</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">rocm</span> <span class="o">..</span>
<span class="n">make</span>
<span class="n">sudo</span> <span class="n">make</span> <span class="n">install</span>
</pre></div>
</div>
<p>To test the built library:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">build</span>
<span class="o">./</span><span class="n">run</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</div>
<div class="section" id="profiling-tool-rocprof-usage">
<h3>Profiling Tool ‘rocprof’ Usage<a class="headerlink" href="#profiling-tool-rocprof-usage" title="Permalink to this headline">¶</a></h3>
<p>The following shows the command-line usage of the ‘rocprof’ tool:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rpl_run</span><span class="o">.</span><span class="n">sh</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="nb">list</span><span class="o">-</span><span class="n">basic</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="nb">list</span><span class="o">-</span><span class="n">derived</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="nb">input</span> <span class="o">.</span><span class="n">txt</span><span class="o">/.</span><span class="n">xml</span> <span class="n">file</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">o</span> <span class="o">&lt;</span><span class="n">output</span> <span class="n">CSV</span> <span class="n">file</span><span class="o">&gt;</span><span class="p">]</span> <span class="o">&lt;</span><span class="n">app</span> <span class="n">command</span> <span class="n">line</span><span class="o">&gt;</span>

<span class="n">Options</span><span class="p">:</span>
<span class="o">-</span><span class="n">h</span> <span class="o">-</span> <span class="n">this</span> <span class="n">help</span>
<span class="o">--</span><span class="n">verbose</span> <span class="o">-</span> <span class="n">verbose</span> <span class="n">mode</span><span class="p">,</span> <span class="n">dumping</span> <span class="nb">all</span> <span class="n">base</span> <span class="n">counters</span> <span class="n">used</span> <span class="ow">in</span> <span class="n">the</span> <span class="nb">input</span> <span class="n">metrics</span>
<span class="o">--</span><span class="nb">list</span><span class="o">-</span><span class="n">basic</span> <span class="o">-</span> <span class="n">to</span> <span class="nb">print</span> <span class="n">the</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">basic</span> <span class="n">HW</span> <span class="n">counters</span>
<span class="o">--</span><span class="nb">list</span><span class="o">-</span><span class="n">derived</span> <span class="o">-</span> <span class="n">to</span> <span class="nb">print</span> <span class="n">the</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">derived</span> <span class="n">metrics</span> <span class="k">with</span> <span class="n">formulas</span>

<span class="o">-</span><span class="n">i</span> <span class="o">&lt;.</span><span class="n">txt</span><span class="o">|.</span><span class="n">xml</span> <span class="n">file</span><span class="o">&gt;</span> <span class="o">-</span> <span class="nb">input</span> <span class="n">file</span>
    <span class="n">Input</span> <span class="n">file</span> <span class="o">.</span><span class="n">txt</span> <span class="nb">format</span><span class="p">,</span> <span class="n">automatically</span> <span class="n">rerun</span> <span class="n">application</span> <span class="k">for</span> <span class="n">every</span> <span class="n">pmc</span><span class="o">/</span><span class="n">sqtt</span> <span class="n">line</span><span class="p">:</span>

      <span class="c1"># Perf counters group 1</span>
      <span class="n">pmc</span> <span class="p">:</span> <span class="n">Wavefronts</span> <span class="n">VALUInsts</span> <span class="n">SALUInsts</span> <span class="n">SFetchInsts</span> <span class="n">FlatVMemInsts</span> <span class="n">LDSInsts</span> <span class="n">FlatLDSInsts</span> <span class="n">GDSInsts</span> <span class="n">VALUUtilization</span> <span class="n">FetchSize</span>
      <span class="c1"># Perf counters group 2</span>
      <span class="n">pmc</span> <span class="p">:</span> <span class="n">WriteSize</span> <span class="n">L2CacheHit</span>
      <span class="c1"># Filter by dispatches range, GPU index and kernel names</span>
      <span class="c1"># supported range formats: &quot;3:9&quot;, &quot;3:&quot;, &quot;3&quot;</span>
      <span class="nb">range</span><span class="p">:</span> <span class="mi">1</span> <span class="p">:</span> <span class="mi">4</span>
      <span class="n">gpu</span><span class="p">:</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span>
      <span class="n">kernel</span><span class="p">:</span> <span class="n">simple</span> <span class="n">Pass1</span> <span class="n">simpleConvolutionPass2</span>

    <span class="n">Input</span> <span class="n">file</span> <span class="o">.</span><span class="n">xml</span> <span class="nb">format</span><span class="p">,</span> <span class="k">for</span> <span class="n">single</span> <span class="n">profiling</span> <span class="n">run</span><span class="p">:</span>

      <span class="c1"># Metrics list definition, also the form &quot;&lt;block-name&gt;:&lt;event-id&gt;&quot; can be used</span>
      <span class="c1"># All defined metrics can be found in the &#39;metrics.xml&#39;</span>
      <span class="c1"># There are basic metrics for raw HW counters and high-level metrics for derived counters</span>
      <span class="o">&lt;</span><span class="n">metric</span> <span class="n">name</span><span class="o">=</span><span class="n">SQ</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="n">SQ_WAVES</span><span class="p">,</span><span class="n">VFetchInsts</span>
      <span class="o">&gt;&lt;/</span><span class="n">metric</span><span class="o">&gt;</span>

      <span class="c1"># Filter by dispatches range, GPU index and kernel names</span>
      <span class="o">&lt;</span><span class="n">metric</span>
        <span class="c1"># range formats: &quot;3:9&quot;, &quot;3:&quot;, &quot;3&quot;</span>
        <span class="nb">range</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
        <span class="c1"># list of gpu indexes &quot;0,1,2,3&quot;</span>
        <span class="n">gpu_index</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
        <span class="c1"># list of matched sub-strings &quot;Simple1,Conv1,SimpleConvolution&quot;</span>
        <span class="n">kernel</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
      <span class="o">&gt;&lt;/</span><span class="n">metric</span><span class="o">&gt;</span>

<span class="o">-</span><span class="n">o</span> <span class="o">&lt;</span><span class="n">output</span> <span class="n">file</span><span class="o">&gt;</span> <span class="o">-</span> <span class="n">output</span> <span class="n">CSV</span> <span class="n">file</span> <span class="p">[</span><span class="o">&lt;</span><span class="nb">input</span> <span class="n">file</span> <span class="n">base</span><span class="o">&gt;.</span><span class="n">csv</span><span class="p">]</span>
<span class="o">-</span><span class="n">d</span> <span class="o">&lt;</span><span class="n">data</span> <span class="n">directory</span><span class="o">&gt;</span> <span class="o">-</span> <span class="n">directory</span> <span class="n">where</span> <span class="n">profiler</span> <span class="n">store</span> <span class="n">profiling</span> <span class="n">data</span> <span class="n">including</span> <span class="n">thread</span> <span class="n">treaces</span> <span class="p">[</span><span class="o">/</span><span class="n">tmp</span><span class="p">]</span>
    <span class="n">The</span> <span class="n">data</span> <span class="n">directory</span> <span class="ow">is</span> <span class="n">renoving</span> <span class="n">autonatically</span> <span class="k">if</span> <span class="n">the</span> <span class="n">directory</span> <span class="ow">is</span> <span class="n">matching</span> <span class="n">the</span> <span class="n">temporary</span> <span class="n">one</span><span class="p">,</span> <span class="n">which</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">default</span><span class="o">.</span>
<span class="o">-</span><span class="n">t</span> <span class="o">&lt;</span><span class="n">temporary</span> <span class="n">directory</span><span class="o">&gt;</span> <span class="o">-</span> <span class="n">to</span> <span class="n">change</span> <span class="n">the</span> <span class="n">temporary</span> <span class="n">directory</span> <span class="p">[</span><span class="o">/</span><span class="n">tmp</span><span class="p">]</span>
    <span class="n">By</span> <span class="n">changing</span> <span class="n">the</span> <span class="n">temporary</span> <span class="n">directory</span> <span class="n">you</span> <span class="n">can</span> <span class="n">prevent</span> <span class="n">removing</span> <span class="n">the</span> <span class="n">profiling</span> <span class="n">data</span> <span class="kn">from</span> <span class="o">/</span><span class="n">tmp</span> <span class="ow">or</span> <span class="n">enable</span> <span class="n">removing</span> <span class="kn">from</span> <span class="nn">not</span> <span class="s1">&#39;/tmp&#39;</span> <span class="n">directory</span><span class="o">.</span>

<span class="o">--</span><span class="n">basenames</span> <span class="o">&lt;</span><span class="n">on</span><span class="o">|</span><span class="n">off</span><span class="o">&gt;</span> <span class="o">-</span> <span class="n">to</span> <span class="n">turn</span> <span class="n">on</span><span class="o">/</span><span class="n">off</span> <span class="n">truncating</span> <span class="n">of</span> <span class="n">the</span> <span class="n">kernel</span> <span class="n">full</span> <span class="n">function</span> <span class="n">names</span> <span class="n">till</span> <span class="n">the</span> <span class="n">base</span> <span class="n">ones</span> <span class="p">[</span><span class="n">off</span><span class="p">]</span>
<span class="o">--</span><span class="n">timestamp</span> <span class="o">&lt;</span><span class="n">on</span><span class="o">|</span><span class="n">off</span><span class="o">&gt;</span> <span class="o">-</span> <span class="n">to</span> <span class="n">turn</span> <span class="n">on</span><span class="o">/</span><span class="n">off</span> <span class="n">the</span> <span class="n">kernel</span> <span class="n">disoatches</span> <span class="n">timestamps</span><span class="p">,</span> <span class="n">dispatch</span><span class="o">/</span><span class="n">begin</span><span class="o">/</span><span class="n">end</span><span class="o">/</span><span class="n">complete</span> <span class="p">[</span><span class="n">off</span><span class="p">]</span>
<span class="o">--</span><span class="n">ctx</span><span class="o">-</span><span class="n">limit</span> <span class="o">&lt;</span><span class="nb">max</span> <span class="n">number</span><span class="o">&gt;</span> <span class="o">-</span> <span class="n">maximum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">outstanding</span> <span class="n">contexts</span> <span class="p">[</span><span class="mi">0</span> <span class="o">-</span> <span class="n">unlimited</span><span class="p">]</span>
<span class="o">--</span><span class="n">heartbeat</span> <span class="o">&lt;</span><span class="n">rate</span> <span class="n">sec</span><span class="o">&gt;</span> <span class="o">-</span> <span class="n">to</span> <span class="nb">print</span> <span class="n">progress</span> <span class="n">heartbeats</span> <span class="p">[</span><span class="mi">0</span> <span class="o">-</span> <span class="n">disabled</span><span class="p">]</span>
<span class="o">--</span><span class="n">sqtt</span><span class="o">-</span><span class="n">size</span> <span class="o">&lt;</span><span class="n">byte</span> <span class="n">size</span><span class="o">&gt;</span> <span class="o">-</span> <span class="n">to</span> <span class="nb">set</span> <span class="n">SQTT</span> <span class="n">buffer</span> <span class="n">size</span><span class="p">,</span> <span class="n">aggregate</span> <span class="k">for</span> <span class="nb">all</span> <span class="n">SE</span> <span class="p">[</span><span class="mh">0x2000000</span><span class="p">]</span>
    <span class="n">Can</span> <span class="n">be</span> <span class="nb">set</span> <span class="ow">in</span> <span class="n">KB</span> <span class="p">(</span><span class="mi">1024</span><span class="n">B</span><span class="p">)</span> <span class="ow">or</span> <span class="n">MB</span> <span class="p">(</span><span class="mi">1048576</span><span class="p">)</span> <span class="n">units</span><span class="p">,</span> <span class="n">examples</span> <span class="mi">20</span><span class="n">K</span> <span class="ow">or</span> <span class="mi">20</span><span class="n">M</span> <span class="n">respectively</span><span class="o">.</span>
<span class="o">--</span><span class="n">sqtt</span><span class="o">-</span><span class="n">local</span> <span class="o">&lt;</span><span class="n">on</span><span class="o">|</span><span class="n">off</span><span class="o">&gt;</span> <span class="o">-</span> <span class="n">to</span> <span class="n">allocate</span> <span class="n">SQTT</span> <span class="n">buffer</span> <span class="ow">in</span> <span class="n">local</span> <span class="n">GPU</span> <span class="n">memory</span> <span class="p">[</span><span class="n">on</span><span class="p">]</span>

<span class="n">Configuration</span> <span class="n">file</span><span class="p">:</span>
<span class="n">You</span> <span class="n">can</span> <span class="nb">set</span> <span class="n">your</span> <span class="n">parameters</span> <span class="n">defaults</span> <span class="n">preferences</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">configuration</span> <span class="n">file</span> <span class="s1">&#39;rpl_rc.xml&#39;</span><span class="o">.</span> <span class="n">The</span> <span class="n">search</span> <span class="n">path</span> <span class="n">sequence</span><span class="p">:</span> <span class="o">.</span><span class="p">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">evgeny</span><span class="p">:</span><span class="o">&lt;</span><span class="n">package</span> <span class="n">path</span><span class="o">&gt;</span>
<span class="n">First</span> <span class="n">the</span> <span class="n">configuration</span> <span class="n">file</span> <span class="ow">is</span> <span class="n">looking</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">current</span> <span class="n">directory</span><span class="p">,</span> <span class="n">then</span> <span class="ow">in</span> <span class="n">your</span> <span class="n">home</span><span class="p">,</span> <span class="ow">and</span> <span class="n">then</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">package</span> <span class="n">directory</span><span class="o">.</span>
<span class="n">Configurable</span> <span class="n">options</span><span class="p">:</span> <span class="s1">&#39;basenames&#39;</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">,</span> <span class="s1">&#39;ctx-limit&#39;</span><span class="p">,</span> <span class="s1">&#39;heartbeat&#39;</span><span class="p">,</span> <span class="s1">&#39;sqtt-size&#39;</span><span class="p">,</span> <span class="s1">&#39;sqtt-local&#39;</span><span class="o">.</span>
<span class="n">An</span> <span class="n">example</span> <span class="n">of</span> <span class="s1">&#39;rpl_rc.xml&#39;</span><span class="p">:</span>
  <span class="o">&lt;</span><span class="n">defaults</span>
    <span class="n">basenames</span><span class="o">=</span><span class="n">off</span>
    <span class="n">timestamp</span><span class="o">=</span><span class="n">off</span>
    <span class="n">ctx</span><span class="o">-</span><span class="n">limit</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">heartbeat</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">sqtt</span><span class="o">-</span><span class="n">size</span><span class="o">=</span><span class="mh">0x20</span><span class="n">M</span>
    <span class="n">sqtt</span><span class="o">-</span><span class="n">local</span><span class="o">=</span><span class="n">on</span>
  <span class="o">&gt;&lt;/</span><span class="n">defaults</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="rocr-debug-agent">
<h2>ROCr Debug Agent<a class="headerlink" href="#rocr-debug-agent" title="Permalink to this headline">¶</a></h2>
<p>The ROCr Debug Agent is a library that can be loaded by ROCm Platform
Runtime to provide the following functionality:</p>
<ul class="simple">
<li>Print the state of wavefronts that report memory violation or upon
executing a <code class="docutils literal notranslate"><span class="pre">s_trap</span> <span class="pre">2</span></code> instruction.</li>
<li>Allows SIGINT (<code class="docutils literal notranslate"><span class="pre">ctrl</span> <span class="pre">c</span></code>) or SIGTERM (<code class="docutils literal notranslate"><span class="pre">kill</span> <span class="pre">-15</span></code>) to print
wavefront state of aborted GPU dispatches.</li>
<li>It is enabled on Vega10 GPUs on ROCm2.0.</li>
</ul>
<p>To use the ROCr Debug Agent set the following environment variable:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">HSA_TOOLS_LIB</span><span class="o">=</span><span class="n">librocr_debug_agent64</span><span class="o">.</span><span class="n">so</span>
</pre></div>
</div>
<p>This will use the ROCr Debug Agent library installed at
/opt/rocm/lib/librocr_debug_agent64.so by default since the ROCm
installation adds /opt/rocm/lib to the system library path. To use a
different version set the LD_LIBRARY_PATH, for example:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">LD_LIBRARY_PATH</span><span class="o">=/</span><span class="n">path_to_directory_containing_librocr_debug_agent64</span><span class="o">.</span><span class="n">so</span>
</pre></div>
</div>
<p>To display the machine code instructions of wavefronts, together with
the source text location, the ROCr Debug Agent uses the llvm-objdump
tool. Ensure that a version that supports AMD GCN GPUs is on your
<code class="docutils literal notranslate"><span class="pre">$PATH</span></code>. For example, for ROCm 2.0:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span>export PATH=/opt/rocm/opencl/bin/x86_64/:$PATH
</pre></div>
</div>
<p>Execute your application.</p>
<p>If the application encounters a GPU error it will display the wavefront
state of the GPU to <code class="docutils literal notranslate"><span class="pre">stdout</span></code>. Possible error states include:</p>
<ul class="simple">
<li>The GPU executes a memory instruction that causes a memory violation.
This is reported as an XNACK error state.</li>
<li>Queue error.</li>
<li>The GPU executes an <code class="docutils literal notranslate"><span class="pre">S_TRAP</span></code> instruction. The <code class="docutils literal notranslate"><span class="pre">__builtin_trap()</span></code>
language builtin can be used to generate a <code class="docutils literal notranslate"><span class="pre">S_TRAP</span></code>.</li>
<li>A SIGINT (<code class="docutils literal notranslate"><span class="pre">ctrl</span> <span class="pre">c</span></code>) or SIGTERM (<code class="docutils literal notranslate"><span class="pre">kill</span> <span class="pre">-15</span></code>) signal is sent to the
application while executing GPU code. Enabled by the
<code class="docutils literal notranslate"><span class="pre">ROCM_DEBUG_ENABLE_LINUX_SIGNALS</span></code> environment variable.</li>
</ul>
<p>For example, a sample print out for GPU memory fault is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Memory</span> <span class="n">access</span> <span class="n">fault</span> <span class="n">by</span> <span class="n">GPU</span> <span class="n">agent</span><span class="p">:</span> <span class="n">AMD</span> <span class="n">gfx900</span>
<span class="n">Node</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">Address</span><span class="p">:</span> <span class="mh">0x18DB4</span><span class="n">xxx</span> <span class="p">(</span><span class="n">page</span> <span class="ow">not</span> <span class="n">present</span><span class="p">;</span><span class="n">write</span> <span class="n">access</span> <span class="n">to</span> <span class="n">a</span> <span class="n">read</span><span class="o">-</span><span class="n">only</span> <span class="n">page</span><span class="p">;)</span>

<span class="mi">64</span> <span class="n">wavefront</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="n">found</span> <span class="ow">in</span> <span class="n">XNACK</span> <span class="n">error</span> <span class="n">state</span> <span class="nd">@PC</span><span class="p">:</span> <span class="mh">0x0000001100E01310</span>
<span class="n">printing</span> <span class="n">the</span> <span class="n">first</span> <span class="n">one</span><span class="p">:</span>

   <span class="n">EXEC</span><span class="p">:</span> <span class="mh">0xFFFFFFFFFFFFFFFF</span>
 <span class="n">STATUS</span><span class="p">:</span> <span class="mh">0x00412460</span>
<span class="n">TRAPSTS</span><span class="p">:</span> <span class="mh">0x30000000</span>
     <span class="n">M0</span><span class="p">:</span> <span class="mh">0x00001010</span>

     <span class="n">s0</span><span class="p">:</span> <span class="mh">0x00C00000</span>    <span class="n">s1</span><span class="p">:</span> <span class="mh">0x80000010</span>    <span class="n">s2</span><span class="p">:</span> <span class="mh">0x10000000</span>    <span class="n">s3</span><span class="p">:</span> <span class="mh">0x00EA4FAC</span>
     <span class="n">s4</span><span class="p">:</span> <span class="mh">0x17D78400</span>    <span class="n">s5</span><span class="p">:</span> <span class="mh">0x00000000</span>    <span class="n">s6</span><span class="p">:</span> <span class="mh">0x01039000</span>    <span class="n">s7</span><span class="p">:</span> <span class="mh">0x00000000</span>
     <span class="n">s8</span><span class="p">:</span> <span class="mh">0x00000000</span>    <span class="n">s9</span><span class="p">:</span> <span class="mh">0x00000000</span>   <span class="n">s10</span><span class="p">:</span> <span class="mh">0x17D78400</span>   <span class="n">s11</span><span class="p">:</span> <span class="mh">0x04000000</span>
    <span class="n">s12</span><span class="p">:</span> <span class="mh">0x00000000</span>   <span class="n">s13</span><span class="p">:</span> <span class="mh">0x00000000</span>   <span class="n">s14</span><span class="p">:</span> <span class="mh">0x00000000</span>   <span class="n">s15</span><span class="p">:</span> <span class="mh">0x00000000</span>
    <span class="n">s16</span><span class="p">:</span> <span class="mh">0x0103C000</span>   <span class="n">s17</span><span class="p">:</span> <span class="mh">0x00000000</span>   <span class="n">s18</span><span class="p">:</span> <span class="mh">0x00000000</span>   <span class="n">s19</span><span class="p">:</span> <span class="mh">0x00000000</span>
    <span class="n">s20</span><span class="p">:</span> <span class="mh">0x01037060</span>   <span class="n">s21</span><span class="p">:</span> <span class="mh">0x00000000</span>   <span class="n">s22</span><span class="p">:</span> <span class="mh">0x00000000</span>   <span class="n">s23</span><span class="p">:</span> <span class="mh">0x00000011</span>
    <span class="n">s24</span><span class="p">:</span> <span class="mh">0x00004000</span>   <span class="n">s25</span><span class="p">:</span> <span class="mh">0x00010000</span>   <span class="n">s26</span><span class="p">:</span> <span class="mh">0x04C00000</span>   <span class="n">s27</span><span class="p">:</span> <span class="mh">0x00000010</span>
    <span class="n">s28</span><span class="p">:</span> <span class="mh">0xFFFFFFFF</span>   <span class="n">s29</span><span class="p">:</span> <span class="mh">0xFFFFFFFF</span>   <span class="n">s30</span><span class="p">:</span> <span class="mh">0x00000000</span>   <span class="n">s31</span><span class="p">:</span> <span class="mh">0x00000000</span>

<span class="n">Lane</span> <span class="mh">0x0</span>
     <span class="n">v0</span><span class="p">:</span> <span class="mh">0x00000003</span>    <span class="n">v1</span><span class="p">:</span> <span class="mh">0x18DB4400</span>    <span class="n">v2</span><span class="p">:</span> <span class="mh">0x18DB4400</span>    <span class="n">v3</span><span class="p">:</span> <span class="mh">0x00000000</span>
     <span class="n">v4</span><span class="p">:</span> <span class="mh">0x00000000</span>    <span class="n">v5</span><span class="p">:</span> <span class="mh">0x00000000</span>    <span class="n">v6</span><span class="p">:</span> <span class="mh">0x00700000</span>    <span class="n">v7</span><span class="p">:</span> <span class="mh">0x00800000</span>
<span class="n">Lane</span> <span class="mh">0x1</span>
     <span class="n">v0</span><span class="p">:</span> <span class="mh">0x00000004</span>    <span class="n">v1</span><span class="p">:</span> <span class="mh">0x18DB4400</span>    <span class="n">v2</span><span class="p">:</span> <span class="mh">0x18DB4400</span>    <span class="n">v3</span><span class="p">:</span> <span class="mh">0x00000000</span>
     <span class="n">v4</span><span class="p">:</span> <span class="mh">0x00000000</span>    <span class="n">v5</span><span class="p">:</span> <span class="mh">0x00000000</span>    <span class="n">v6</span><span class="p">:</span> <span class="mh">0x00700000</span>    <span class="n">v7</span><span class="p">:</span> <span class="mh">0x00800000</span>
<span class="n">Lane</span> <span class="mh">0x2</span>
     <span class="n">v0</span><span class="p">:</span> <span class="mh">0x00000005</span>    <span class="n">v1</span><span class="p">:</span> <span class="mh">0x18DB4400</span>    <span class="n">v2</span><span class="p">:</span> <span class="mh">0x18DB4400</span>    <span class="n">v3</span><span class="p">:</span> <span class="mh">0x00000000</span>
     <span class="n">v4</span><span class="p">:</span> <span class="mh">0x00000000</span>    <span class="n">v5</span><span class="p">:</span> <span class="mh">0x00000000</span>    <span class="n">v6</span><span class="p">:</span> <span class="mh">0x00700000</span>    <span class="n">v7</span><span class="p">:</span> <span class="mh">0x00800000</span>
<span class="n">Lane</span> <span class="mh">0x3</span>
     <span class="n">v0</span><span class="p">:</span> <span class="mh">0x00000006</span>    <span class="n">v1</span><span class="p">:</span> <span class="mh">0x18DB4400</span>    <span class="n">v2</span><span class="p">:</span> <span class="mh">0x18DB4400</span>    <span class="n">v3</span><span class="p">:</span> <span class="mh">0x00000000</span>
     <span class="n">v4</span><span class="p">:</span> <span class="mh">0x00000000</span>    <span class="n">v5</span><span class="p">:</span> <span class="mh">0x00000000</span>    <span class="n">v6</span><span class="p">:</span> <span class="mh">0x00700000</span>    <span class="n">v7</span><span class="p">:</span> <span class="mh">0x00800000</span>

    <span class="o">.</span>
    <span class="o">.</span>
    <span class="o">.</span>

<span class="n">Lane</span> <span class="mh">0x3C</span>
     <span class="n">v0</span><span class="p">:</span> <span class="mh">0x0000001F</span>    <span class="n">v1</span><span class="p">:</span> <span class="mh">0x18DB4400</span>    <span class="n">v2</span><span class="p">:</span> <span class="mh">0x18DB4400</span>    <span class="n">v3</span><span class="p">:</span> <span class="mh">0x00000000</span>
     <span class="n">v4</span><span class="p">:</span> <span class="mh">0x00000000</span>    <span class="n">v5</span><span class="p">:</span> <span class="mh">0x00000000</span>    <span class="n">v6</span><span class="p">:</span> <span class="mh">0x00700000</span>    <span class="n">v7</span><span class="p">:</span> <span class="mh">0x00800000</span>
<span class="n">Lane</span> <span class="mh">0x3D</span>
     <span class="n">v0</span><span class="p">:</span> <span class="mh">0x00000020</span>    <span class="n">v1</span><span class="p">:</span> <span class="mh">0x18DB4400</span>    <span class="n">v2</span><span class="p">:</span> <span class="mh">0x18DB4400</span>    <span class="n">v3</span><span class="p">:</span> <span class="mh">0x00000000</span>
     <span class="n">v4</span><span class="p">:</span> <span class="mh">0x00000000</span>    <span class="n">v5</span><span class="p">:</span> <span class="mh">0x00000000</span>    <span class="n">v6</span><span class="p">:</span> <span class="mh">0x00700000</span>    <span class="n">v7</span><span class="p">:</span> <span class="mh">0x00800000</span>
<span class="n">Lane</span> <span class="mh">0x3E</span>
     <span class="n">v0</span><span class="p">:</span> <span class="mh">0x00000021</span>    <span class="n">v1</span><span class="p">:</span> <span class="mh">0x18DB4400</span>    <span class="n">v2</span><span class="p">:</span> <span class="mh">0x18DB4400</span>    <span class="n">v3</span><span class="p">:</span> <span class="mh">0x00000000</span>
     <span class="n">v4</span><span class="p">:</span> <span class="mh">0x00000000</span>    <span class="n">v5</span><span class="p">:</span> <span class="mh">0x00000000</span>    <span class="n">v6</span><span class="p">:</span> <span class="mh">0x00700000</span>    <span class="n">v7</span><span class="p">:</span> <span class="mh">0x00800000</span>
<span class="n">Lane</span> <span class="mh">0x3F</span>
     <span class="n">v0</span><span class="p">:</span> <span class="mh">0x00000022</span>    <span class="n">v1</span><span class="p">:</span> <span class="mh">0x18DB4400</span>    <span class="n">v2</span><span class="p">:</span> <span class="mh">0x18DB4400</span>    <span class="n">v3</span><span class="p">:</span> <span class="mh">0x00000000</span>
     <span class="n">v4</span><span class="p">:</span> <span class="mh">0x00000000</span>    <span class="n">v5</span><span class="p">:</span> <span class="mh">0x00000000</span>    <span class="n">v6</span><span class="p">:</span> <span class="mh">0x00700000</span>    <span class="n">v7</span><span class="p">:</span> <span class="mh">0x00800000</span>

<span class="n">Faulty</span> <span class="n">Code</span> <span class="n">Object</span><span class="p">:</span>

<span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ROCm_Tmp_PID_5764</span><span class="o">/</span><span class="n">ROCm_Code_Object_0</span><span class="p">:</span>      <span class="n">file</span> <span class="nb">format</span> <span class="n">ELF64</span><span class="o">-</span><span class="n">amdgpu</span><span class="o">-</span><span class="n">hsacobj</span>

<span class="n">Disassembly</span> <span class="n">of</span> <span class="n">section</span> <span class="o">.</span><span class="n">text</span><span class="p">:</span>
<span class="n">the_kernel</span><span class="p">:</span>
<span class="p">;</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">qingchuan</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">faulty_test</span><span class="o">/</span><span class="n">vector_add_kernel</span><span class="o">.</span><span class="n">cl</span><span class="p">:</span><span class="mi">12</span>
<span class="p">;</span> <span class="n">d</span><span class="p">[</span><span class="mi">100000000</span><span class="p">]</span> <span class="o">=</span> <span class="n">ga</span><span class="p">[</span><span class="n">gid</span> <span class="o">&amp;</span> <span class="mi">31</span><span class="p">];</span>
        <span class="n">v_mov_b32_e32</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span>                                       <span class="o">//</span> <span class="mi">0000000012</span><span class="n">F0</span><span class="p">:</span> <span class="mf">7E020302</span>
        <span class="n">v_mov_b32_e32</span> <span class="n">v4</span><span class="p">,</span> <span class="n">v3</span>                                       <span class="o">//</span> <span class="mi">0000000012</span><span class="n">F4</span><span class="p">:</span> <span class="mf">7E080303</span>
        <span class="n">v_add_i32_e32</span> <span class="n">v1</span><span class="p">,</span> <span class="n">vcc</span><span class="p">,</span> <span class="n">s10</span><span class="p">,</span> <span class="n">v1</span>                             <span class="o">//</span> <span class="mi">0000000012</span><span class="n">F8</span><span class="p">:</span> <span class="mi">3202020</span><span class="n">A</span>
        <span class="n">v_mov_b32_e32</span> <span class="n">v5</span><span class="p">,</span> <span class="n">s22</span>                                      <span class="o">//</span> <span class="mi">0000000012</span><span class="n">FC</span><span class="p">:</span> <span class="mf">7E0</span><span class="n">A0216</span>
        <span class="n">v_addc_u32_e32</span> <span class="n">v4</span><span class="p">,</span> <span class="n">vcc</span><span class="p">,</span> <span class="n">v4</span><span class="p">,</span> <span class="n">v5</span><span class="p">,</span> <span class="n">vcc</span>                        <span class="o">//</span> <span class="mi">000000001300</span><span class="p">:</span> <span class="mi">38080</span><span class="n">B04</span>
        <span class="n">v_mov_b32_e32</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v1</span>                                       <span class="o">//</span> <span class="mi">000000001304</span><span class="p">:</span> <span class="mf">7E040301</span>
        <span class="n">v_mov_b32_e32</span> <span class="n">v3</span><span class="p">,</span> <span class="n">v4</span>                                       <span class="o">//</span> <span class="mi">000000001308</span><span class="p">:</span> <span class="mf">7E060304</span>
        <span class="n">s_waitcnt</span> <span class="n">lgkmcnt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>                                       <span class="o">//</span> <span class="mi">00000000130</span><span class="n">C</span><span class="p">:</span> <span class="n">BF8CC07F</span>
        <span class="n">flat_store_dword</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">v0</span>                                <span class="o">//</span> <span class="mi">000000001310</span><span class="p">:</span> <span class="n">DC700000</span> <span class="mi">00000002</span>
<span class="p">;</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">qingchuan</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">faulty_test</span><span class="o">/</span><span class="n">vector_add_kernel</span><span class="o">.</span><span class="n">cl</span><span class="p">:</span><span class="mi">13</span>
<span class="p">;</span> <span class="p">}</span>
        <span class="n">s_endpgm</span>                                                   <span class="o">//</span> <span class="mi">000000001318</span><span class="p">:</span> <span class="n">BF810000</span>

<span class="n">Faulty</span> <span class="n">PC</span> <span class="n">offset</span><span class="p">:</span> <span class="mi">1310</span>

<span class="n">Aborted</span> <span class="p">(</span><span class="n">core</span> <span class="n">dumped</span><span class="p">)</span>
</pre></div>
</div>
<p>By default the wavefront dump is sent to <code class="docutils literal notranslate"><span class="pre">stdout</span></code>.</p>
<p>To save to a file use:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">ROCM_DEBUG_WAVE_STATE_DUMP</span><span class="o">=</span><span class="n">file</span>
</pre></div>
</div>
<p>This will create a file called <code class="docutils literal notranslate"><span class="pre">ROCm_Wave_State_Dump</span></code> in code object
directory (see below).</p>
<p>To return to the default <code class="docutils literal notranslate"><span class="pre">stdout</span></code> use either of the following:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">ROCM_DEBUG_WAVE_STATE_DUMP</span><span class="o">=</span><span class="n">stdout</span>
<span class="n">unset</span> <span class="n">ROCM_DEBUG_WAVE_STATE_DUMP</span>
</pre></div>
</div>
<p>The following environment variable can be used to enable dumping
wavefront states when SIGINT (<code class="docutils literal notranslate"><span class="pre">ctrl</span> <span class="pre">c</span></code>) or SIGTERM (<code class="docutils literal notranslate"><span class="pre">kill</span> <span class="pre">-15</span></code>) is
sent to the application:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">ROCM_DEBUG_ENABLE_LINUX_SIGNALS</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
<p>Either of the following will disable this behavior:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">ROCM_DEBUG_ENABLE_LINUX_SIGNALS</span><span class="o">=</span><span class="mi">0</span>
<span class="n">unset</span> <span class="n">ROCM_DEBUG_ENABLE_LINUX_SIGNALS</span>
</pre></div>
</div>
<p>When the ROCr Debug Agent is enabled, each GPU code object loaded by the
ROCm Platform Runtime will be saved in a file in the code object
directory. By default the code object directory is
<code class="docutils literal notranslate"><span class="pre">/tmp/ROCm_Tmp_PID_XXXX/</span></code> where <code class="docutils literal notranslate"><span class="pre">XXXX</span></code> is the application process
ID. The code object directory can be specified using the following
environent variable:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">ROCM_DEBUG_SAVE_CODE_OBJECT</span><span class="o">=</span><span class="n">code_object_directory</span>
</pre></div>
</div>
<p>This will use the path <code class="docutils literal notranslate"><span class="pre">/code_object_directory</span></code>.</p>
<p>Loaded code objects will be saved in files named <code class="docutils literal notranslate"><span class="pre">ROCm_Code_Object_N</span></code>
where N is a unique integer starting at 0 of the order in which the code
object was loaded.</p>
<p>If the default code object directory is used, then the saved code object
file will be deleted when it is unloaded with the ROCm Platform Runtime,
and the complete code object directory will be deleted when the
application exits normally. If a code object directory path is specified
then neither the saved code objects, nor the code object directory will
be deleted.</p>
<p>To return to using the default code object directory use:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">unset</span> <span class="n">ROCM_DEBUG_SAVE_CODE_OBJECT</span>
</pre></div>
</div>
<p>By default ROCr Debug Agent logging is disabled. It can be enabled to
display to <code class="docutils literal notranslate"><span class="pre">stdout</span></code> using:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">ROCM_DEBUG_ENABLE_AGENTLOG</span><span class="o">=</span><span class="n">stdout</span>
</pre></div>
</div>
<p>Or to a file using:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">ROCM_DEBUG_ENABLE_AGENTLOG</span><span class="o">=&lt;</span><span class="n">filename</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Which will write to the file <code class="docutils literal notranslate"><span class="pre">&lt;filename&gt;_AgentLog_PID_XXXX.log</span></code>.</p>
<p>To disable logging use:</p>
<div class="code sh highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">unset</span> <span class="n">ROCM_DEBUG_ENABLE_AGENTLOG</span>
</pre></div>
</div>
</div>
<div class="section" id="rocm-gdb">
<h2>ROCm-GDB<a class="headerlink" href="#rocm-gdb" title="Permalink to this headline">¶</a></h2>
<p>The ROCm-GDB is being revised to work with the ROCr Debug Agent to
support debugging GPU kernels on Radeon Open Compute platforms (ROCm)
and will be available in an upcoming release.</p>
</div>
<div class="section" id="rocm-profiler">
<h2>ROCm-Profiler<a class="headerlink" href="#rocm-profiler" title="Permalink to this headline">¶</a></h2>
<p>The Radeon Compute Profiler (RCP) is a performance analysis tool that gathers data from the API run-time and GPU for OpenCL™ and ROCm/HSA applications. This information can be used by developers to discover bottlenecks in the application and to find ways to optimize the application’s performance.</p>
<p>RCP was formerly delivered as part of CodeXL with the executable name “CodeXLGpuProfiler”. Prior to its inclusion in CodeXL, it was known as “sprofile” and was part of the AMD APP Profiler product.</p>
<p>A subset of RCP is (the portion that supports ROCm) is automatically installed with ROCm. Once ROCm is installed, the profiler will appear in the /opt/rocm/profiler directory.</p>
<blockquote>
<div><ul class="simple">
<li>Measure the execution time of an OpenCL™ or ROCm/HSA kernel.</li>
<li>Query the hardware performance counters on an AMD Radeon graphics card.</li>
<li>Use the CXLActivityLogger API to trace and measure the execution of segments in the program.</li>
<li>Display the IL/HSAIL and ISA (hardware disassembly) code of OpenCL™ kernels.</li>
<li>Calculate kernel occupancy information, which estimates the number of in-flight wavefronts on a compute unit as a percentage of the theoretical maximum number of wavefronts that the compute unit can support.</li>
<li>When used with CodeXL, all profiler data can be visualized in a user-friendly graphical user interface.</li>
</ul>
</div></blockquote>
<blockquote>
<div><ul class="simple">
<li><dl class="first docutils">
<dt>Version 5.5 (8/22/18)</dt>
<dd><ul class="first last">
<li>Adds support for additional GPUs, including Vega series GPUs</li>
<li>ROCm/HSA: Support for ROCm 2.0</li>
<li>Improves display of pointer parameters for some HSA APIs in the ATP file</li>
<li>Fixes an issue with parsing an ATP file which has non-ascii characters (affected Summary page generation and display within             CodeXL)</li>
<li>ROCm/HSA: Fixes several issues with incorrect or missing data transfer timestamps.</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<blockquote>
<div><ul class="simple">
<li>An AMD Radeon GCN-based GPU or APU</li>
<li><dl class="first docutils">
<dt>Radeon Software Adrenaline Edition 18.8.1 or later (Driver Packaging Version 18.30 or later).</dt>
<dd><ul class="first last">
<li>For Vega support, a driver with Driver Packaging Version 17.20 or later is required</li>
</ul>
</dd>
</dl>
</li>
<li>ROCm 2.0 See system requirements for ROCm: <a class="reference external" href="https://rocm-documentation.readthedocs.io/en/latest/Installation_Guide/Installation-Guide.html">https://rocm-documentation.readthedocs.io/en/latest/Installation_Guide/Installation-Guide.html</a> and <a class="reference external" href="https://rocm.github.io/hardware.html">https://rocm.github.io/hardware.html</a>.</li>
<li><dl class="first docutils">
<dt>Windows 7, 8.1, and 10</dt>
<dd><ul class="first last">
<li>For Windows, the Visual C++ Redistributable for Visual Studio 2015 is required. It can be downloaded from <a class="reference external" href="https://www.microsoft.com/en-us/download/details.aspx?id=48145">https://www.microsoft.com/en-us/download/details.aspx?id=48145</a></li>
</ul>
</dd>
</dl>
</li>
<li>Ubuntu (16.04 and later) and RHEL (7 and later) distributions</li>
</ul>
</div></blockquote>
<p>To clone the RCP repository, execute the following git commands</p>
<blockquote>
<div><ul class="simple">
<li>git clone <a class="reference external" href="https://github.com/GPUOpen-Tools/RCP.git">https://github.com/GPUOpen-Tools/RCP.git</a></li>
</ul>
</div></blockquote>
<p>After cloning the repository, please run the following python script to retrieve the required dependencies (see BUILD.md for more information):</p>
<blockquote>
<div><ul class="simple">
<li>python Scripts/UpdateCommon.py</li>
</ul>
</div></blockquote>
<p>UpdateCommon.py has replaced the use of git submodules in the CodeXL repository
Source Code Directory Layout</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/RCP/tree/master/Build">Build</a> – contains both Linux and Windows build-related files</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/RCP/tree/master/Scripts">Scripts</a>– scripts to use to clone/update dependent repositories</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/RCP/tree/master/Src/CLCommon">Src/CLCommon</a> – contains source code shared by the various OpenCL™ agents</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/RCP/tree/master/Src/CLOccupancyAgent">Src/CLOccupancyAgent</a> – contains source code for the OpenCL™ agent which collects kernel occupancy information</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/RCP/tree/master/Src/CLProfileAgent">Src/CLProfileAgent</a> – contains source code for the OpenCL™ agent which collects hardware performance counters</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/RCP/tree/master/Src/CLTraceAgent">Src/CLTraceAgent</a> – contains source code for the OpenCL™ agent which collects application trace information</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/RCP/tree/master/Src/Common">Src/Common</a> – contains source code shared by all of RCP</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/RCP/tree/master/Src/DeviceInfo">Src/DeviceInfo</a> – builds a lib containing the Common/Src/DeviceInfo code (Linux only)</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/RCP/tree/master/Src/HSAFdnCommon">Src/HSAFdnCommon</a> – contains source code shared by the various ROCm agents</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/RCP/tree/master/Src/HSAFdnPMC">Src/HSAFdnPMC</a> – contains source code for the ROCm agent which collects hardware performance counters</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/RCP/tree/master/Src/HSAFdnTrace">Src/HSAFdnTrace</a> – contains source code for the ROCm agent which collects application trace information</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/RCP/tree/master/Src/HSAUtils">Src/HSAUtils</a> – builds a lib containing the Common ROCm code (Linux only)</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/RCP/tree/master/Src/MicroDLL">Src/MicroDLL</a> – contains source code for API interception (Windows only)</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/RCP/tree/master/Src/PreloadXInitThreads">Src/PreloadXInitThreads</a> – contains source code for a library that call XInitThreads (Linux only)</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/RCP/tree/master/Src/ProfileDataParser">Src/ProfileDataParser</a> – contains source code for a library can be used to parse profiler output data files</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/RCP/tree/master/Src/VersionInfo">Src/VersionInfo</a>– contains version info resource files</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/RCP/tree/master/Src/sanalyze">Src/sanalyze</a> – contains source code used to analyze and summarize profiler data</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/RCP/tree/master/Src/sprofile">Src/sprofile</a> – contains source code for the main profiler executable</li>
</ul>
</div></blockquote>
<p>Although the Radeon Compute Profiler is a newly-branded tool, the technology contained in it has been around for several years. RCP has its roots in the AMD APP Profiler product, which progressed from version 1.x to 3.x. Then the profiler was included in CodeXL, and the codebase was labelled as version 4.x. Now that RCP is being pulled out of CodeXL and into its own codebase again, we’ve bumped the version number up to 5.x.</p>
<p><a class="reference external" href="http://gpuopen.com/getting-up-to-speed-with-the-codexl-gpu-profiler-and-radeon-open-compute/">ROCm Profiler blog post</a></p>
<blockquote>
<div><ul class="simple">
<li><dl class="first docutils">
<dt>For the OpenCL™ Profiler</dt>
<dd><ul class="first last">
<li>Collecting Performance Counters for an OpenCL™ application is not currently working for Vega GPUs on Windows when using a          17.20-based driver. This is due to missing driver support in the 17.20 driver. Future driver versions should provide the             support needed.</li>
<li>Collecting Performance Counters using –perfcounter for an OpenCL™ application when running OpenCL-on-ROCm is not suported              currently. The workaround is to profile using the ROCm profiler (using the –hsapmc command-line switch).</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>For the ROCm Profiler</dt>
<dd><ul class="first last">
<li>API Trace and Perf Counter data may be truncated or missing if the application being profiled does not call hsa_shut_down</li>
<li>Kernel occupancy information will only be written to disk if the application being profiled calls hsa_shut_down</li>
<li>When collecting a trace for an application that performs memory transfers using hsa_amd_memory_async_copy, if the               application asks for the data transfer timestamps directly, it will not get correct timestamps. The profiler will show the              correct timestamps, however.</li>
<li>When collecting an aql packet trace, if the application asks for the kernel dispatch timestamps directly, it will not get               correct timestamps. The profiler will show the correct timestamps, however.</li>
<li>When the rocm-profiler package (.deb or .rpm) is installed along with rocm, it may not be able to generate the default          single-pass counter files. If you do not see counter files in /opt/rocm/profiler/counterfiles, you can generate them            manually with this command: “sudo /opt/rocm/profiler/bin/CodeXLGpuProfiler –list –outputfile /opt/rocm/profiler/                counterfiles/counters –maxpassperfile 1”</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="codexl">
<h2>CodeXL<a class="headerlink" href="#codexl" title="Permalink to this headline">¶</a></h2>
<p>CodeXL is a comprehensive tool suite that enables developers to harness the benefits of CPUs, GPUs and APUs. It includes powerful GPU debugging, comprehensive GPU and CPU profiling, DirectX12® Frame Analysis, static OpenCL™, OpenGL®, Vulkan® and DirectX® kernel/shader analysis capabilities, and APU/CPU/GPU power profiling, enhancing accessibility for software developers to enter the era of heterogeneous computing. CodeXL is available both as a Visual Studio® extension and a standalone user interface application for Windows® and Linux®.</p>
<div class="section" id="motivation">
<h3>Motivation<a class="headerlink" href="#motivation" title="Permalink to this headline">¶</a></h3>
<p>CodeXL, previously a tool developed as closed-source by Advanced Micro Devices, Inc., is now released as Open Source. AMD believes that adopting the open-source model and sharing the CodeXL source base with the world can help developers make better use of CodeXL and make CodeXL a better tool.</p>
<p>To encourage 3rd party contribution and adoption, CodeXL is no longer branded as an AMD product. AMD will still continue development of this tool and upload new versions and features to GPUOpen.</p>
</div>
<div class="section" id="installation-and-build">
<h3>Installation and Build<a class="headerlink" href="#installation-and-build" title="Permalink to this headline">¶</a></h3>
<p>Windows: To install CodeXL, use the <a class="reference external" href="https://github.com/GPUOpen-Tools/CodeXL/releases">provided</a> executable file CodeXL_*.exe
Linux: To install CodeXL, use the <a class="reference external" href="https://github.com/GPUOpen-Tools/CodeXL/releases">provided</a> RPM file, Debian file, or simply extract the compressed archive onto your hard drive.
Refer to BUILD.md for information on building CodeXL from source.</p>
</div>
<div class="section" id="contributors">
<h3>Contributors<a class="headerlink" href="#contributors" title="Permalink to this headline">¶</a></h3>
<p>CodeXL’s GitHub repository (<a class="reference external" href="http://github.com/GPUOpen-Tools/CodeXL">http://github.com/GPUOpen-Tools/CodeXL</a>) is moderated by Advanced Micro Devices, Inc. as part of the GPUOpen initiative.</p>
<p>AMD encourages any and all contributors to submit changes, features, and bug fixes via Git pull requests to this repository.</p>
<p>Users are also encouraged to submit issues and feature requests via the repository’s issue tracker.</p>
</div>
<div class="section" id="license">
<h3>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h3>
<p>CodeXL is part of the GPUOpen.com initiative. CodeXL source code and binaries are released under the following MIT license:</p>
<p>Copyright © 2016 Advanced Micro Devices, Inc. All rights reserved.</p>
<p>MIT LICENSE: Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the “Software”), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>
</div>
<div class="section" id="attribution-and-copyrights">
<h3>Attribution and Copyrights<a class="headerlink" href="#attribution-and-copyrights" title="Permalink to this headline">¶</a></h3>
<p>Component licenses can be found under the CodeXL GitHub repository source root, in the /Setup/Legal/ folder.</p>
<p>OpenCL is a trademark of Apple Inc. used by permission by Khronos. OpenGL is a registered trademark of Silicon Graphics, Inc. in the United States and/or other countries worldwide. Microsoft, Windows, DirectX and Visual Studio are registered trademarks of Microsoft Corporation in the United States and/or other jurisdictions. Vulkan is a registered trademark of Khronos Group Inc. in the United States and/or other jurisdictions. Linux is the registered trademark of Linus Torvalds in the United States and/or other jurisdictions.</p>
<p>LGPL (Copyright ©1991, 1999 Free Software Foundation, Inc. 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA). Use of the Qt library is governed by the GNU Lesser General Public License version 2.1 (LGPL v 2.1). CodeXL uses QT 5.5.1. Source code for QT is available here: <a class="reference external" href="http://qt-project.org/downloads">http://qt-project.org/downloads</a>. The QT source code has not been tempered with and the built binaries are identical to what any user that downloads the source code from the web and builds them will produce.</p>
<p>Boost is Copyright © Beman Dawes, 2003.
[CR]LunarG, Inc. is Copyright © 2015 LunarG, Inc.
jqPlot is copyright © 2009-2011 Chris Leonello.
glew - The OpenGL Extension Wrangler Library is Copyright © 2002-2007, Milan Ikits &lt;milan ikits[]ieee org&gt;, Copyright © 2002-2007, Marcelo E. Magallon &lt;mmagallo[]debian org&gt;, Copyright © 2002, Lev Povalahev, All rights reserved.
lgplib is Copyright © 1994-1998, Thomas G. Lane., Copyright © 1991-2013, Thomas G. Lane, Guido Vollbeding.
LibDwarf (BSD) is Copyright © 2007 John Birrell (<a class="reference external" href="mailto:jb&#37;&#52;&#48;freebsd&#46;org">jb<span>&#64;</span>freebsd<span>&#46;</span>org</a>), Copyright © 2010 Kai Wang, All rights reserved.
libpng is Copyright © 1998-2014 Glenn Randers-Pehrson, (Version 0.96 Copyright © 1996, 1997 Andreas Dilger) (Version 0.88 Copyright © 1995, 1996 Guy Eric Schalnat, Group 42, Inc.).
QScintilla is Copyright © 2005 by Riverbank Computing Limited <a class="reference external" href="mailto:info&#37;&#52;&#48;riverbankcomputing&#46;co&#46;uk">info<span>&#64;</span>riverbankcomputing<span>&#46;</span>co<span>&#46;</span>uk</a>.
TinyXML is released under the zlib license © 2000-2007, Lee Thomason, © 2002-2004, Yves Berquin © 2005, Tyge Lovset.
UTF8cpp is Copyright © 2006 Nemanja Trifunovic.
zlib is Copyright © 1995-2010 Jean-loup Gailly and Mark Adler, Copyright © 2003 Chris Anderson <a class="reference external" href="mailto:christop&#37;&#52;&#48;charm&#46;net">christop<span>&#64;</span>charm<span>&#46;</span>net</a>, Copyright © 1998-2010 Gilles Vollant (minizip) ( <a class="reference external" href="http://www.winimage.com/zLibDll/minizip.html">http://www.winimage.com/zLibDll/minizip.html</a> ), Copyright © 2009-2010 Mathias Svensson ( <a class="reference external" href="http://result42.com">http://result42.com</a> ), Copyright © 2007-2008 Even Rouault.
QCustomPlot, an easy to use, modern plotting widget for Qt, Copyright (C) 2011-2015 Emanuel Eichhammer</p>
</div>
</div>
<div class="section" id="gpuperfapi">
<h2>GPUperfAPI<a class="headerlink" href="#gpuperfapi" title="Permalink to this headline">¶</a></h2>
<p>The GPU Performance API (GPUPerfAPI, or GPA) is a powerful library, providing access to GPU Performance Counters. It can help analyze the performance and execution characteristics of applications using a Radeon™ GPU. This library is used by both CodeXL and GPU PerfStudio.</p>
<div class="section" id="major-features">
<h3>Major Features<a class="headerlink" href="#major-features" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li>Provides a standard API for accessing GPU Performance counters for both graphics and compute workloads across multiple GPU APIs.</li>
<li>Supports DirectX11, OpenGL, OpenGLES, OpenCL™, and ROCm/HSA</li>
<li>Developer Preview for DirectX12 (no hardware-based performance counter support yet)</li>
<li>Supports all current GCN-based Radeon graphics cards and APUs.</li>
<li>Supports both Windows and Linux</li>
<li>Provides derived “public” counters based on raw HW counters</li>
<li>“Internal” version provides access to some raw hardware counters. See “Public” vs “Internal” Versions for more information.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="what-s-new">
<h3>What’s New<a class="headerlink" href="#what-s-new" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><dl class="docutils">
<dt>Version 2.23 (6/27/17)</dt>
<dd><ul class="first last simple">
<li>Add support for additional GPUs, including Vega series GPUs</li>
<li>Allow unit tests to be built and run on Linux</li>
</ul>
</dd>
</dl>
</div></blockquote>
</div>
<div class="section" id="system-requirements">
<h3>System Requirements<a class="headerlink" href="#system-requirements" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li>An AMD Radeon GCN-based GPU or APU</li>
<li><dl class="first docutils">
<dt>Radeon Software Crimson ReLive Edition 17.4.3 or later (Driver Packaging Version 17.10 or later).</dt>
<dd><ul class="first last">
<li>For Vega support, a driver with Driver Packaging Version 17.20 or later is required</li>
</ul>
</dd>
</dl>
</li>
<li>Pre-GCN-based GPUs or APUs are no longer supported by GPUPerfAPI. Please use an older version (2.17) with older hardware.</li>
<li>Windows 7, 8.1, and 10</li>
<li>Ubuntu (16.04 and later) and RHEL (7 and later) distributions</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="cloning-the-repository">
<h3>Cloning the Repository<a class="headerlink" href="#cloning-the-repository" title="Permalink to this headline">¶</a></h3>
<p>To clone the GPA repository, execute the following git commands</p>
<blockquote>
<div><ul class="simple">
<li>git clone <a class="reference external" href="https://github.com/GPUOpen-Tools/GPA.git">https://github.com/GPUOpen-Tools/GPA.git</a> After cloning the repository, please run the following python script to retrieve the      required dependencies (see BUILD.md for more information):</li>
<li>python Scripts/UpdateCommon.py UpdateCommon has replaced the use of git submodules in the GPA repository</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="source-code-directory-layout">
<h3>Source Code Directory Layout<a class="headerlink" href="#source-code-directory-layout" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/GPA/tree/master/Build">Build</a>  – contains both Linux and Windows build-related files</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/GPA/tree/master/Build">Common</a> – Common libs, header and source code not found in other repositories</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/GPA/tree/master/Doc">Doc</a> – contains User Guide and Doxygen configuration files</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/GPA/tree/master/Src/DeviceInfo">Src/DeviceInfo</a> – builds a lib containing the Common/Src/DeviceInfo code (Linux only)</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/GPA/tree/master/Src/GPUPerfAPI-Common">Src/GPUPerfAPI-Common</a>– contains source code for a Common library shared by all versions of GPUPerfAPI</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/GPA/tree/master/Src/GPUPerfAPICL">Src/GPUPerfAPICL</a> - contains the source for the OpenCL™ version of GPUPerfAPI</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/GPA/tree/master/Src/GPUPerfAPICounterGenerator">Src/GPUPerfAPICounterGenerator</a> - contains the source code for a Common library providing all counter data</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/GPA/tree/master/Src/GPUPerfAPICounters">Src/GPUPerfAPICounters</a> - contains the source code for a library that can be used to query counters without an active GPUPerfAPI context</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/GPA/tree/master/Src/GPUPerfAPIDX">Src/GPUPerfAPIDX</a> - contains source code shared by the DirectX versions of GPUPerfAPI</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/GPA/tree/master/Src/GPUPerfAPIDX11">Src/GPUPerfAPIDX11</a> - contains the source for the DirectX11 version of GPUPerfAPI</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/GPA/tree/master/Src/GPUPerfAPIDX12">Src/GPUPerfAPIDX12</a> - contains the source for the DirectX12 version of GPUPerfAPI (Developer Preview)</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/GPA/tree/master/Src/GPUPerfAPIGL">Src/GPUPerfAPIGL</a> - contains the source for the OpenGL version of GPUPerfAPI</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/GPA/tree/master/Src/GPUPerfAPIGLES">Src/GPUPerfAPIGLES</a>  - contains the source for the OpenGLES version of GPUPerfAPI</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/GPA/tree/master/Src/GPUPerfAPIHSA">Src/GPUPerfAPIHSA</a> - contains the source for the ROCm/HSA version of GPUPerfAPI</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/GPA/tree/master/Src/GPUPerfAPIUnitTests">Src/GPUPerfAPIUnitTests</a>- contains a small set of unit tests for GPUPerfAPI</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/GPA/tree/master/Src/PublicCounterCompiler">Src/PublicCounterCompiler</a> - source code for a tool to generate C++ code for public counters from text files defining the counters.</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/GPA/tree/master/Src/PublicCounterCompilerInputFiles">Src/PublicCounterCompilerInputFiles</a> - input files that can be fed as input to the PublicCounterCompiler tool</li>
<li><a class="reference external" href="https://github.com/GPUOpen-Tools/GPA/tree/master/Scripts">Scripts</a> – scripts to use to clone/update dependent repositories</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="public-vs-internal-versions">
<h3>Public” vs “Internal” Versions<a class="headerlink" href="#public-vs-internal-versions" title="Permalink to this headline">¶</a></h3>
<p>This open source release supports building both the “Public” and “Internal” versions of GPUPerfAPI. By default the Visual Studio solution and the Linux build scripts will produce what is referred to as the “Public” version of GPUPerfAPI. This version exposes “Public”, or “Derived”, counters. These are counters that are computed using a set of hardware counters. Until now, only the Public the version of GPUPerfAPI was available on the AMD Developer website. As part of the open-source effort, we are also providing the ability to build the “Internal” versions of GPUPerfAPI. In addition to exposing the same counters as the Public version, the Internal version also exposes some of the hardware Counters available in the GPU/APU. It’s important to note that not all hardware counters receive the same validation as other parts of the hardware on all GPUs, so in some cases accuracy of counter data cannot be guaranteed. The usage of the Internal version is identical to the Public version. The only difference will be in the name of the library an application loads at runtime and the list of counters exposed by the library. See the Build Instructions for more information on how to build and use the Internal version. In the future, we see there being only a single version of GPUPerfAPI, with perhaps a change in the API to allow users of GPA to indicate whether the library exposes just the Derived counters or both the Derived and the Hardware counters. We realize using the term “Internal” for something which is no longer actually Internal-to-AMD can be a bit confusing, and we will aim to change this in the future.</p>
</div>
<div class="section" id="known-issues">
<h3>Known Issues<a class="headerlink" href="#known-issues" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li>The OpenCL™ version of GPUPerfAPI requires at least Driver Version 17.30.1071 for Vega GPUs on Windows. Earlier driver versions have           either missing or incomplete support for collecting OpenCL performance counters</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="rocm-binary-utilities">
<h2>ROCm Binary Utilities<a class="headerlink" href="#rocm-binary-utilities" title="Permalink to this headline">¶</a></h2>
<p>Documentation need to be updated.</p>
</div>
<div class="section" id="mivisionx">
<h2>MIVisionX<a class="headerlink" href="#mivisionx" title="Permalink to this headline">¶</a></h2>
<p><strong>MIVisionX toolkit is a comprehensive computer vision and machine intelligence libraries, utilities and applications bundled into a single toolkit</strong></p>
<div class="section" id="amd-openvx-amd-openvx">
<h3>AMD OpenVX (amd_openvx)<a class="headerlink" href="#amd-openvx-amd-openvx" title="Permalink to this headline">¶</a></h3>
<p>AMD OpenVX is a highly optimized open source implementation of the Khronos OpenVX computer vision specification. It allows for rapid prototyping as well as fast execution on a wide range of computer hardware, including small embedded x86 CPUs and large workstation discrete GPUs.</p>
<p>The amd_openvx project consists of the following components:</p>
<blockquote>
<div><ul class="simple">
<li><strong>OpenVX</strong>: AMD OpenVX library</li>
</ul>
</div></blockquote>
<dl class="docutils">
<dt>The OpenVX framework provides a mechanism to add new vision functions to OpenVX by 3rd party vendors. Look into github amd_openvx_extensions folder for additional OpenVX modules and utilities.</dt>
<dd><ul class="first last simple">
<li><strong>vx_nn</strong>: OpenVX neural network module that was built on top of MIOpen</li>
<li><strong>vx_loomsl</strong>: Radeon LOOM stitching library for live 360 degree video applications</li>
<li><strong>vx_opencv</strong>: OpenVX module that implemented a mechanism to access OpenCV functionality as OpenVX kernels</li>
</ul>
</dd>
</dl>
<div class="section" id="features">
<h4>Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><ul class="simple">
<li>The code is highly optimized for both x86 CPU and OpenCL for GPU</li>
<li>Supported hardware spans the range from low power embedded APUs (like the new G series) to laptop, desktop and workstation graphics</li>
<li>Supports Windows, Linux, and OS X</li>
<li>Includes a “graph optimizer” that looks at the entire processing pipeline and removes/replaces/merges functions to improve performance and minimize bandwidth at runtime</li>
<li>Scripting support allows for rapid prototyping, without re-compiling at production performance levels.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="pre-requisites">
<h4>Pre-requisites:<a class="headerlink" href="#pre-requisites" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><ul class="simple">
<li>CPU: SSE4.1 or above CPU, 64-bit.</li>
<li><dl class="first docutils">
<dt>GPU: Radeon Professional Graphics Cards or Vega Family of Products (16GB required for vx_loomsl and vx_nn libraries)</dt>
<dd><ul class="first last">
<li>Windows: install the latest drivers and OpenCL SDK <a class="reference external" href="https://github.com/GPUOpen-LibrariesAndSDKs/OCL-SDK/releases">Download</a>.</li>
<li>Linux: install <a class="reference external" href="https://rocm.github.io/ROCmInstall.html">ROCm</a>.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>OpenCV 3 (optional) <a class="reference external" href="https://github.com/opencv/opencv/releases">download</a> for RunVX</dt>
<dd><ul class="first last">
<li>Set OpenCV_DIR environment variable to OpenCV/build folder.</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="build-instructions">
<h4>Build Instructions<a class="headerlink" href="#build-instructions" title="Permalink to this headline">¶</a></h4>
<dl class="docutils">
<dt>Build this project to generate AMD OpenVX library and RunVX executable.</dt>
<dd><ul class="first last simple">
<li>Refer to <a class="reference external" href="https://gpuopen-professionalcompute-libraries.github.io/MIVisionX/amd_openvx/openvx/include/VX/">openvx/include/VX</a> for Khronos OpenVX standard header files.</li>
<li>Refer to <a class="reference external" href="https://gpuopen-professionalcompute-libraries.github.io/MIVisionX/amd_openvx/openvx/include/vx_ext_amd.h">openvx/include/vx_ext_amd.h</a> for vendor extensions in AMD OpenVX library.</li>
<li>Refer to <a class="reference external" href="https://gpuopen-professionalcompute-libraries.github.io/MIVisionX/amd_openvx/runvx/README.md">runvx/README.md</a> for RunVX details.</li>
<li>Refer to <a class="reference external" href="https://gpuopen-professionalcompute-libraries.github.io/MIVisionX/amd_openvx/runcl/README.md">runcl/README.md</a> for RunCL details.</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="build-using-visual-studio-professional-2013-on-64-bit-windows-10-8-1-7">
<h4>Build using Visual Studio Professional 2013 on 64-bit Windows 10/8.1/7<a class="headerlink" href="#build-using-visual-studio-professional-2013-on-64-bit-windows-10-8-1-7" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><ul class="simple">
<li>Install OpenCV 3 with contrib <a class="reference external" href="https://github.com/opencv/opencv/releases">download</a> for RunVX tool to support camera capture and image display (optional)</li>
<li>OpenCV_DIR environment variable should point to OpenCV/build folder</li>
<li>Use amdovx-core/amdovx.sln to build for x64 platform</li>
<li>f AMD GPU (or OpenCL) is not available, set build flag ENABLE_OPENCL=0 in openvx/openvx.vcxproj and runvx/runvx.vcxproj.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="build-using-cmake">
<h4>Build using CMake<a class="headerlink" href="#build-using-cmake" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><ul class="simple">
<li>Install CMake 2.8 or newer <a class="reference external" href="cmake.org/download/">download</a>.</li>
<li>Install OpenCV 3 with contrib <a class="reference external" href="https://github.com/opencv/opencv/releases">download</a> for RunVX tool to support camera capture and image display (optional)</li>
<li>OpenCV_DIR environment variable should point to OpenCV/build folder</li>
<li>Install libssl-dev on linux (optional)</li>
<li>Use CMake to configure and generate Makefile</li>
<li>If AMD GPU (or OpenCL) is not available, use build flag -DCMAKE_DISABLE_FIND_PACKAGE_OpenCL=TRUE.</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="amd-openvx-extensions-amd-openvx-extensions">
<h3>AMD OpenVX Extensions (amd_openvx_extensions)<a class="headerlink" href="#amd-openvx-extensions-amd-openvx-extensions" title="Permalink to this headline">¶</a></h3>
<p>The OpenVX framework provides a mechanism to add new vision functions to OpenVX by 3rd party vendors. This project has below OpenVX modules and utilities to extend AMD OpenVX (amd_openvx) project, which contains the AMD OpenVX Core Engine.</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="https://gpuopen-professionalcompute-libraries.github.io/MIVisionX/amd_openvx_extensions/amd_loomsl/#radeon-loom-stitching-library-vx_loomsl">amd_loomsl</a>: AMD Radeon LOOM stitching library for live 360 degree video applications</li>
<li><a class="reference external" href="https://gpuopen-professionalcompute-libraries.github.io/MIVisionX/amd_openvx_extensions/amd_nn/#openvx-neural-network-extension-library-vx_nn">amd_nn</a>: OpenVX neural network module</li>
<li><a class="reference external" href="https://gpuopen-professionalcompute-libraries.github.io/MIVisionX/amd_openvx_extensions/amd_opencv/#amd-module-for-opencv-interop-from-openvx-vx_opencv">amd_opencv</a>: OpenVX module that implements a mechanism to access OpenCV functionality as OpenVX kernels</li>
</ul>
</div></blockquote>
<div class="section" id="radeon-loom-stitching-library-vx-loomsl">
<h4>Radeon Loom Stitching Library (vx_loomsl)<a class="headerlink" href="#radeon-loom-stitching-library-vx-loomsl" title="Permalink to this headline">¶</a></h4>
<p>Radeon Loom Stitching Library (beta preview) is a highly optimized library for 360 degree video stitching applications. This library consists of:</p>
<blockquote>
<div><ul class="simple">
<li>Live Stitch API: stitching framework built on top of OpenVX kernels (see <a class="reference external" href="https://gpuopen-professionalcompute-libraries.github.io/MIVisionX/amd_openvx_extensions/amd_loomsl/live_stitch_api.h">live_stitch_api.h</a> for API)</li>
<li>OpenVX module [vx_loomsl]: additional OpenVX kernels needed for 360 degree video stitching</li>
</ul>
</div></blockquote>
<p>The <a class="reference external" href="https://gpuopen-professionalcompute-libraries.github.io/MIVisionX/amd_openvx_extensions/utils/loom_shell/README.md">loom_shell</a> command-line tool can be used to build your application quickly. It provides direct access to Live Stitch API by encapsulating the calls to enable rapid prototyping.</p>
<p>This software is provided under a MIT-style license, see the file COPYRIGHT.txt for details.</p>
<p><strong>Features</strong></p>
<blockquote>
<div><ul class="simple">
<li>Real-time live 360 degree video stitching optimized for Radeon Pro Graphics</li>
<li>Upto 31 cameras</li>
<li>Upto 7680x3840 output resolution</li>
<li>RGB and YUV 4:2:2 image formats</li>
<li>Overlay other videos on top of stitched video</li>
<li>Support for 3rd party LoomIO plug-ins for camera capture and stitched output</li>
<li>Support PtGui project export/import for camera calibration</li>
</ul>
</div></blockquote>
<p><strong>Live Stitch API: Simple Example</strong></p>
<p>Let’s consider a 360 rig that has 3 1080p cameras with Circular FishEye lenses. The below example demonstrates how to stitch images from these cameras into a 4K Equirectangular buffer.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &quot;vx_loomsl/live_stitch_api.h&quot;</span>
  <span class="c1">#include &quot;utils/loom_shell/loom_shell_util.h&quot;</span>

  <span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="c1"># define camera orientation and lens parameters</span>
    <span class="n">camera_params</span> <span class="n">cam1_par</span> <span class="o">=</span> <span class="p">{</span> <span class="p">{</span> <span class="mi">120</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">},{</span><span class="mi">176</span><span class="p">,</span><span class="mi">1094</span><span class="p">,</span><span class="mi">547</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">37</span><span class="p">,</span><span class="n">ptgui_lens_fisheye_circ</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1719</span><span class="p">,</span><span class="mf">0.1539</span><span class="p">,</span><span class="mf">1.0177</span><span class="p">}</span> <span class="p">};</span>
    <span class="n">camera_params</span> <span class="n">cam2_par</span> <span class="o">=</span> <span class="p">{</span> <span class="p">{</span>   <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">},{</span><span class="mi">176</span><span class="p">,</span><span class="mi">1094</span><span class="p">,</span><span class="mi">547</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">37</span><span class="p">,</span><span class="n">ptgui_lens_fisheye_circ</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1719</span><span class="p">,</span><span class="mf">0.1539</span><span class="p">,</span><span class="mf">1.0177</span><span class="p">}</span> <span class="p">};</span>
    <span class="n">camera_params</span> <span class="n">cam3_par</span> <span class="o">=</span> <span class="p">{</span> <span class="p">{</span><span class="o">-</span><span class="mi">120</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">},{</span><span class="mi">176</span><span class="p">,</span><span class="mi">1094</span><span class="p">,</span><span class="mi">547</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">37</span><span class="p">,</span><span class="n">ptgui_lens_fisheye_circ</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1719</span><span class="p">,</span><span class="mf">0.1539</span><span class="p">,</span><span class="mf">1.0177</span><span class="p">}</span> <span class="p">};</span>

    <span class="c1"># create a live stitch instance and initialize</span>
    <span class="n">ls_context</span> <span class="n">context</span><span class="p">;</span>
    <span class="n">context</span> <span class="o">=</span> <span class="n">lsCreateContext</span><span class="p">();</span>
    <span class="n">lsSetOutputConfig</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="n">VX_DF_IMAGE_RGB</span><span class="p">,</span><span class="mi">3840</span><span class="p">,</span><span class="mi">1920</span><span class="p">);</span>
    <span class="n">lsSetCameraConfig</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">VX_DF_IMAGE_RGB</span><span class="p">,</span><span class="mi">1920</span><span class="p">,</span><span class="mi">1080</span><span class="o">*</span><span class="mi">3</span><span class="p">);</span>
    <span class="n">lsSetCameraParams</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">cam1_par</span><span class="p">);</span>
    <span class="n">lsSetCameraParams</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">cam2_par</span><span class="p">);</span>
    <span class="n">lsSetCameraParams</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">cam3_par</span><span class="p">);</span>
    <span class="n">lsInitialize</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>

    <span class="c1"># Get OpenCL context and create OpenCL buffers for input and output</span>
    <span class="n">cl_context</span> <span class="n">opencl_context</span><span class="p">;</span>
    <span class="n">cl_mem</span> <span class="n">buf</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
    <span class="n">lsGetOpenCLContext</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="o">&amp;</span><span class="n">opencl_context</span><span class="p">);</span>
    <span class="n">createBuffer</span><span class="p">(</span><span class="n">opencl_context</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="mi">1920</span><span class="o">*</span><span class="mi">1080</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">buf</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="n">createBuffer</span><span class="p">(</span><span class="n">opencl_context</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="mi">3840</span><span class="o">*</span><span class="mi">1920</span>  <span class="p">,</span> <span class="o">&amp;</span><span class="n">buf</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>

    <span class="c1"># load CAM00.bmp, CAM01.bmp, and CAM02.bmp (1920x1080 each) into buf[0]</span>
    <span class="n">loadBufferFromMultipleImages</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;CAM</span><span class="si">%02d</span><span class="s2">.bmp&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">VX_DF_IMAGE_RGB</span><span class="p">,</span><span class="mi">1920</span><span class="p">,</span><span class="mi">1080</span><span class="o">*</span><span class="mi">3</span><span class="p">);</span>

    <span class="c1"># set input and output buffers and stitch a frame</span>
    <span class="n">lsSetCameraBuffer</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">buf</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="n">lsSetOutputBuffer</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">buf</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="n">lsScheduleFrame</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
    <span class="n">lsWaitForCompletion</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>

    <span class="c1"># save the stitched output into &quot;output.bmp&quot;</span>
    <span class="n">saveBufferToImage</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="s2">&quot;output.bmp&quot;</span><span class="p">,</span><span class="n">VX_DF_IMAGE_RGB</span><span class="p">,</span><span class="mi">3840</span><span class="p">,</span><span class="mi">1920</span><span class="p">);</span>

    <span class="c1"># release resources</span>
    <span class="n">releaseBuffer</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="n">releaseBuffer</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="n">lsReleaseContext</span><span class="p">(</span><span class="o">&amp;</span><span class="n">context</span><span class="p">);</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
</pre></div>
</div>
<p><strong>Live Stitch API: Real-time Live Stitch using LoomIO</strong></p>
<p>This example makes use of a 3rd party LoomIO plug-ins for live camera capture and display.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &quot;vx_loomsl/live_stitch_api.h&quot;</span>
  <span class="nb">int</span> <span class="n">main</span><span class="p">()</span>
  <span class="p">{</span>
      <span class="o">//</span> <span class="n">create</span> <span class="n">context</span><span class="p">,</span> <span class="n">configure</span><span class="p">,</span> <span class="ow">and</span> <span class="n">initialize</span>
      <span class="n">ls_context</span> <span class="n">context</span><span class="p">;</span>
      <span class="n">context</span> <span class="o">=</span> <span class="n">lsCreateContext</span><span class="p">();</span>
      <span class="n">lsSetOutputConfig</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">VX_DF_IMAGE_RGB</span><span class="p">,</span> <span class="mi">3840</span><span class="p">,</span> <span class="mi">1920</span><span class="p">);</span>
      <span class="n">lsSetCameraConfig</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">VX_DF_IMAGE_RGB</span><span class="p">,</span> <span class="mi">1920</span><span class="p">,</span> <span class="mi">1080</span> <span class="o">*</span> <span class="mi">16</span><span class="p">);</span>
      <span class="n">lsImportConfiguration</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="s2">&quot;pts&quot;</span><span class="p">,</span> <span class="s2">&quot;myrig.pts&quot;</span><span class="p">);</span>
      <span class="n">lsSetCameraModule</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="s2">&quot;vx_loomio_bm&quot;</span><span class="p">,</span> <span class="s2">&quot;com.amd.loomio_bm.capture&quot;</span><span class="p">,</span> <span class="s2">&quot;30,0,0,16&quot;</span><span class="p">);</span>
      <span class="n">lsSetOutputModule</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="s2">&quot;vx_loomio_bm&quot;</span><span class="p">,</span> <span class="s2">&quot;com.amd.loomio_bm.display&quot;</span><span class="p">,</span> <span class="s2">&quot;30,0,0&quot;</span><span class="p">);</span>
      <span class="n">lsInitialize</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>

      <span class="o">//</span> <span class="n">process</span> <span class="n">live</span> <span class="kn">from</span> <span class="nn">camera</span> <span class="n">until</span> <span class="n">aborted</span> <span class="n">by</span> <span class="nb">input</span> <span class="n">capture</span> <span class="n">plug</span><span class="o">-</span><span class="ow">in</span>
      <span class="k">for</span><span class="p">(;;)</span> <span class="p">{</span>
        <span class="n">vx_status</span> <span class="n">status</span><span class="p">;</span>
        <span class="n">status</span> <span class="o">=</span> <span class="n">lsScheduleFrame</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="o">!=</span> <span class="n">VX_SUCCESS</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
        <span class="n">status</span> <span class="o">=</span> <span class="n">lsWaitForCompletion</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="o">!=</span> <span class="n">VX_SUCCESS</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="o">//</span> <span class="n">release</span> <span class="n">the</span> <span class="n">context</span>
      <span class="n">lsReleaseContext</span><span class="p">(</span><span class="o">&amp;</span><span class="n">context</span><span class="p">);</span>

      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="openvx-neural-network-extension-library-vx-nn">
<h4>OpenVX Neural Network Extension Library (vx_nn)<a class="headerlink" href="#openvx-neural-network-extension-library-vx-nn" title="Permalink to this headline">¶</a></h4>
<p>vx_nn is an OpenVX Neural Network extension module. This implementation supports only floating-point tensor datatype and does not support 8-bit and 16-bit fixed-point datatypes specified in the OpenVX specification.</p>
<p><strong>List of supported tensor and neural network layers:</strong></p>
<div class="line-block">
<div class="line">Layer name | Function|Kernel name | | ——<a href="#id28"><span class="problematic" id="id29">|—————|</span></a>———— | |</div>
</div>
<p>Activation|vxActivationLayer|org.khronos.nn_extension.activation_layer | |
Argmax|vxArgmaxLayerNode|com.amd.nn_extension.argmax_layer | | Batch
Normalization|vxBatchNormalizationLayer|com.amd.nn_extension.batch_normalization_layer | |
Concat|vxConcatLayer|com.amd.nn_extension.concat_layer | |
Convolution|vxConvolutionLayer|org.khronos.nn_extension.convolution_layer | |
Deconvolution|vxDeconvolutionLayer|org.khronos.nn_extension.deconvolution_layer | | Fully
Connected|vxFullyConnectedLayer|org.khronos.nn_extension.fully_connected_layer | | Local
Response Normalization|vxNormalizationLayer|org.khronos.nn_extension.normalization_layer | |
Pooling|vxPoolingLayer|org.khronos.nn_extension.pooling_layer | | ROI
Pooling|vxROIPoolingLayer|org.khronos.nn_extension.roi_pooling_layer | |
Scale|vxScaleLayer|com.amd.nn_extension.scale_layer | |
Slice|vxSliceLayer|com.amd.nn_extension.slice_layer | |
Softmax|vxSoftmaxLayer|org.khronos.nn_extension.softmax_layer | | Tensor
Add|vxTensorAddNode|org.khronos.openvx.tensor_add | | Tensor Convert
Depth|vxTensorConvertDepthNode|org.khronos.openvx.tensor_convert_depth | | Tensor Convert
from Image|vxConvertImageToTensorNode|com.amd.nn_extension.convert_image_to_tensor | |
Tensor Convert to
Image|vxConvertTensorToImageNode|com.amd.nn_extension.convert_tensor_to_image | | Tensor
Multiply|vxTensorMultiplyNode|org.khronos.openvx.tensor_multiply | | Tensor
Subtract|vxTensorSubtractNode|org.khronos.openvx.tensor_subtract | | Upsample Nearest
Neighborhood|vxUpsampleNearestLayer|com.amd.nn_extension.upsample_nearest_layer |</p>
<p><strong>Example 1: Convert an image to a tensor of type float32</strong></p>
<p>Use the below GDF with RunVX.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">vx_nn</span>
<span class="n">data</span> <span class="nb">input</span>  <span class="o">=</span> <span class="n">image</span><span class="p">:</span><span class="mi">32</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="n">RGB2</span>
<span class="n">data</span> <span class="n">output</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">:</span><span class="mi">4</span><span class="p">,{</span><span class="mi">32</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">},</span><span class="n">VX_TYPE_FLOAT32</span><span class="p">,</span><span class="mi">0</span>
<span class="n">data</span> <span class="n">a</span> <span class="o">=</span> <span class="n">scalar</span><span class="p">:</span><span class="n">FLOAT32</span><span class="p">,</span><span class="mf">1.0</span>
<span class="n">data</span> <span class="n">b</span> <span class="o">=</span> <span class="n">scalar</span><span class="p">:</span><span class="n">FLOAT32</span><span class="p">,</span><span class="mf">0.0</span>
<span class="n">data</span> <span class="n">reverse_channel_order</span> <span class="o">=</span> <span class="n">scalar</span><span class="p">:</span><span class="n">BOOL</span><span class="p">,</span><span class="mi">0</span>
<span class="n">read</span> <span class="nb">input</span> <span class="nb">input</span><span class="o">.</span><span class="n">png</span>
<span class="n">node</span> <span class="n">com</span><span class="o">.</span><span class="n">amd</span><span class="o">.</span><span class="n">nn_extension</span><span class="o">.</span><span class="n">convert_image_to_tensor</span> <span class="nb">input</span> <span class="n">output</span> <span class="n">a</span> <span class="n">b</span> <span class="n">reverse_channel_order</span>
<span class="n">write</span> <span class="n">output</span> <span class="nb">input</span><span class="o">.</span><span class="n">f32</span>
</pre></div>
</div>
<p><strong>Example 2: 2x2 Upsample a tensor of type float32</strong></p>
<p>Use the below GDF with RunVX.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">vx_nn</span>
<span class="n">data</span> <span class="nb">input</span>  <span class="o">=</span> <span class="n">tensor</span><span class="p">:</span><span class="mi">4</span><span class="p">,{</span><span class="mi">80</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">},</span><span class="n">VX_TYPE_FLOAT32</span><span class="p">,</span><span class="mi">0</span>
<span class="n">data</span> <span class="n">output</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">:</span><span class="mi">4</span><span class="p">,{</span><span class="mi">160</span><span class="p">,</span><span class="mi">160</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">},</span><span class="n">VX_TYPE_FLOAT32</span><span class="p">,</span><span class="mi">0</span>
<span class="n">read</span> <span class="nb">input</span>  <span class="n">tensor</span><span class="o">.</span><span class="n">f32</span>
<span class="n">node</span> <span class="n">com</span><span class="o">.</span><span class="n">amd</span><span class="o">.</span><span class="n">nn_extension</span><span class="o">.</span><span class="n">upsample_nearest_layer</span> <span class="nb">input</span> <span class="n">output</span>
<span class="n">write</span> <span class="n">output</span> <span class="n">upsample</span><span class="o">.</span><span class="n">f32</span>
</pre></div>
</div>
</div>
<div class="section" id="amd-module-for-opencv-interop-from-openvx-vx-opencv">
<h4>AMD Module for OpenCV-interop from OpenVX (vx_opencv)<a class="headerlink" href="#amd-module-for-opencv-interop-from-openvx-vx-opencv" title="Permalink to this headline">¶</a></h4>
<p>The vx_opencv is an OpenVX module that implemented a mechanism to access OpenCV functionality as OpenVX kernels. These kernels can be access from within OpenVX framework using OpenVX API call <a class="reference external" href="https://www.khronos.org/registry/OpenVX/specs/1.0.1/html/da/d83/group__group__user__kernels.html#gae00b6343fbb0126e3bf0f587b09393a3">vxLoadKernels</a> (context, “vx_opencv”).</p>
<p><strong>List of OpenCV-interop kernels</strong></p>
<p>The following is a list of OpenCV functions that have been included in the vx_opencv module.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bilateralFilter</span>             <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">bilateralfilter</span>
<span class="n">blur</span>                        <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">blur</span>
<span class="n">boxfilter</span>                   <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">boxfilter</span>
<span class="n">buildPyramid</span>                <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">buildpyramid</span>
<span class="n">Dilate</span>                      <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">dilate</span>
<span class="n">Erode</span>                       <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">erode</span>
<span class="n">filter2D</span>                    <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">filter2d</span>
<span class="n">GaussianBlur</span>                <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">gaussianblur</span>
<span class="n">MedianBlur</span>                  <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">medianblur</span>
<span class="n">morphologyEx</span>                <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">morphologyex</span>
<span class="n">Laplacian</span>                   <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">laplacian</span>
<span class="n">pyrDown</span>                     <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">pyrdown</span>
<span class="n">pyrUp</span>                       <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">pyrup</span>
<span class="n">sepFilter2D</span>                 <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">sepfilter2d</span>
<span class="n">Sobel</span>                       <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">sobel</span>
<span class="n">Scharr</span>                      <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">scharr</span>
<span class="n">FAST</span>                        <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">fast</span>
<span class="n">MSER</span>                        <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">mser_detect</span>
<span class="n">ORB</span>                         <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">orb_detect</span>
<span class="n">ORB_Compute</span>                 <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">orb_compute</span>
<span class="n">BRISK</span>                       <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">brisk_detect</span>
<span class="n">BRISK_Compute</span>               <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">brisk_compute</span>
<span class="n">SimpleBlobDetector</span>          <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">simple_blob_detect</span>
<span class="n">SimpleBlobDetector_Init</span>     <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">simple_blob_detect_initialize</span>
<span class="n">SIFT_Detect</span>                 <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">sift_detect</span>
<span class="n">SIFT_Compute</span>                <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">sift_compute</span>
<span class="n">SURF_Detect</span>                 <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">surf_detect</span>
<span class="n">SURF_Compute</span>                <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">surf_compute</span>
<span class="n">STAR_FEATURE_Detector</span>       <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">star_detect</span>
<span class="n">Canny</span>                       <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">canny</span>
<span class="n">GoodFeature_Detector</span>        <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">good_features_to_track</span>
<span class="n">buildOpticalFlowPyramid</span>     <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">buildopticalflowpyramid</span>
<span class="n">DistanceTransform</span>           <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">distancetransform</span>
<span class="n">Convert_Scale_Abs</span>           <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">convertscaleabs</span>
<span class="n">addWeighted</span>                 <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">addweighted</span>
<span class="n">Transpose</span>                   <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">transpose</span>
<span class="n">Resize</span>                      <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">resize</span>
<span class="n">AdaptiveThreshold</span>           <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">adaptivethreshold</span>
<span class="n">Threshold</span>                   <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">threshold</span>
<span class="n">cvtcolor</span>                    <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">cvtcolor</span>
<span class="n">Flip</span>                        <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">flip</span>
<span class="n">fastNlMeansDenoising</span>        <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">fastnlmeansdenoising</span>
<span class="n">fastNlMeansDenoisingColored</span> <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">fastnlmeansdenoisingcolored</span>
<span class="n">AbsDiff</span>                     <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">absdiff</span>
<span class="n">Compare</span>                     <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">compare</span>
<span class="n">bitwise_and</span>                 <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">bitwise_and</span>
<span class="n">bitwise_not</span>                 <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">bitwise_not</span>
<span class="n">bitwise_or</span>                  <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">bitwise_or</span>
<span class="n">bitwise_xor</span>                 <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">bitwise_xor</span>
<span class="n">Add</span>                         <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">add</span>
<span class="n">Subtract</span>                    <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">subtract</span>
<span class="n">Multiply</span>                    <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">multiply</span>
<span class="n">Divide</span>                      <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">divide</span>
<span class="n">WarpAffine</span>                  <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">warpaffine</span>
<span class="n">WarpPerspective</span>             <span class="n">org</span><span class="o">.</span><span class="n">opencv</span><span class="o">.</span><span class="n">warpperspective</span>
</pre></div>
</div>
<div class="section" id="id15">
<h5>Build Instructions<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h5>
<p><strong>Pre-requisites</strong></p>
<blockquote>
<div><ul class="simple">
<li>OpenCV 3 <a class="reference external" href="https://github.com/opencv/opencv/releases">download</a>.</li>
<li>CMake 2.8 or newer <a class="reference external" href="https://cmake.org/download/">download</a>.</li>
<li>Build amdovx-core project at the same level folder as amdovx-modules build folder</li>
<li>OpenCV_DIR environment variable should point to OpenCV/build folder</li>
</ul>
</div></blockquote>
<p><strong>Build using Visual Studio Professional 2013 on 64-bit Windows 10/8.1/7</strong></p>
<p>Use amdovx-modules/vx_opencv/vx_opencv.sln to build for x64 platform</p>
<p><strong>Build using CMake on Linux (Ubuntu 15.10 64-bit)</strong></p>
<blockquote>
<div><ul class="simple">
<li>Use CMake to configure and generate Makefile</li>
</ul>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="applications">
<h3>Applications<a class="headerlink" href="#applications" title="Permalink to this headline">¶</a></h3>
<p>MIVisionX has a number of applications built on top of OpenVX modules, it uses AMD optimized libraries to build applications which can be used to prototype or used as models to develop a product.</p>
<div class="section" id="cloud-inference-application-cloud-inference">
<h4>Cloud Inference Application (cloud_inference)<a class="headerlink" href="#cloud-inference-application-cloud-inference" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="https://gpuopen-professionalcompute-libraries.github.io/MIVisionX/apps/cloud_inference/server_app/#anninferenceserver">Cloud Inference Server</a>: sample Inference Server</li>
<li><a class="reference external" href="https://gpuopen-professionalcompute-libraries.github.io/MIVisionX/apps/cloud_inference/client_app/#anninferenceapp">Cloud Inference Client</a>: sample Inference Client Application</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="convert-neural-net-models-into-amd-nnir-and-openvx-code">
<h4>Convert Neural Net models into AMD NNIR and OpenVX Code<a class="headerlink" href="#convert-neural-net-models-into-amd-nnir-and-openvx-code" title="Permalink to this headline">¶</a></h4>
<p>This tool converts <a class="reference external" href="https://onnx.ai">ONNX</a>  or <a class="reference external" href="http://caffe.berkeleyvision.org/">Caffe</a> models to AMD NNIR format and OpenVX code.</p>
<p>You need MIVisionX libraries to be able to build and run the generated OpenVX code.</p>
<dl class="docutils">
<dt><strong>Dependencies</strong></dt>
<dd><ul class="first last simple">
<li>numpy</li>
<li>onnx (0.2.1+)</li>
</ul>
</dd>
</dl>
<p><strong>How to use?</strong></p>
<p>To convert an ONNX model into AMD NNIR model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">python</span> <span class="n">onnx2nnir</span><span class="o">.</span><span class="n">py</span> <span class="n">model</span><span class="o">.</span><span class="n">pb</span> <span class="n">nnirModelFolder</span>
</pre></div>
</div>
<p>To convert a caffemodel into AMD NNIR model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">python</span> <span class="n">caffe2nnir</span><span class="o">.</span><span class="n">py</span> <span class="o">&lt;</span><span class="n">net</span><span class="o">.</span><span class="n">caffeModel</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">nnirOutputFolder</span><span class="o">&gt;</span> <span class="o">--</span><span class="nb">input</span><span class="o">-</span><span class="n">dims</span> <span class="n">n</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">w</span> <span class="p">[</span><span class="o">--</span><span class="n">verbose</span> <span class="mi">0</span><span class="o">|</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>To update batch size in AMD NNIR model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">python</span> <span class="n">nnir</span><span class="o">-</span><span class="n">update</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">size</span> <span class="n">N</span> <span class="n">nnirModelFolder</span> <span class="n">nnirModelFolderN</span>
</pre></div>
</div>
<p>To fuse operations in AMD NNIR model (like batch normalization into convolution):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">python</span> <span class="n">nnir</span><span class="o">-</span><span class="n">update</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">fuse</span><span class="o">-</span><span class="n">ops</span> <span class="mi">1</span> <span class="n">nnirModelFolderN</span> <span class="n">nnirModelFolderFused</span>
</pre></div>
</div>
<p>To workaround groups using slice and concat operations in AMD NNIR model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">python</span> <span class="n">nnir</span><span class="o">-</span><span class="n">update</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="nb">slice</span><span class="o">-</span><span class="n">groups</span> <span class="mi">1</span> <span class="n">nnirModelFolderFused</span> <span class="n">nnirModelFolderSliced</span>
</pre></div>
</div>
<p>To convert an AMD NNIR model into OpenVX C code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">python</span> <span class="o">--</span><span class="n">help</span>
</pre></div>
</div>
<p>Usage: python nnir2openvx.py [OPTIONS] &lt;nnirInputFolder&gt; &lt;outputFolder&gt;</p>
<blockquote>
<div><dl class="docutils">
<dt>OPTIONS:</dt>
<dd><table class="first docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">--argmax <var>UINT8</var></span></kbd></td>
<td>– argmax at the end with 8-bit output</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">--argmax <var>UINT16</var></span></kbd></td>
</tr>
<tr><td>&#160;</td><td>– argmax at the end with 16-bit output</td></tr>
</tbody>
</table>
<p class="last">–argmax &lt;fileNamePrefix&gt;rgb.txt  – argmax at the end with RGB color mapping using LUT
–argmax &lt;fileNamePrefix&gt;rgba.txt – argmax at the end with RGBA color mapping using LUT
–help                            – show this help message</p>
</dd>
<dt>LUT File Format (RGB): 8-bit R G B values one per each label in text format</dt>
<dd>R0 G0 B0
R1 G1 B1
…</dd>
<dt>LUT File Format (RGBA): 8-bit R G B A values one per each label in text format</dt>
<dd>R0 G0 B0 A0
R1 G1 B1 A1
…</dd>
</dl>
</div></blockquote>
<p><strong>Here are few examples of OpenVX C code generation</strong></p>
<p>Generate OpenVX and test code that can be used dump and compare raw tensor data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">python</span> <span class="n">nnir2openvx</span><span class="o">.</span><span class="n">py</span> <span class="n">nnirInputFolderFused</span> <span class="n">openvxCodeFolder</span>
<span class="o">%</span> <span class="n">mkdir</span> <span class="n">openvxCodeFolder</span><span class="o">/</span><span class="n">build</span>
<span class="o">%</span> <span class="n">cd</span> <span class="n">openvxCodeFolder</span><span class="o">/</span><span class="n">build</span>
<span class="o">%</span> <span class="n">cmake</span> <span class="o">..</span>
<span class="o">%</span> <span class="n">make</span>
<span class="o">%</span> <span class="o">./</span><span class="n">anntest</span>
</pre></div>
</div>
<p>Usage: anntest &lt;weights.bin&gt; [&lt;input-data-file(s)&gt; [&lt;output-data-file(s)&gt;]]]</p>
<blockquote>
<div><dl class="docutils">
<dt>&lt;input-data-file&gt;: is filename to initialize tensor</dt>
<dd><dl class="first docutils">
<dt>.jpg or .png: decode and initialize for 3 channel tensors</dt>
<dd>(use %04d in fileName to when batch-size &gt; 1: batch index starts from 0)</dd>
</dl>
<p class="last">other: initialize tensor with raw data from the file</p>
</dd>
<dt>&lt;output-data-file&gt;[,&lt;reference-for-compare&gt;,&lt;maxErrorLimit&gt;,&lt;rmsErrorLimit&gt;]:</dt>
<dd><p class="first">&lt;referece-to-compare&gt; is raw tensor data for comparision
&lt;maxErrorLimit&gt; is max absolute error allowed
&lt;rmsErrorLimit&gt; is max RMS error allowed
&lt;output-data-file&gt; is filename for saving output tensor data</p>
<blockquote class="last">
<div>‘-‘ to ignore
other: save raw tensor into the file</div></blockquote>
</dd>
</dl>
</div></blockquote>
<p>% ./anntest ../weights.bin input.f32 output.f32,reference.f32,1e-6,1e-9
…</p>
<p>Generate OpenVX and test code with argmax that can be used dump and compare 16-bit argmax output tensor:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="o">%</span> <span class="n">python</span> <span class="n">nnir2openvx</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">argmax</span> <span class="n">UINT16</span> <span class="n">nnirInputFolderFused</span> <span class="n">openvxCodeFolder</span>
<span class="o">%</span> <span class="n">mkdir</span> <span class="n">openvxCodeFolder</span><span class="o">/</span><span class="n">build</span>
<span class="o">%</span> <span class="n">cd</span> <span class="n">openvxCodeFolder</span><span class="o">/</span><span class="n">build</span>
<span class="o">%</span> <span class="n">cmake</span> <span class="o">..</span>
<span class="o">%</span> <span class="n">make</span>
<span class="o">%</span> <span class="o">./</span><span class="n">anntest</span>
</pre></div>
</div>
<p>Usage: anntest &lt;weights.bin&gt; [&lt;input-data-file(s)&gt; [&lt;output-data-file(s)&gt;]]]</p>
<blockquote>
<div><dl class="docutils">
<dt>&lt;input-data-file&gt;: is filename to initialize tensor</dt>
<dd><dl class="first docutils">
<dt>.jpg or .png: decode and initialize for 3 channel tensors</dt>
<dd>(use %04d in fileName to when batch-size &gt; 1: batch index starts from 0)</dd>
</dl>
<p class="last">other: initialize tensor with raw data from the file</p>
</dd>
<dt>&lt;output-data-file&gt;[,&lt;reference-for-compare&gt;,&lt;percentErrorLimit&gt;]:</dt>
<dd><p class="first">&lt;referece-to-compare&gt; is raw tensor data of argmax output for comparision
&lt;percentMismatchLimit&gt; is max mismatch (percentage) allowed
&lt;output-data-file&gt; is filename for saving output tensor data</p>
<blockquote class="last">
<div>‘-‘ to ignore
other: save raw tensor into the file</div></blockquote>
</dd>
</dl>
</div></blockquote>
<p>% ./anntest ../weights.bin input-%04d.png output.u16,reference.u16,0.01
…</p>
<p>Generate OpenVX and test code with argmax and LUT that is designed for semantic segmentation use cases. You can dump output in raw format or PNGs and additionally compare with reference data in raw format.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">python</span> <span class="n">nnir2openvx</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">argmax</span> <span class="n">lut</span><span class="o">-</span><span class="n">rgb</span><span class="o">.</span><span class="n">txt</span> <span class="n">nnirInputFolderFused</span> <span class="n">openvxCodeFolder</span>
<span class="o">%</span> <span class="n">mkdir</span> <span class="n">openvxCodeFolder</span><span class="o">/</span><span class="n">build</span>
<span class="o">%</span> <span class="n">cd</span> <span class="n">openvxCodeFolder</span><span class="o">/</span><span class="n">build</span>
<span class="o">%</span> <span class="n">cmake</span> <span class="o">..</span>
<span class="o">%</span> <span class="n">make</span>
<span class="o">%</span> <span class="o">./</span><span class="n">anntest</span>
</pre></div>
</div>
<p>Usage: anntest &lt;weights.bin&gt; [&lt;input-data-file(s)&gt; [&lt;output-data-file(s)&gt;]]]</p>
<blockquote>
<div><dl class="docutils">
<dt>&lt;input-data-file&gt;: is filename to initialize tensor</dt>
<dd><dl class="first docutils">
<dt>.jpg or .png: decode and initialize for 3 channel tensors</dt>
<dd>(use %04d in fileName to when batch-size &gt; 1: batch index starts from 0)</dd>
</dl>
<p class="last">other: initialize tensor with raw data from the file</p>
</dd>
<dt>&lt;output-data-file&gt;[,&lt;reference-for-compare&gt;,&lt;percentErrorLimit&gt;]:</dt>
<dd><p class="first">&lt;referece-to-compare&gt; is raw tensor data of LUT output for comparision
&lt;percentMismatchLimit&gt; is max mismatch (percentage) allowed
&lt;output-data-file&gt; is filename for saving output tensor data</p>
<blockquote class="last">
<div><dl class="docutils">
<dt>.png: save LUT output as PNG file(s)</dt>
<dd>(use %04d in fileName when batch-size &gt; 1: batch index starts from 0)</dd>
</dl>
<p>‘-‘ to ignore
other: save raw tensor into the file</p>
</div></blockquote>
</dd>
</dl>
</div></blockquote>
<p>% ./anntest ../weights.bin input-%04d.png output.rgb,reference.rgb,0.01
…
% ./anntest ../weights.bin input-%04d.png output-%04d.png,reference.rgb,0.01
…</p>
</div>
<div class="section" id="currently-supported">
<h4>Currently supported<a class="headerlink" href="#currently-supported" title="Permalink to this headline">¶</a></h4>
<p><strong>Models</strong></p>
<p>Support the below models from <a class="reference external" href="https://github.com/onnx/models">https://github.com/onnx/models</a></p>
<blockquote>
<div><ul class="simple">
<li>resnet</li>
<li>inception</li>
<li>alexnet</li>
<li>densenet</li>
<li>sqeezenet</li>
</ul>
</div></blockquote>
<p><strong>Operators</strong></p>
<p>Supported ONNX operators are:</p>
<blockquote>
<div><ul class="simple">
<li>Conv</li>
<li>Relu</li>
<li>MaxPool</li>
<li>AveragePool</li>
<li>GlobalAveragePool</li>
<li>LRN</li>
<li>BatchNormalization</li>
<li>Concat</li>
<li>Sum</li>
<li>Add</li>
<li>Sub</li>
<li>Mul</li>
<li>Softmax</li>
<li>Dropout</li>
</ul>
</div></blockquote>
<p><strong>License</strong></p>
<p>Copyright (c) 2018 Advanced Micro Devices, Inc. All rights reserved.</p>
<p>Use of this source code is governed by the MIT License that can be found in the LICENSE file.</p>
</div>
</div>
<div class="section" id="samples">
<h3>Samples<a class="headerlink" href="#samples" title="Permalink to this headline">¶</a></h3>
<p>MIVisionX samples using OpenVX and OpenVX extension libraries</p>
<div class="section" id="gdf-graph-description-format">
<h4>GDF - Graph Description Format<a class="headerlink" href="#gdf-graph-description-format" title="Permalink to this headline">¶</a></h4>
<p>MIVisionX samples using runvx with GDF</p>
<p><strong>skintonedetect.gdf</strong></p>
<p>usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">runvx</span> <span class="n">skintonedetect</span><span class="o">.</span><span class="n">gdf</span>
</pre></div>
</div>
<p><strong>canny.gdf</strong></p>
<p>usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">runvx</span> <span class="n">canny</span><span class="o">.</span><span class="n">gdf</span>
</pre></div>
</div>
<p><strong>skintonedetect-LIVE.gdf</strong></p>
<p>Using live camera</p>
<p>usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">runvx</span> <span class="o">-</span><span class="n">frames</span><span class="p">:</span><span class="n">live</span> <span class="n">skintonedetect</span><span class="o">-</span><span class="n">LIVE</span><span class="o">.</span><span class="n">gdf</span>
</pre></div>
</div>
<p><strong>canny-LIVE.gdf</strong></p>
<p>Using live camera</p>
<p>usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">runvx</span> <span class="o">-</span><span class="n">frames</span><span class="p">:</span><span class="n">live</span> <span class="n">canny</span><span class="o">-</span><span class="n">LIVE</span><span class="o">.</span><span class="n">gdf</span>
</pre></div>
</div>
<p><strong>OpenCV_orb-LIVE.gdf</strong></p>
<p>Using live camera</p>
<p>usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">runvx</span> <span class="o">-</span><span class="n">frames</span><span class="p">:</span><span class="n">live</span> <span class="n">OpenCV_orb</span><span class="o">-</span><span class="n">LIVE</span><span class="o">.</span><span class="n">gdf</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="mivisionx-toolkit">
<h3>MIVisionX Toolkit<a class="headerlink" href="#mivisionx-toolkit" title="Permalink to this headline">¶</a></h3>
<p>AMD MIVisionX Toolkit, is a comprehensive set of help tools for neural net creation, development, training and deployment. The Toolkit provides you with help tools to design, develop, quantize, prune, retrain, and infer your neural network work in any framework. The Toolkit is designed to help you deploy your work to any AMD or 3rd party hardware, from embedded to servers.</p>
<p>MIVisionX provides you with tools for accomplishing your tasks throughout the whole neural net life-cycle, from creating a model to deploying them for your target platforms.</p>
</div>
<div class="section" id="utilities">
<h3>Utilities<a class="headerlink" href="#utilities" title="Permalink to this headline">¶</a></h3>
<p>MIVisionX has utility applications which could be used by developers to test, quick prototype or develop sample applications.</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="https://gpuopen-professionalcompute-libraries.github.io/MIVisionX/utilities/inference_generator/#inference-generator">inference_generator</a> : generate inference library from pre-trained CAFFE models</li>
<li><a class="reference external" href="https://gpuopen-professionalcompute-libraries.github.io/MIVisionX/utilities/loom_shell/#radeon-loomsh">loom_shell</a> : an interpreter to prototype 360 degree video stitching applications using a script</li>
<li><a class="reference external" href="https://gpuopen-professionalcompute-libraries.github.io/MIVisionX/utilities/runvx/#amd-runvx">RunVX</a> : command-line utility to execute OpenVX graph described in GDF text file</li>
<li><a class="reference external" href="https://gpuopen-professionalcompute-libraries.github.io/MIVisionX/utilities/runcl/#amd-runcl">RunCL</a> : command-line utility to build, execute, and debug OpenCL programs</li>
</ul>
</div></blockquote>
<p>If you’re interested in Neural Network Inference, start with the sample cloud inference application in apps folder.</p>
<blockquote>
<div><img alt="../_images/block_diagram_inference_workflow.png" class="align-center" src="../_images/block_diagram_inference_workflow.png" />
</div></blockquote>
</div>
<div class="section" id="id19">
<h3>Pre-requisites<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li>CPU: SSE4.1 or above CPU, 64-bit</li>
<li><dl class="first docutils">
<dt>GPU: Radeon Instinct or Vega Family of Products (16GB recommended)</dt>
<dd><ul class="first last">
<li>Linux: install <a class="reference external" href="https://rocm.github.io/ROCmInstall.html">ROCm</a> with OpenCL development kit</li>
<li>Windows: install the latest drivers and OpenCL SDK <a class="reference external" href="https://github.com/GPUOpen-LibrariesAndSDKs/OCL-SDK/releases">download</a></li>
</ul>
</dd>
</dl>
</li>
<li>CMake 2.8 or newer <a class="reference external" href="cmake.org/download/">download</a></li>
<li>Qt Creator for <a class="reference external" href="https://gpuopen-professionalcompute-libraries.github.io/MIVisionX/apps/cloud_inference/client_app/">annInferenceApp</a></li>
<li><dl class="first docutils">
<dt><a class="reference external" href="https://github.com/protocolbuffers/protobuf">protobuf</a> for <a class="reference external" href="https://gpuopen-professionalcompute-libraries.github.io/MIVisionX/utilities/inference_generator/#inference-generator">inference_generator</a></dt>
<dd><ul class="first last">
<li>install libprotobuf-dev and protobuf-compiler needed for vx_nn</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>OpenCV 3 (optional) <a class="reference external" href="https://github.com/opencv/opencv/releases">download</a> for vx_opencv</dt>
<dd><ul class="first last">
<li>Set OpenCV_DIR environment variable to OpenCV/build folder</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<div class="section" id="pre-requisites-setup-script-mivisionx-setup-py">
<h4>Pre-requisites setup script - MIVisionX-setup.py<a class="headerlink" href="#pre-requisites-setup-script-mivisionx-setup-py" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="prerequisites-for-running-the-scripts">
<h4>Prerequisites for running the scripts<a class="headerlink" href="#prerequisites-for-running-the-scripts" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><ul class="simple">
<li>ubuntu 16.04/18.04</li>
<li>ROCm supported hardware</li>
<li>ROCm</li>
</ul>
</div></blockquote>
<p><strong>MIVisionX-setup.py</strong>- This scipts builds all the prerequisites required by MIVisionX. The setup script creates a deps folder and installs all the prerequisites, this script only needs to be executed once. If -d option for directory is not given the script will install deps folder in ‘~/’ directory by default, else in the user specified folder.</p>
<p>usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">MIVisionX</span><span class="o">-</span><span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">s</span> <span class="p">[</span><span class="n">sudo</span> <span class="n">password</span> <span class="o">-</span> <span class="n">required</span><span class="p">]</span> <span class="o">-</span><span class="n">d</span> <span class="p">[</span><span class="n">setup</span> <span class="n">directory</span> <span class="o">-</span> <span class="n">optional</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span><span class="o">~/</span><span class="p">)]</span> <span class="o">-</span><span class="n">m</span> <span class="p">[</span><span class="n">MIOpen</span> <span class="n">Version</span> <span class="o">-</span> <span class="n">optional</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span><span class="mf">1.6</span><span class="o">.</span><span class="mi">0</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="build-mivisionx">
<h3>Build MIVisionX<a class="headerlink" href="#build-mivisionx" title="Permalink to this headline">¶</a></h3>
<div class="section" id="build-using-cmake-on-linux-ubuntu-16-04-64-bit-with-rocm">
<h4>Build using CMake on Linux (Ubuntu 16.04 64-bit) with ROCm<a class="headerlink" href="#build-using-cmake-on-linux-ubuntu-16-04-64-bit-with-rocm" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><ul class="simple">
<li>Install <a class="reference external" href="https://rocm.github.io/ROCmInstall.html">ROCm</a></li>
<li><dl class="first docutils">
<dt>git clone, build and install other ROCm projects (using cmake and % make install) in the below order for vx_nn.</dt>
<dd><ul class="first last">
<li><a class="reference external" href="https://github.com/RadeonOpenCompute/rocm-cmake">rocm-cmake</a></li>
<li><a class="reference external" href="https://github.com/ROCmSoftwarePlatform/MIOpenGEMM">MIOpenGEMM</a></li>
<li><a class="reference external" href="https://github.com/ROCmSoftwarePlatform/MIOpen">MIOpen</a> – make sure to use -DMIOPEN_BACKEND=OpenCL option with cmake</li>
</ul>
</dd>
</dl>
</li>
<li>install <a class="reference external" href="https://github.com/protocolbuffers/protobuf/releases/tag/v3.5.2">protobuf</a></li>
<li>install <a class="reference external" href="https://github.com/opencv/opencv/releases/tag/3.3.0">OpenCV</a></li>
<li>git clone this project using –recursive option so that correct branch of the deps project is cloned automatically.</li>
<li><dl class="first docutils">
<dt>build and install (using cmake and % make install)</dt>
<dd><ul class="first last">
<li>executables will be placed in bin folder</li>
<li>libraries will be placed in lib folder</li>
<li>the installer will copy all executables into /opt/rocm/mivisionx/bin and libraries into /opt/rocm/lib</li>
<li>the installer also copies all the OpenVX and module header files into /opt/rocm/mivisionx/include folder</li>
</ul>
</dd>
</dl>
</li>
<li>add the installed library path to LD_LIBRARY_PATH environment variable (default /opt/rocm/mivisionx/lib)</li>
<li>add the installed executable path to PATH environment variable (default /opt/rocm/mivisionx/bin)</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="build-anninferenceapp-using-qt-creator">
<h4>Build annInferenceApp using Qt Creator<a class="headerlink" href="#build-anninferenceapp-using-qt-creator" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><ul class="simple">
<li>build <a class="reference external" href="https://gpuopen-professionalcompute-libraries.github.io/MIVisionX/apps/cloud_inference/client_app/annInferenceApp.pro">annInferenceApp.pro</a> using Qt Creator</li>
<li>or use <a class="reference external" href="https://gpuopen-professionalcompute-libraries.github.io/MIVisionX/apps/cloud_inference/client_app/annInferenceApp.py">annInferenceApp.py</a> for simple tests</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="build-radeon-loom-using-visual-studio-professional-2013-on-64-bit-windows-10-8-1-7">
<h4>Build Radeon LOOM using Visual Studio Professional 2013 on 64-bit Windows 10/8.1/7<a class="headerlink" href="#build-radeon-loom-using-visual-studio-professional-2013-on-64-bit-windows-10-8-1-7" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><ul class="simple">
<li>Use <a class="reference external" href="https://gpuopen-professionalcompute-libraries.github.io/MIVisionX/amd_openvx_extensions/amd_loomsl/vx_loomsl.sln">loom.sln</a> to build x64 platform</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="docker">
<h3>Docker<a class="headerlink" href="#docker" title="Permalink to this headline">¶</a></h3>
<p>MIVisionX provides developers with docker images for Ubuntu 16.04, Ubuntu 18.04, CentOS 7.5, &amp; CentOS 7.6. Using docker images developers can quickly prototype and build applications without having to be locked into a single system setup or lose valuable time figuring out the dependencies of the underlying software.</p>
<div class="section" id="mivisionx-docker">
<h4>MIVisionX Docker<a class="headerlink" href="#mivisionx-docker" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="https://hub.docker.com/r/kiritigowda/mivisionx-ubuntu-16.04">Ubuntu 16.04</a></li>
<li><a class="reference external" href="https://hub.docker.com/r/kiritigowda/mivisionx-ubuntu-18.04">Ubuntu 18.04</a></li>
<li><a class="reference external" href="https://hub.docker.com/r/kiritigowda/centos">CentOS 7.5</a></li>
<li><a class="reference external" href="https://hub.docker.com/r/kiritigowda/centos">CentOS 7.6</a></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="docker-workflow-sample-on-ubuntu-16-04">
<h4>Docker Workflow Sample on Ubuntu 16.04<a class="headerlink" href="#docker-workflow-sample-on-ubuntu-16-04" title="Permalink to this headline">¶</a></h4>
<p><strong>Prerequisites</strong></p>
<blockquote>
<div><ul class="simple">
<li>Ubuntu 16.04</li>
<li><a class="reference external" href="https://rocm.github.io/hardware.html">rocm supported hardware</a></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="workflow">
<h4>Workflow<a class="headerlink" href="#workflow" title="Permalink to this headline">¶</a></h4>
<p><strong>Step 1 - Install rocm-dkms</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">update</span>
<span class="n">sudo</span> <span class="n">apt</span> <span class="n">dist</span><span class="o">-</span><span class="n">upgrade</span>
<span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">libnuma</span><span class="o">-</span><span class="n">dev</span>
<span class="n">sudo</span> <span class="n">reboot</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="o">-</span><span class="n">qO</span> <span class="o">-</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">repo</span><span class="o">.</span><span class="n">radeon</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">rocm</span><span class="o">/</span><span class="n">apt</span><span class="o">/</span><span class="n">debian</span><span class="o">/</span><span class="n">rocm</span><span class="o">.</span><span class="n">gpg</span><span class="o">.</span><span class="n">key</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">key</span> <span class="n">add</span> <span class="o">-</span>
<span class="n">echo</span> <span class="s1">&#39;deb [arch=amd64] http://repo.radeon.com/rocm/apt/debian/ xenial main&#39;</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">tee</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apt</span><span class="o">/</span><span class="n">sources</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">rocm</span><span class="o">.</span><span class="n">list</span>
<span class="n">sudo</span> <span class="n">apt</span> <span class="n">update</span>
<span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">rocm</span><span class="o">-</span><span class="n">dkms</span>
<span class="n">sudo</span> <span class="n">reboot</span>
</pre></div>
</div>
<p><strong>Step 2 - Setup Docker</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">curl</span>
<span class="n">sudo</span> <span class="n">curl</span> <span class="o">-</span><span class="n">fsSL</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">download</span><span class="o">.</span><span class="n">docker</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">linux</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">gpg</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">key</span> <span class="n">add</span> <span class="o">-</span>
<span class="n">sudo</span> <span class="n">add</span><span class="o">-</span><span class="n">apt</span><span class="o">-</span><span class="n">repository</span> <span class="s2">&quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable&quot;</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span>
<span class="n">apt</span><span class="o">-</span><span class="n">cache</span> <span class="n">policy</span> <span class="n">docker</span><span class="o">-</span><span class="n">ce</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">docker</span><span class="o">-</span><span class="n">ce</span>
<span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">status</span> <span class="n">docker</span>
</pre></div>
</div>
<p><strong>Step 3 - Get Docker Image</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">docker</span> <span class="n">pull</span> <span class="n">kiritigowda</span><span class="o">/</span><span class="n">mivisionx</span><span class="o">-</span><span class="n">ubuntu</span><span class="o">-</span><span class="mf">16.04</span>
</pre></div>
</div>
<p><strong>Step 4 - Run the docker image</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">it</span> <span class="o">--</span><span class="n">device</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">kfd</span> <span class="o">--</span><span class="n">device</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">dri</span> <span class="o">--</span><span class="n">cap</span><span class="o">-</span><span class="n">add</span><span class="o">=</span><span class="n">SYS_RAWIO</span> <span class="o">--</span><span class="n">device</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">mem</span> <span class="o">--</span><span class="n">group</span><span class="o">-</span><span class="n">add</span> <span class="n">video</span> <span class="o">--</span><span class="n">network</span> <span class="n">host</span> <span class="n">kiritigowda</span><span class="o">/</span><span class="n">mivisionx</span><span class="o">-</span><span class="n">ubuntu</span><span class="o">-</span><span class="mf">16.04</span>

<span class="o">*</span> <span class="n">Optional</span><span class="p">:</span> <span class="n">Map</span> <span class="n">localhost</span> <span class="n">directory</span> <span class="n">on</span> <span class="n">the</span> <span class="n">docker</span> <span class="n">image</span>
   <span class="o">*</span> <span class="n">option</span> <span class="n">to</span> <span class="nb">map</span> <span class="n">the</span> <span class="n">localhost</span> <span class="n">directory</span> <span class="k">with</span> <span class="n">trained</span> <span class="n">caffe</span> <span class="n">models</span> <span class="n">to</span> <span class="n">be</span> <span class="n">accessed</span> <span class="n">on</span> <span class="n">the</span> <span class="n">docker</span> <span class="n">image</span><span class="o">.</span>
   <span class="o">*</span> <span class="n">usage</span><span class="p">:</span> <span class="o">-</span><span class="n">v</span> <span class="p">{</span><span class="n">LOCAL_HOST_DIRECTORY_PATH</span><span class="p">}:{</span><span class="n">DOCKER_DIRECTORY_PATH</span><span class="p">}</span>
    <span class="p">::</span>

     <span class="n">sudo</span> <span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">it</span> <span class="o">-</span><span class="n">v</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="p">:</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">hostDrive</span><span class="o">/</span> <span class="o">--</span><span class="n">device</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">kfd</span> <span class="o">--</span><span class="n">device</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">dri</span> <span class="o">--</span><span class="n">cap</span><span class="o">-</span><span class="n">add</span><span class="o">=</span><span class="n">SYS_RAWIO</span> <span class="o">--</span><span class="n">device</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">mem</span> <span class="o">--</span><span class="n">group</span><span class="o">-</span><span class="n">add</span> <span class="n">video</span> <span class="o">--</span><span class="n">network</span> <span class="n">host</span> <span class="n">kiritigowda</span><span class="o">/</span><span class="n">mivisionx</span><span class="o">-</span><span class="n">ubuntu</span><span class="o">-</span><span class="mf">16.04</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="release-notes">
<h3>Release Notes<a class="headerlink" href="#release-notes" title="Permalink to this headline">¶</a></h3>
<div class="section" id="supported-neural-net-layers">
<h4>Supported Neural Net Layers<a class="headerlink" href="#supported-neural-net-layers" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Layer</span> <span class="n">name</span>
<span class="n">Activation</span>
<span class="n">Argmax</span>
<span class="n">Batch</span> <span class="n">Normalization</span>
<span class="n">Concat</span>
<span class="n">Convolution</span>
<span class="n">Deconvolution</span>
<span class="n">Fully</span> <span class="n">Connected</span>
<span class="n">Local</span> <span class="n">Response</span> <span class="n">Normalization</span> <span class="p">(</span><span class="n">LRN</span><span class="p">)</span>
<span class="n">Pooling</span>
<span class="n">Scale</span>
<span class="n">Slice</span>
<span class="n">Softmax</span>
<span class="n">Tensor</span> <span class="n">Add</span>
<span class="n">Tensor</span> <span class="n">Convert</span> <span class="n">Depth</span>
<span class="n">Tensor</span> <span class="n">Convert</span> <span class="kn">from</span> <span class="nn">Image</span>
<span class="n">Tensor</span> <span class="n">Convert</span> <span class="n">to</span> <span class="n">Image</span>
<span class="n">Tensor</span> <span class="n">Multiply</span>
<span class="n">Tensor</span> <span class="n">Subtract</span>
<span class="n">Upsample</span> <span class="n">Nearest</span> <span class="n">Neighborhood</span>
</pre></div>
</div>
</div>
<div class="section" id="id27">
<h4>Known issues<a class="headerlink" href="#id27" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><ul class="simple">
<li>ROCm - 1.8.151 performance degradation</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="tested-configurations">
<h4>Tested configurations<a class="headerlink" href="#tested-configurations" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><ul class="simple">
<li>Linux: Ubuntu - 16.04/18.04 &amp; CentOS - 7.5/7.6</li>
<li>ROCm: rocm-dkms - 1.9.307</li>
<li>rocm-cmake - github master:ac45c6e</li>
<li>MIOpenGEMM - 1.1.5</li>
<li>MIOpen - 1.6.0</li>
<li>Protobuf - V3.5.2</li>
<li>OpenCV - 3.3.0</li>
<li>Dependencies for all the above packages</li>
</ul>
</div></blockquote>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../ROCm_Libraries/ROCm_Libraries.html" class="btn btn-neutral float-right" title="ROCm Libraries" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../ROCm_API_References/ROCm-API-References.html" class="btn btn-neutral" title="ROCm API References" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Thomas Edvalson.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>