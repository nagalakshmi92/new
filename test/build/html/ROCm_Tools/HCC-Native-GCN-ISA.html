

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>HCC-Native-GCN-ISA &mdash; ReadTheDocs-Breathe 1.0.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> ReadTheDocs-Breathe
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../ROCm.html">Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Current_Release_Notes/Current-Release-Notes.html">Current Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Installation_Guide/Installation-Guide.html">ROCm Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Programming_Guides/Programming-Guides.html">Programming Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ROCm_GPU_Tunning_Guides/ROCm-GPU-Tunning-Guides.html">ROCm GPU Tuning Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GCN_ISA_Manuals/GCN-ISA-Manuals.html">GCN ISA Manuals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ROCm_API_References/ROCm-API-References.html">ROCm API References</a></li>
<li class="toctree-l1"><a class="reference internal" href="ROCm-Tools.html">ROCm Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ROCm_Libraries/ROCm_Libraries.html">ROCm Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ROCm_Compiler_SDK/ROCm-Compiler-SDK.html">ROCm Compiler SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ROCm_System_Managment/ROCm-System-Managment.html">ROCm System Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ROCm_Virtualization_Containers/ROCm-Virtualization-&amp;-Containers.html">ROCm Virtualization &amp; Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Remote_Device_Programming/Remote-Device-Programming.html">Remote Device Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Deep_learning/Deep-learning.html">Deep Learning on ROCm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Other_Solutions/Other-Solutions.html">System Level Debug</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorial/Tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ROCm_Glossary/ROCm-Glossary.html">ROCm Glossary</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ReadTheDocs-Breathe</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>HCC-Native-GCN-ISA</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/ROCm_Tools/HCC-Native-GCN-ISA.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="hcc-native-gcn-isa">
<span id="id1"></span><h1>HCC-Native-GCN-ISA<a class="headerlink" href="#hcc-native-gcn-isa" title="Permalink to this headline">¶</a></h1>
<div class="section" id="hardware-requirements">
<h2>Hardware Requirements<a class="headerlink" href="#hardware-requirements" title="Permalink to this headline">¶</a></h2>
<p>See the “Target Platform Supported” section <a class="reference external" href="http://rocm-documentation.readthedocs.io/en/latest/Installation_Guide/Installation-Guide.html#system-requirement">here</a>.</p>
<p>Note that the instructions on this wiki are for installing on a system with a Fiji GPU. If you are interested in learning how to setup hcc for other supported GPU targets, please file an <a class="reference external" href="https://github.com/RadeonOpenCompute/HCC-Native-GCN-ISA/issues">Issue</a>.</p>
</div>
<div class="section" id="installing-compiler-packages">
<h2>Installing compiler packages:<a class="headerlink" href="#installing-compiler-packages" title="Permalink to this headline">¶</a></h2>
<p>If you want to install the latest stable version of the hcc compiler with native GCN ISA support, you should follow the instructions here. If you want to build from source, follow the directions below.</p>
</div>
<div class="section" id="building-compiler-from-source">
<h2>Building compiler from source:<a class="headerlink" href="#building-compiler-from-source" title="Permalink to this headline">¶</a></h2>
<p><strong>Software Dependencies</strong></p>
<p><strong>Ubuntu</strong></p>
<p>Follow the instructions found <a class="reference external" href="http://rocm-documentation.readthedocs.io/en/latest/Installation_Guide/Installation-Guide.html#">here</a> to setup the apt repository.</p>
<p>Installing on the ROC kernel, the development files of the thunk library and the runtime:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">rocm</span><span class="o">-</span><span class="n">kernel</span> <span class="n">hsakmt</span><span class="o">-</span><span class="n">roct</span><span class="o">-</span><span class="n">dev</span> <span class="n">hsa</span><span class="o">-</span><span class="n">rocr</span><span class="o">-</span><span class="n">dev</span>
</pre></div>
</div>
<p>Reboot the system with the new kernel and make sure the verify the installation with the <a class="reference external" href="https://github.com/RadeonOpenCompute/ROCm#verify-installation">vector copy sample</a>.</p>
<p>If you have previously installed any version of the hcc compiler, then it is recommended to uninstall them:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">purge</span> <span class="n">hcc_lc</span> <span class="n">hcc_hsail</span>
</pre></div>
</div>
<p>Then install all other dependencies in order to build HCC from source:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">cmake</span> <span class="n">git</span> <span class="n">libelf</span><span class="o">-</span><span class="n">dev</span> <span class="n">libc</span><span class="o">++</span><span class="n">abi</span><span class="o">-</span><span class="n">dev</span> <span class="n">libc</span><span class="o">++-</span><span class="n">dev</span> <span class="n">libdwarf</span><span class="o">-</span><span class="n">dev</span> <span class="n">re2c</span> <span class="n">libncurses5</span><span class="o">-</span><span class="n">dev</span> <span class="n">patch</span> <span class="n">wget</span> <span class="n">file</span> <span class="n">xz</span><span class="o">-</span><span class="n">utils</span>         <span class="n">libc6</span><span class="o">-</span> <span class="n">dev</span><span class="o">-</span><span class="n">i386</span> <span class="n">python</span> <span class="n">build</span><span class="o">-</span><span class="n">essential</span>
</pre></div>
</div>
<p><strong>CMake</strong></p>
<p>If you are using Ubuntu 14.04, you would also need to upgrade to a newer version (&gt;=3.0) of CMake as the version distributed by the distro is old for building clang/llvm.</p>
<p><strong>Fedora</strong></p>
<p>Follow the instructions found <a class="reference external" href="https://github.com/RadeonOpenCompute/ROCm#rpm-repository---dnf-yum">here</a> to setup the rpm repository.</p>
<p>Installing on the ROC kernel, the development files of the thunk library and the runtime:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">dnf</span> <span class="n">install</span> <span class="n">rocm</span><span class="o">-</span><span class="n">kernel</span> <span class="n">hsakmt</span><span class="o">-</span><span class="n">roct</span><span class="o">-</span><span class="n">dev</span> <span class="n">hsa</span><span class="o">-</span><span class="n">rocr</span><span class="o">-</span><span class="n">dev</span>
</pre></div>
</div>
<p>Reboot the system with the new kernel and make sure the verify the installation with the <a class="reference external" href="https://github.com/RadeonOpenCompute/ROCm#verify-installation">vector copy sample</a>.</p>
<p>If you have previously installed any version of the hcc compiler, thne it is recommended to uninstall them:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">dnf</span> <span class="n">remove</span> <span class="n">hcc_lc</span> <span class="n">hcc_hsail</span>
</pre></div>
</div>
<p>Then install all other dependencies in order to build HCC from source:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">dnf</span> <span class="n">install</span> <span class="n">cmake</span> <span class="n">make</span> <span class="n">git</span> <span class="n">gcc</span><span class="o">-</span><span class="n">c</span><span class="o">++</span> <span class="n">libstdc</span><span class="o">++-</span><span class="n">devel</span> <span class="n">libdwarf</span><span class="o">-</span><span class="n">devel</span> <span class="n">elfutils</span><span class="o">-</span><span class="n">libelf</span><span class="o">-</span><span class="n">devel</span> <span class="n">re2c</span> <span class="n">ncurses</span><span class="o">-</span><span class="n">devel</span> <span class="n">patch</span> <span class="n">wget</span> <span class="n">file</span> <span class="n">tar</span>   <span class="n">xz</span> <span class="n">glibc</span><span class="o">-</span><span class="n">devel</span><span class="o">.</span><span class="n">i686</span> <span class="n">python</span> <span class="n">rpmdevtools</span>
</pre></div>
</div>
<p>Install other development tools:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">dnf</span> <span class="n">groupinstall</span> <span class="s2">&quot;Development Tools&quot;</span>
</pre></div>
</div>
<p><strong>libc++ &amp; libc++abi</strong></p>
<p>HCC has a dependency on libc++ and libc++abi; however, Fedora/RHEL/CentOS don’t provide a working binary package so you will to build them from source by following the instructions <a class="reference external" href="http://rocm-documentation.readthedocs.io/en/latest/ROCm_Tools/ROCm-Tools.html#hcc">here</a></p>
<p><strong>CentOS/RHEL</strong></p>
<p>Follow the instructions found <a class="reference external" href="http://rocm-documentation.readthedocs.io/en/latest/Installation_Guide/Installation-Guide.html#installation-guide-fedora">here</a> to setup the rpm repository.</p>
<p>Installing on the ROC kernel, the development files of the thunk library and the runtime:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">rocm</span><span class="o">-</span><span class="n">kernel</span> <span class="n">hsakmt</span><span class="o">-</span><span class="n">roct</span><span class="o">-</span><span class="n">dev</span> <span class="n">hsa</span><span class="o">-</span><span class="n">rocr</span><span class="o">-</span><span class="n">dev</span>
</pre></div>
</div>
<p>Reboot the system with the new kernel and make sure the verify the installation with the <a class="reference external" href="https://github.com/RadeonOpenCompute/ROCm#verify-installation">vector copy sample</a>.</p>
<p>Then install</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">cmake</span> <span class="n">make</span> <span class="n">git</span> <span class="n">gcc</span><span class="o">-</span><span class="n">c</span><span class="o">++</span> <span class="n">libstdc</span><span class="o">++-</span><span class="n">devel</span> <span class="n">libdwarf</span><span class="o">-</span><span class="n">devel</span> <span class="n">elfutils</span><span class="o">-</span><span class="n">libelf</span><span class="o">-</span><span class="n">devel</span> <span class="n">re2c</span> <span class="n">ncurses</span><span class="o">-</span><span class="n">devel</span> <span class="n">patch</span> <span class="n">wget</span> <span class="n">file</span> <span class="n">tar</span>   <span class="n">xz</span> <span class="n">glibc</span><span class="o">-</span><span class="n">devel</span><span class="o">.</span><span class="n">i686</span> <span class="n">python</span> <span class="n">rpmdevtools</span> <span class="n">clang</span>
<span class="n">sudo</span> <span class="n">yum</span> <span class="n">groupinstall</span> <span class="s2">&quot;Development Tools&quot;</span>
</pre></div>
</div>
<p><strong>CMake</strong></p>
<p>The CMake version from CentOS 7 and RedHat 7 is too old and it doesn’t meet the minimum requirement for building LLVM and Clang. You’ll need to upgrade to newer verison of <a class="reference external" href="https://cmake.org/">CMake</a>.</p>
<p><strong>libc++ &amp; libc++abi</strong></p>
<p>On Ubuntu 14.04, HCC has a dependency on libc++; however, the current libc++ package from the distro has an unmet dependency on libc++abi. Users will have to build libc++ and libc++abi from source with Clang.</p>
<p>It is recommended to install the release_36 release of libc++ and libc++abi and here are the instructions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="o">--</span><span class="n">branch</span> <span class="n">release_36</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">llvm</span><span class="o">-</span><span class="n">mirror</span><span class="o">/</span><span class="n">llvm</span><span class="o">.</span><span class="n">git</span> <span class="n">llvm</span>
<span class="n">git</span> <span class="n">clone</span> <span class="o">--</span><span class="n">branch</span> <span class="n">release_36</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">llvm</span><span class="o">-</span><span class="n">mirror</span><span class="o">/</span><span class="n">libcxx</span><span class="o">.</span><span class="n">git</span> <span class="n">llvm</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">libcxx</span>
<span class="n">git</span> <span class="n">clone</span> <span class="o">--</span><span class="n">branch</span> <span class="n">release_36</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">llvm</span><span class="o">-</span><span class="n">mirror</span><span class="o">/</span><span class="n">libcxxabi</span><span class="o">.</span><span class="n">git</span> <span class="n">llvm</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">libcxxabi</span>
<span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="n">llvm</span><span class="o">/</span><span class="n">build</span>
<span class="n">cd</span> <span class="n">llvm</span><span class="o">/</span><span class="n">build</span>
<span class="n">cmake</span> <span class="o">-</span><span class="n">DCMAKE_BUILD_TYPE</span><span class="o">=</span><span class="n">Release</span> <span class="o">-</span><span class="n">DCMAKE_C_COMPILER</span><span class="o">=</span><span class="n">clang</span> <span class="o">-</span><span class="n">DCMAKE_CXX_COMPILER</span><span class="o">=</span><span class="n">clang</span><span class="o">++</span>  <span class="o">..</span>
<span class="n">make</span>
<span class="n">cd</span> <span class="n">projects</span><span class="o">/</span><span class="n">libcxx</span>
<span class="n">sudo</span> <span class="n">make</span> <span class="n">install</span>
<span class="n">cd</span> <span class="o">../</span><span class="n">libcxxabi</span>
<span class="n">sudo</span> <span class="n">make</span> <span class="n">install</span>
</pre></div>
</div>
<p>Add the libc++ and libc++abi installation path to the library search paths
(i.e. export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/lib )</p>
</div>
<div class="section" id="getting-the-hcc-source-code">
<h2>Getting the HCC Source Code<a class="headerlink" href="#getting-the-hcc-source-code" title="Permalink to this headline">¶</a></h2>
<p><strong>Fetching the HCC source code with the repo tool</strong></p>
<p><strong>Installing the repo tool</strong></p>
<p>If you are unable to find a distribution package for repo, you can follow the installation instructions here.</p>
<p><strong>Initialize the Workspace</strong></p>
<p>Create a workspace for holding the code and all the repo metadata. Replace &lt;_branch_&gt; with a branch name selected from above.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="n">hcc</span>
<span class="n">cd</span> <span class="n">hcc</span>
<span class="n">repo</span> <span class="n">init</span> <span class="o">-</span><span class="n">u</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">RadeonOpenCompute</span><span class="o">/</span><span class="n">HCC</span><span class="o">-</span><span class="n">Native</span><span class="o">-</span><span class="n">GCN</span><span class="o">-</span><span class="n">ISA</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<p>Fetch the source code</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">repo</span> <span class="n">sync</span>
</pre></div>
</div>
<p><strong>Build Instructions</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="n">hcc</span><span class="o">/</span><span class="n">build</span>
<span class="n">cd</span> <span class="n">hcc</span><span class="o">/</span><span class="n">build</span>

<span class="c1">### Substitute &lt;_distro_&gt; with ubuntu for Ubuntu or with fedora for Fedora/CentOS/RHEL</span>
<span class="n">cmake</span> <span class="o">..</span> \
<span class="o">-</span><span class="n">DDISTRO</span><span class="o">=&lt;</span><span class="n">_distro_</span><span class="o">&gt;</span>

<span class="n">make</span>

<span class="c1"># optional step to build binary packages for distribution</span>
<span class="n">make</span> <span class="n">package</span>

<span class="n">cd</span> <span class="o">../..</span>
</pre></div>
</div>
<p><strong>Verifying the Build</strong></p>
<p>To verify that you have set up your system correctly, run one of the C++ AMP conformance tests. If you have done things correctly, it should pass:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">hcc</span><span class="o">/</span><span class="n">build</span>
<span class="n">perl</span> <span class="n">amp</span><span class="o">-</span><span class="n">conformance</span><span class="o">/</span><span class="n">test_one</span><span class="o">.</span><span class="n">pl</span> <span class="o">../</span><span class="n">amp</span><span class="o">-</span><span class="n">conformance</span><span class="o">/</span> <span class="o">../</span><span class="n">amp</span><span class="o">-</span><span class="n">conformance</span><span class="o">/</span><span class="n">Tests</span><span class="o">/</span><span class="mi">4</span><span class="n">_Basic_Data_Elmnts</span><span class="o">/</span><span class="mi">4</span><span class="n">_1_index</span><span class="o">/</span><span class="mi">4</span><span class="n">_1_2_c</span><span class="o">/</span><span class="n">Copy</span><span class="o">/</span><span class="n">Test</span><span class="o">.</span><span class="mi">01</span><span class="o">/</span>     <span class="n">test</span><span class="o">.</span><span class="n">cpp</span>
</pre></div>
</div>
<p>You could also run the HCC’s sanity test</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">test</span>
</pre></div>
</div>
<p><strong>Install the Compiler</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">make</span> <span class="n">install</span>
</pre></div>
</div>
<p>Or alternatively, you could generate a .deb or .rpm package</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">package</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Thomas Edvalson.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>