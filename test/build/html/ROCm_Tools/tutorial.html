

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>tutorial &mdash; ReadTheDocs-Breathe 1.0.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> ReadTheDocs-Breathe
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../ROCm.html">Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Current_Release_Notes/Current-Release-Notes.html">Current Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Installation_Guide/Installation-Guide.html">ROCm Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Programming_Guides/Programming-Guides.html">Programming Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ROCm_GPU_Tunning_Guides/ROCm-GPU-Tunning-Guides.html">ROCm GPU Tuning Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GCN_ISA_Manuals/GCN-ISA-Manuals.html">GCN ISA Manuals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ROCm_API_References/ROCm-API-References.html">ROCm API References</a></li>
<li class="toctree-l1"><a class="reference internal" href="ROCm-Tools.html">ROCm Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ROCm_Libraries/ROCm_Libraries.html">ROCm Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ROCm_Compiler_SDK/ROCm-Compiler-SDK.html">ROCm Compiler SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ROCm_System_Managment/ROCm-System-Managment.html">ROCm System Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ROCm_Virtualization_Containers/ROCm-Virtualization-&amp;-Containers.html">ROCm Virtualization &amp; Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Remote_Device_Programming/Remote-Device-Programming.html">Remote Device Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Deep_learning/Deep-learning.html">Deep Learning on ROCm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Other_Solutions/Other-Solutions.html">System Level Debug</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorial/Tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ROCm_Glossary/ROCm-Glossary.html">ROCm Glossary</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ReadTheDocs-Breathe</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>tutorial</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/ROCm_Tools/tutorial.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tutorial">
<span id="id1"></span><h1>tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h1>
<div class="section" id="how-do-i-debug-my-gpu-application">
<h2>How do I debug my GPU application?<a class="headerlink" href="#how-do-i-debug-my-gpu-application" title="Permalink to this headline">¶</a></h2>
<p>You can start your program in rocm-gdb just like you would any application under gdb</p>
<blockquote>
<div><ul class="simple">
<li>rocm-gdb MatrixMul</li>
<li>You should now be in the gdb prompt and can start execution of the application</li>
<li>(ROCm-gdb) start</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="how-do-i-view-the-list-of-all-rocm-gdb-commands">
<h2>How do I view the list of all ROCm gdb commands?<a class="headerlink" href="#how-do-i-view-the-list-of-all-rocm-gdb-commands" title="Permalink to this headline">¶</a></h2>
<p>To view the list of all rocm related gdb commands, you can type :: help rocm.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">ROCm</span><span class="o">-</span><span class="n">gdb</span><span class="p">)</span> <span class="n">help</span> <span class="n">rocm</span>
<span class="n">ROCm</span> <span class="n">specific</span> <span class="n">features</span> <span class="ow">in</span> <span class="n">ROCm</span><span class="o">-</span><span class="n">gdb</span><span class="o">.</span>
<span class="o">--------------------------------------------------------------------------</span>
<span class="n">ROCm</span> <span class="n">focus</span> <span class="n">thread</span> <span class="n">command</span><span class="p">:</span>
<span class="n">rocm</span> <span class="n">thread</span> <span class="n">wg</span><span class="p">:</span><span class="o">&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="n">wi</span><span class="p">:</span><span class="o">&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span>  <span class="n">Switch</span> <span class="n">focus</span> <span class="n">to</span> <span class="n">a</span> <span class="n">specific</span> <span class="n">active</span> <span class="n">GPU</span> <span class="n">work</span><span class="o">-</span><span class="n">item</span>
<span class="o">--------------------------------------------------------------------------</span>
<span class="n">ROCm</span> <span class="n">breakpoint</span> <span class="n">commands</span><span class="p">:</span>
<span class="k">break</span> <span class="n">rocm</span>                         <span class="n">Break</span> <span class="n">on</span> <span class="n">every</span> <span class="n">GPU</span> <span class="n">dispatch</span>
<span class="k">break</span> <span class="n">rocm</span><span class="p">:</span><span class="o">&lt;</span><span class="n">kernel_name</span><span class="o">&gt;</span>           <span class="n">Break</span> <span class="n">when</span> <span class="n">kernel</span> <span class="o">&lt;</span><span class="n">kernel_name</span><span class="o">&gt;</span> <span class="ow">is</span> <span class="n">about</span> <span class="n">to</span> <span class="n">begin</span> <span class="n">execution</span>
<span class="k">break</span> <span class="n">rocm</span><span class="p">:</span><span class="o">&lt;</span><span class="n">line_number</span><span class="o">&gt;</span>           <span class="n">Break</span> <span class="n">when</span> <span class="n">execution</span> <span class="n">hits</span> <span class="n">line</span> <span class="o">&lt;</span><span class="n">line_number</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="n">temp_source</span>
<span class="o">--------------------------------------------------------------------------</span>
<span class="n">ROCm</span> <span class="n">info</span> <span class="n">commands</span><span class="p">:</span>
<span class="n">info</span> <span class="n">rocm</span> <span class="n">devices</span>                 <span class="n">Print</span> <span class="nb">all</span> <span class="n">available</span> <span class="n">GPU</span> <span class="n">devices</span>
<span class="n">info</span> <span class="n">rocm</span> <span class="n">kernels</span>                  <span class="n">Print</span> <span class="nb">all</span> <span class="n">GPU</span> <span class="n">kernel</span> <span class="n">dispatches</span>
<span class="n">info</span> <span class="n">rocm</span> <span class="n">kernel</span> <span class="o">&lt;</span><span class="n">kernel_name</span><span class="o">&gt;</span>     <span class="n">Print</span> <span class="nb">all</span> <span class="n">GPU</span> <span class="n">kernel</span> <span class="n">dispatches</span> <span class="k">with</span> <span class="n">a</span> <span class="n">specific</span> <span class="o">&lt;</span><span class="n">kernel_name</span><span class="o">&gt;</span>
<span class="n">info</span> <span class="n">rocm</span> <span class="p">[</span><span class="n">work</span><span class="o">-</span><span class="n">groups</span><span class="o">|</span><span class="n">wgs</span><span class="p">]</span>        <span class="n">Print</span> <span class="nb">all</span> <span class="n">GPU</span> <span class="n">work</span><span class="o">-</span><span class="n">group</span> <span class="n">items</span>
<span class="n">info</span> <span class="n">rocm</span> <span class="p">[</span><span class="n">work</span><span class="o">-</span><span class="n">group</span><span class="o">|</span><span class="n">wg</span><span class="p">]</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">flattened_id</span><span class="o">&gt;|&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span><span class="p">]</span>  <span class="n">Print</span> <span class="n">a</span> <span class="n">specific</span> <span class="n">GPU</span> <span class="n">work</span><span class="o">-</span><span class="n">group</span> <span class="n">item</span>
<span class="n">info</span> <span class="n">rocm</span> <span class="p">[</span><span class="n">work</span><span class="o">-</span><span class="n">item</span><span class="o">|</span><span class="n">wi</span><span class="o">|</span><span class="n">work</span><span class="o">-</span><span class="n">items</span><span class="o">|</span><span class="n">wis</span><span class="p">]</span>             <span class="n">Print</span> <span class="n">the</span> <span class="n">focus</span> <span class="n">GPU</span> <span class="n">work</span><span class="o">-</span><span class="n">item</span>
<span class="n">info</span> <span class="n">rocm</span> <span class="p">[</span><span class="n">work</span><span class="o">-</span><span class="n">item</span><span class="o">|</span><span class="n">wi</span><span class="p">]</span> <span class="o">&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span>   <span class="n">Print</span> <span class="n">a</span> <span class="n">specific</span> <span class="n">GPU</span> <span class="n">work</span><span class="o">-</span><span class="n">item</span>
<span class="o">--------------------------------------------------------------------------</span>
<span class="n">ROCm</span> <span class="n">specific</span> <span class="n">configuration</span> <span class="n">commands</span><span class="p">:</span>
<span class="nb">set</span> <span class="n">rocm</span> <span class="n">trace</span> <span class="p">[</span><span class="n">on</span><span class="o">|</span><span class="n">off</span><span class="p">]</span>            <span class="n">Enable</span><span class="o">/</span><span class="n">Disable</span> <span class="n">tracing</span> <span class="n">of</span> <span class="n">GPU</span> <span class="n">dispatches</span>
<span class="nb">set</span> <span class="n">rocm</span> <span class="n">trace</span> <span class="o">&lt;</span><span class="n">filename</span><span class="o">&gt;</span>          <span class="n">Save</span> <span class="n">GPU</span> <span class="n">dispatch</span> <span class="n">trace</span> <span class="n">to</span> <span class="o">&lt;</span><span class="n">filename</span><span class="o">&gt;</span>
<span class="nb">set</span> <span class="n">rocm</span> <span class="n">logging</span> <span class="p">[</span><span class="n">on</span><span class="o">|</span><span class="n">off</span><span class="p">]</span>          <span class="n">Enable</span><span class="o">/</span><span class="n">Disable</span> <span class="n">internal</span> <span class="n">logging</span>
<span class="nb">set</span> <span class="n">rocm</span> <span class="n">show</span><span class="o">-</span><span class="n">isa</span> <span class="p">[</span><span class="n">on</span><span class="o">|</span><span class="n">off</span><span class="p">]</span>         <span class="n">Enable</span><span class="o">/</span><span class="n">Disable</span> <span class="n">saving</span> <span class="n">ISA</span> <span class="n">to</span> <span class="n">a</span> <span class="n">temp_isa</span> <span class="n">file</span> <span class="n">when</span> <span class="ow">in</span> <span class="n">GPU</span> <span class="n">dispatches</span>
<span class="o">--------------------------------------------------------------------------</span>
<span class="n">ROCm</span> <span class="n">variable</span> <span class="nb">print</span> <span class="n">commands</span><span class="p">:</span>
<span class="nb">print</span> <span class="n">rocm</span><span class="p">:</span><span class="o">&lt;</span><span class="n">variable</span><span class="o">&gt;</span>              <span class="n">Print</span> <span class="n">value</span> <span class="n">of</span> <span class="o">&lt;</span><span class="n">variable</span><span class="o">&gt;</span> <span class="k">for</span> <span class="n">the</span> <span class="n">focus</span> <span class="n">work</span><span class="o">-</span><span class="n">item</span>
<span class="o">--------------------------------------------------------------------------</span>
<span class="n">To</span> <span class="n">disassemble</span> <span class="n">a</span> <span class="n">GPU</span> <span class="n">kernel</span><span class="p">:</span>
<span class="n">disassemble</span>                        <span class="n">Show</span> <span class="n">the</span> <span class="n">GPU</span> <span class="n">ISA</span> <span class="n">disassembly</span> <span class="n">text</span> <span class="n">when</span> <span class="n">at</span> <span class="n">a</span> <span class="n">GPU</span> <span class="n">breakpoint</span>
<span class="o">--------------------------------------------------------------------------</span>
</pre></div>
</div>
</div>
<div class="section" id="how-do-i-set-breakpoints-in-my-gpu-application">
<h2>How do I set breakpoints in my GPU application?<a class="headerlink" href="#how-do-i-set-breakpoints-in-my-gpu-application" title="Permalink to this headline">¶</a></h2>
<p>To set breakpoints in GPU kernels, rocm-gdb defines</p>
<blockquote>
<div><ul class="simple">
<li>GPU kernel function breakpoint: Similar to a gdb function breakpoint, allows you stop the application just before a specific GPU dispatch      starts</li>
<li>Generic GPU kernel breakpoint: Stop the application before any GPU dispatch starts</li>
<li>Source line breakpoint: A breakpoint that is set on a particular line of GPU kernel source</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="setting-gpu-function-breakpoints">
<h2>Setting GPU function breakpoints<a class="headerlink" href="#setting-gpu-function-breakpoints" title="Permalink to this headline">¶</a></h2>
<p>The gdb :: break command has been extended to break rocm in order to set GPU breakpoints. To set a specific GPU kernel function breakpoints:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">break</span> <span class="pre">rocm:&lt;kernel_name&gt;</span></code></li>
</ul>
</div></blockquote>
<p>For matrix multiplication, you can specify the kernel name</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">(ROCm-gdb)</span> <span class="pre">break</span> <span class="pre">rocm:&amp;__OpenCL_matrixMul_kernel</span></code></li>
</ul>
</div></blockquote>
<p>This will stop the application’s execution just before the GPU kernel (in this case, the matrix multiplication kernel) begins executing on the device.</p>
<p>To set a general GPU kernel function breakpoint, use either of the following command:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">(ROCm-gdb)</span> <span class="pre">break</span> <span class="pre">rocm</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">(ROCm-gdb)</span> <span class="pre">break</span> <span class="pre">rocm:*</span></code></li>
</ul>
</div></blockquote>
<p>This will stop the application just before every dispatch begins executing on the device.</p>
</div>
<div class="section" id="setting-gpu-kernel-source-breakpoints">
<h2>Setting GPU kernel source breakpoints<a class="headerlink" href="#setting-gpu-kernel-source-breakpoints" title="Permalink to this headline">¶</a></h2>
<p>In order to break into GPU kernels, you need to set GPU source breakpoints. ROCm-gdb saves the kernel source for the present dispatch to a temporary file called temp_source. GPU source breakpoints can be set by specifying the line number from the temp_source GPU kernel source file. The temp_source file is overwritten by rocm-gdb on every GPU dispatch.</p>
<p>Once you hit a kernel function breakpoint, you can view the temp_source file and choose a line number. You can set the source breakpoint using the syntax</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">break</span> <span class="pre">rocm:&lt;line_number&gt;</span></code></li>
</ul>
</div></blockquote>
<p>For example, this will set a breakpoint at line 150 in the temp_source</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(ROCm-gdb) b rocm:150
GPU breakpoint 1 (PC:0x08d0 mad_u32 $s0, $s1, $s0, $s3; temp_source@line 150)
</pre></div>
</div>
<p>When you continue the program’s execution, the application will stop when any work-item reaches line 150 in temp_source.</p>
</div>
<div class="section" id="setting-conditional-gpu-kernel-source-breakpoints">
<h2>Setting Conditional GPU kernel source breakpoints<a class="headerlink" href="#setting-conditional-gpu-kernel-source-breakpoints" title="Permalink to this headline">¶</a></h2>
<p>Conditional GPU breakpoints allow you to stop the application only when a particular work-item hits a breakpoint. You can set a conditional source breakpoint by specifying the a work-item using the syntax:</p>
<blockquote>
<div><ul class="simple">
<li>break rocm:line_number if wg:x,y,z wi:x,y,z For example, this will set a breakpoint at line 150 and only stop the application if the work-item in workgroup 2,0,0 and local work-item 1,0,0</li>
</ul>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(ROCm-gdb) b rocm:150 if wg:2,0,0 wi:16,0,0
GPU breakpoint 1 (PC:0x08d0 mad_u32 $s0, $s1, $s0, $s3; temp_source@line 150)
</pre></div>
</div>
<p>When the application is executed, the dispatch will stop when line 150 is executed for the above work-item as shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[ROCm-gdb]: Switching to work-group (2,0,0) and work-item (1,0,0)
[ROCm-gdb]: Condition: active work-group: 2, 0, 0 @ work-item: 1, 0, 0
[ROCm-gdb]: Breakpoint 2 at mad_u32 $s0, $s1, $s0, $s3; temp_source@line 150
Stopped on GPU breakpoint
</pre></div>
</div>
</div>
<div class="section" id="managing-gpu-breakpoints">
<h2>Managing GPU breakpoints<a class="headerlink" href="#managing-gpu-breakpoints" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li>You can use the same gdb commands such as info bre to view information about the active GPU and host breakpoints The command info bre        shows multiple GPU kernel source breakpoints, an GPU function breakpoint and a host breakpoint</li>
</ul>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(ROCm-gdb) info bre
Num     Type             Disp Enb Address            What
1       GPU breakpoint   keep y   ---                Every GPU dispatch(*)
breakpoint already hit 2 times
4       GPU breakpoint   keep y   PC:0x06d8          add_u32 $s3, $s3, 1; temp_source@line 150
breakpoint already hit 320 times
5       GPU breakpoint   keep y   ---                &amp;__Gdt_vectoradd_kernel
6       breakpoint       keep y   0x0000000000407105 in RunTest() at MultiKernelDispatch.cpp:100

* You can also delete GPU breakpoints using the same command as GDB&#39;s host breakpoints del breakpoint_number
</pre></div>
</div>
</div>
<div class="section" id="how-do-i-single-step-in-a-gpu-kernel">
<h2>How do I single step in a GPU kernel?<a class="headerlink" href="#how-do-i-single-step-in-a-gpu-kernel" title="Permalink to this headline">¶</a></h2>
<p>You can single step in a GPU dispatch using the conventional step command. Only a single step is supported at a time.</p>
<p>The following shows how rocm-gdb steps 4 source lines after hitting a kernel source breakpoint</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(ROCm-gdb) b rocm:64
GPU breakpoint 2 (PC:0x02a0 workitemabsid_u32   $s0, 0; temp_source@line 64)
(ROCm-gdb) c
Continuing.
[New Thread 0x7fffef286700 (LWP 2776)]
[New Thread 0x7fffeea85700 (LWP 2777)]
Waiting for completion...
[Switching to Thread 0x7fffeea85700 (LWP 2777)]
[ROCm-gdb]: Switching to work-group (5,4,0) and work-item (0,8,0)
[ROCm-gdb]: Breakpoint 2 at PC:0x02a0 workitemabsid_u32   $s0, 0; temp_source@line 64
Stopped on GPU breakpoint

(ROCm-gdb) step
[ROCm-gdb]: PC:0x02ac         cvt_u64_u32 $d5, $s0; temp_source@line 65
Stopped on GPU breakpoint

(ROCm-gdb) s
[ROCm-gdb]: PC:0x02d0         workitemabsid_u32   $s0, 1; temp_source@line 66
Stopped on GPU breakpoint

(ROCm-gdb) s
[ROCm-gdb]: PC:0x02dc         ld_kernarg_align(8)_width(all)_u64  $d6, [%__global_offset_0]; temp_source@line 67
Stopped on GPU breakpoint

(ROCm-gdb) s
[ROCm-gdb]: PC:0x0304         add_u64 $d0, $d5, $d6; temp_source@line 68
Stopped on GPU breakpoint

(ROCm-gdb) c
Continuing.
</pre></div>
</div>
</div>
<div class="section" id="how-do-i-print-gpu-registers">
<h2>How do I print GPU registers?<a class="headerlink" href="#how-do-i-print-gpu-registers" title="Permalink to this headline">¶</a></h2>
<p>To print registers in a GPU kernel, the gdb print command has been extended. To print GPU registers.</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">print</span> <span class="pre">rocm:$register_name</span></code></li>
</ul>
</div></blockquote>
<p>This will print the value $register_name for a single work-item. For example, printing GPU register $s0 will provide the value of register $s0</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(ROCm-gdb) print rocm:$s0
$4 = 0
</pre></div>
</div>
<p>To view the data of a different work-item, you need switch focus between different work-items. The rocm thread command allows you to set the focus on a different work-item by specifying its work-item and work-group ID. It should be noted that you cannot switch focus to work-items not scheduled on the device.</p>
<p>Switching the focus to another work-item and printing $s0 allows us to view data for the other work-item.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(ROCm-gdb) rocm thread wg:0,0,0 wi:1,0,0
[ROCm-gdb]: Switching to work-group (0,0,0) and work-item (1,0,0)
(ROCm-gdb) print rocm:$s0
 $3 = 1
</pre></div>
</div>
</div>
<div class="section" id="how-do-i-view-the-gpu-isa-disassembly">
<h2>How do I view the GPU ISA disassembly?<a class="headerlink" href="#how-do-i-view-the-gpu-isa-disassembly" title="Permalink to this headline">¶</a></h2>
<p>To view the GPU ISA disassembly, you can use the standard gdb disassemble command while gdb stops at the GPU function breakpoint or GPU kernel source breakpoint.</p>
<p>While gdb stops at a GPU kernel source breakpoint, the program counter of the focus wave is shown with a (=&gt;) prefix and some ISA instructions above and below the program counter are shown.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">ROCm</span><span class="o">-</span><span class="n">gdb</span><span class="p">]:</span> <span class="n">Breakpoint</span> <span class="mi">1</span> <span class="n">at</span> <span class="n">GPU</span> <span class="n">Kernel</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ZZ4mainEN3_EC__219__cxxamp_trampolineEPfiiiiiiifS0_iiiiiii</span><span class="p">()</span>
<span class="n">GPU</span> <span class="n">kernel</span> <span class="n">saved</span> <span class="n">to</span> <span class="n">temp_source</span>
<span class="n">Stopped</span> <span class="n">on</span> <span class="n">GPU</span> <span class="n">breakpoint</span>

<span class="p">(</span><span class="n">ROCm</span><span class="o">-</span><span class="n">gdb</span><span class="p">)</span> <span class="n">s</span>
<span class="p">[</span><span class="n">New</span> <span class="n">Thread</span> <span class="mh">0x7fffee0e9700</span> <span class="p">(</span><span class="n">LWP</span> <span class="mi">3190</span><span class="p">)]</span>
<span class="p">[</span><span class="n">ROCm</span><span class="o">-</span><span class="n">gdb</span><span class="p">]:</span> <span class="n">Switching</span> <span class="n">to</span> <span class="n">work</span><span class="o">-</span><span class="n">group</span> <span class="p">(</span><span class="mi">486</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">work</span><span class="o">-</span><span class="n">item</span> <span class="p">(</span><span class="mi">256</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="p">[</span><span class="n">ROCm</span><span class="o">-</span><span class="n">gdb</span><span class="p">]:</span> <span class="n">Breakpoint</span><span class="p">:</span>  <span class="n">at</span> <span class="n">line</span> <span class="mi">24</span>
<span class="n">Stopped</span> <span class="n">on</span> <span class="n">GPU</span> <span class="n">breakpoint</span>
<span class="p">[</span><span class="n">Switching</span> <span class="n">to</span> <span class="n">Thread</span> <span class="mh">0x7fffee0e9700</span> <span class="p">(</span><span class="n">LWP</span> <span class="mi">3190</span><span class="p">)]</span>

<span class="p">(</span><span class="n">ROCm</span><span class="o">-</span><span class="n">gdb</span><span class="p">)</span> <span class="n">disassemble</span>
<span class="n">Disassembly</span><span class="p">:</span>
   <span class="n">s_lshr_b32</span>    <span class="n">s16</span><span class="p">,</span> <span class="n">s16</span><span class="p">,</span> <span class="mi">16</span>                            <span class="o">//</span> <span class="mi">000000000144</span><span class="p">:</span> <span class="mi">8</span><span class="n">F109010</span>
   <span class="n">s_mul_i32</span>     <span class="n">s18</span><span class="p">,</span> <span class="n">s12</span><span class="p">,</span> <span class="n">s13</span>                           <span class="o">//</span> <span class="mi">000000000148</span><span class="p">:</span> <span class="mi">92120</span><span class="n">D0C</span>
   <span class="n">s_mul_i32</span>     <span class="n">s20</span><span class="p">,</span> <span class="n">s5</span><span class="p">,</span> <span class="n">s15</span>                            <span class="o">//</span> <span class="mi">00000000014</span><span class="n">C</span><span class="p">:</span> <span class="mi">92140</span><span class="n">F05</span>
   <span class="n">s_movk_i32</span>    <span class="n">s19</span><span class="p">,</span> <span class="mh">0x0000</span>                             <span class="o">//</span> <span class="mi">000000000150</span><span class="p">:</span> <span class="n">B0130000</span>
   <span class="n">s_movk_i32</span>    <span class="n">s21</span><span class="p">,</span> <span class="mh">0x0000</span>                             <span class="o">//</span> <span class="mi">000000000154</span><span class="p">:</span> <span class="n">B0150000</span>
   <span class="n">s_add_u32</span>     <span class="n">s18</span><span class="p">,</span> <span class="n">s18</span><span class="p">,</span> <span class="n">s20</span>                           <span class="o">//</span> <span class="mi">000000000158</span><span class="p">:</span> <span class="mi">80121412</span>
   <span class="n">s_addc_u32</span>    <span class="n">s19</span><span class="p">,</span> <span class="n">s19</span><span class="p">,</span> <span class="n">s21</span>                           <span class="o">//</span> <span class="mi">00000000015</span><span class="n">C</span><span class="p">:</span> <span class="mi">82131513</span>
   <span class="n">s_movk_i32</span>    <span class="n">s17</span><span class="p">,</span> <span class="mh">0x0000</span>                             <span class="o">//</span> <span class="mi">000000000160</span><span class="p">:</span> <span class="n">B0110000</span>
   <span class="n">s_add_u32</span>     <span class="n">s16</span><span class="p">,</span> <span class="n">s16</span><span class="p">,</span> <span class="n">s18</span>                           <span class="o">//</span> <span class="mi">000000000164</span><span class="p">:</span> <span class="mi">80101210</span>
   <span class="n">s_addc_u32</span>    <span class="n">s17</span><span class="p">,</span> <span class="n">s17</span><span class="p">,</span> <span class="n">s19</span>                           <span class="o">//</span> <span class="mi">000000000168</span><span class="p">:</span> <span class="mi">82111311</span>
   <span class="n">s_lshr_b64</span>    <span class="n">s</span><span class="p">[</span><span class="mi">16</span><span class="p">:</span><span class="mi">17</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">16</span><span class="p">:</span><span class="mi">17</span><span class="p">],</span> <span class="mi">16</span>                  <span class="o">//</span> <span class="mi">00000000016</span><span class="n">C</span><span class="p">:</span> <span class="mi">8</span><span class="n">F909010</span>
   <span class="n">s_mul_i32</span>     <span class="n">s5</span><span class="p">,</span> <span class="n">s5</span><span class="p">,</span> <span class="n">s13</span>                             <span class="o">//</span> <span class="mi">000000000170</span><span class="p">:</span> <span class="mi">92050</span><span class="n">D05</span>
   <span class="n">s_add_u32</span>     <span class="n">s5</span><span class="p">,</span> <span class="n">s5</span><span class="p">,</span> <span class="n">s16</span>                             <span class="o">//</span> <span class="mi">000000000174</span><span class="p">:</span> <span class="mi">80051005</span>
   <span class="n">s_mul_i32</span>     <span class="n">s4</span><span class="p">,</span> <span class="n">s4</span><span class="p">,</span> <span class="n">s8</span>                              <span class="o">//</span> <span class="mi">000000000178</span><span class="p">:</span> <span class="mi">92040804</span>
   <span class="n">v_add_u32</span>     <span class="n">v3</span><span class="p">,</span> <span class="n">vcc</span><span class="p">,</span> <span class="n">s4</span><span class="p">,</span> <span class="n">v0</span>                         <span class="o">//</span> <span class="mi">00000000017</span><span class="n">C</span><span class="p">:</span> <span class="mi">32060004</span>
<span class="o">=&gt;</span>   <span class="n">s_nop</span>         <span class="mh">0x0000</span>                                  <span class="o">//</span> <span class="mi">000000000180</span><span class="p">:</span> <span class="n">BF800000</span>
     <span class="n">s_load_dword</span>  <span class="n">s4</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">7</span><span class="p">],</span> <span class="mh">0x18</span>                        <span class="o">//</span> <span class="mi">000000000184</span><span class="p">:</span> <span class="n">C0020103</span> <span class="mi">00000018</span>
     <span class="n">s_nop</span>         <span class="mh">0x0000</span>                                  <span class="o">//</span> <span class="mi">00000000018</span><span class="n">C</span><span class="p">:</span> <span class="n">BF800000</span>
     <span class="n">s_load_dword</span>  <span class="n">s5</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">7</span><span class="p">],</span> <span class="mh">0x40</span>                        <span class="o">//</span> <span class="mi">000000000190</span><span class="p">:</span> <span class="n">C0020143</span> <span class="mi">00000040</span>
     <span class="n">s_nop</span>         <span class="mh">0x0000</span>                                  <span class="o">//</span> <span class="mi">000000000198</span><span class="p">:</span> <span class="n">BF800000</span>
     <span class="n">s_load_dword</span>  <span class="n">s12</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">7</span><span class="p">],</span> <span class="mh">0x20</span>                       <span class="o">//</span> <span class="mi">00000000019</span><span class="n">C</span><span class="p">:</span> <span class="n">C0020303</span> <span class="mi">00000020</span>
     <span class="n">s_nop</span>         <span class="mh">0x0000</span>                                  <span class="o">//</span> <span class="mi">0000000001</span><span class="n">A4</span><span class="p">:</span> <span class="n">BF800000</span>
     <span class="n">s_load_dword</span>  <span class="n">s13</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">7</span><span class="p">],</span> <span class="mh">0x48</span>                       <span class="o">//</span> <span class="mi">0000000001</span><span class="n">A8</span><span class="p">:</span> <span class="n">C0020343</span> <span class="mi">00000048</span>
     <span class="n">s_waitcnt</span>     <span class="n">lgkmcnt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>                              <span class="o">//</span> <span class="mi">0000000001</span><span class="n">B0</span><span class="p">:</span> <span class="n">BF8C007F</span>
     <span class="n">s_nop</span>         <span class="mh">0x0000</span>                                  <span class="o">//</span> <span class="mi">0000000001</span><span class="n">B4</span><span class="p">:</span> <span class="n">BF800000</span>
     <span class="n">v_add_u32</span>     <span class="n">v9</span><span class="p">,</span> <span class="n">vcc</span><span class="p">,</span> <span class="n">s4</span><span class="p">,</span> <span class="n">v3</span>                         <span class="o">//</span> <span class="mi">0000000001</span><span class="n">B8</span><span class="p">:</span> <span class="mi">32120604</span>
     <span class="n">s_nop</span>         <span class="mh">0x0000</span>                                  <span class="o">//</span> <span class="mi">0000000001</span><span class="n">BC</span><span class="p">:</span> <span class="n">BF800000</span>
     <span class="n">v_add_u32</span>     <span class="n">v13</span><span class="p">,</span> <span class="n">vcc</span><span class="p">,</span> <span class="n">s5</span><span class="p">,</span> <span class="n">v3</span>                        <span class="o">//</span> <span class="mi">0000000001</span><span class="n">C0</span><span class="p">:</span> <span class="mi">321</span><span class="n">A0605</span>
     <span class="n">v_mov_b32</span>     <span class="n">v5</span><span class="p">,</span> <span class="n">s8</span>                                  <span class="o">//</span> <span class="mi">0000000001</span><span class="n">C4</span><span class="p">:</span> <span class="mf">7E0</span><span class="n">A0208</span>
     <span class="n">s_nop</span>         <span class="mh">0x0000</span>                                  <span class="o">//</span> <span class="mi">0000000001</span><span class="n">C8</span><span class="p">:</span> <span class="n">BF800000</span>
     <span class="n">v_ashrrev_i32</span>  <span class="n">v10</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="n">v9</span>                            <span class="o">//</span> <span class="mi">0000000001</span><span class="n">CC</span><span class="p">:</span> <span class="mi">2214129</span><span class="n">F</span>
 <span class="o">...</span>
 <span class="o">...</span>
 <span class="n">Remaining</span> <span class="n">GPU</span> <span class="n">ISA</span> <span class="n">saved</span> <span class="n">to</span> <span class="n">temp_isa</span>
</pre></div>
</div>
<p>If you want to view the complete ISA for the GPU kernel, the ISA is saved to temp_isa. The temp_isa also provides important information about the kernel such as the number of registers used, compiler flags used and the GPU ISA version.</p>
<p>An alternative method of viewing the ISA for every kernel is the set rocm option to save the ISA to a file whenever a GPU kernel is active. This can be enabled using the set rocm show-isa as shown below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">ROCm</span><span class="o">-</span><span class="n">gdb</span><span class="p">)</span> <span class="nb">set</span> <span class="n">rocm</span> <span class="n">show</span><span class="o">-</span><span class="n">isa</span> <span class="n">on</span>
</pre></div>
</div>
<p>With this option, ROCm-gdb saves the ISA for the active kernel to temp_isa whenever a GPU kernel is active.</p>
</div>
<div class="section" id="how-do-i-view-gpu-dispatch-info">
<h2>How do I view GPU dispatch info?<a class="headerlink" href="#how-do-i-view-gpu-dispatch-info" title="Permalink to this headline">¶</a></h2>
<p>The info command has been extended to info rocm. The info rocm command allows you to view the present state of the GPU dispatch and also allows you to view information about the GPU dispatches that have executed over the lifetime of the application.</p>
<blockquote>
<div><code class="docutils literal notranslate"><span class="pre">(ROCm-gdb)</span> <span class="pre">info</span> <span class="pre">rocm</span></code></div></blockquote>
<p>This will print all the possible options for info rocm. The info rocm command allows you to view information about the active dispatch, active work-groups and active work-items on the device. The possible inputs to info rocm are below</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">info</span> <span class="n">rocm</span> <span class="n">kernels</span>                                   <span class="n">Print</span> <span class="nb">all</span> <span class="n">GPU</span> <span class="n">kernel</span> <span class="n">dispatches</span>
<span class="n">info</span> <span class="n">rocm</span> <span class="n">kernel</span> <span class="o">&lt;</span><span class="n">kernel_name</span><span class="o">&gt;</span>                      <span class="n">Print</span> <span class="nb">all</span> <span class="n">GPU</span> <span class="n">kernel</span> <span class="n">dispatches</span> <span class="k">with</span> <span class="n">a</span> <span class="n">specific</span> <span class="o">&lt;</span><span class="n">kernel_name</span><span class="o">&gt;</span>
<span class="n">info</span> <span class="n">rocm</span> <span class="p">[</span><span class="n">work</span><span class="o">-</span><span class="n">groups</span><span class="o">|</span><span class="n">wgs</span><span class="p">]</span>                         <span class="n">Print</span> <span class="nb">all</span> <span class="n">GPU</span> <span class="n">work</span><span class="o">-</span><span class="n">group</span> <span class="n">items</span>
<span class="n">info</span> <span class="n">rocm</span> <span class="p">[</span><span class="n">work</span><span class="o">-</span><span class="n">group</span><span class="o">|</span><span class="n">wg</span><span class="p">]</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">flattened_id</span><span class="o">&gt;|&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span><span class="p">]</span>  <span class="n">Print</span> <span class="n">a</span> <span class="n">specific</span> <span class="n">GPU</span> <span class="n">work</span><span class="o">-</span><span class="n">group</span> <span class="n">item</span>
<span class="n">info</span> <span class="n">rocm</span> <span class="p">[</span><span class="n">work</span><span class="o">-</span><span class="n">item</span><span class="o">|</span><span class="n">wi</span><span class="o">|</span><span class="n">work</span><span class="o">-</span><span class="n">items</span><span class="o">|</span><span class="n">wis</span><span class="p">]</span>             <span class="n">Print</span> <span class="n">the</span> <span class="n">focus</span> <span class="n">GPU</span> <span class="n">work</span><span class="o">-</span><span class="n">item</span>
<span class="n">info</span> <span class="n">rocm</span> <span class="p">[</span><span class="n">work</span><span class="o">-</span><span class="n">item</span><span class="o">|</span><span class="n">wi</span><span class="p">]</span> <span class="o">&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span>                    <span class="n">Print</span> <span class="n">a</span> <span class="n">specific</span> <span class="n">GPU</span> <span class="n">work</span><span class="o">-</span><span class="n">item</span>
</pre></div>
</div>
<p>For example, info rocm kernels on an application that dispatches two kernels shows</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">ROCm</span><span class="o">-</span><span class="n">gdb</span><span class="p">)</span> <span class="n">info</span> <span class="n">rocm</span> <span class="n">kernels</span>
<span class="n">Kernels</span> <span class="n">info</span>
<span class="n">Index</span>                    <span class="n">KernelName</span>  <span class="n">DispatchCount</span>  <span class="c1"># of Work-groups  Work-group Dimensions</span>
    <span class="mi">0</span>       <span class="o">&amp;</span><span class="n">__Gdt_vectoradd_kernel</span>              <span class="mi">1</span>             <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span>                 <span class="mi">64</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span>
   <span class="o">*</span><span class="mi">1</span>    <span class="o">&amp;</span><span class="n">__OpenCL_matrixMul_kernel</span>              <span class="mi">1</span>             <span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span>                <span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">1</span>
</pre></div>
</div>
<p>The info rocm work-groups command will show the active work-groups for the active dispatch</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">ROCm</span><span class="o">-</span><span class="n">gdb</span><span class="p">)</span> <span class="n">info</span> <span class="n">rocm</span> <span class="n">work</span><span class="o">-</span><span class="n">groups</span>
 <span class="n">Index</span>            <span class="n">Work</span><span class="o">-</span><span class="n">group</span> <span class="n">ID</span>   <span class="n">Flattened</span> <span class="n">Work</span><span class="o">-</span><span class="n">group</span> <span class="n">ID</span>
   <span class="o">*</span><span class="mi">0</span>                    <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>                         <span class="mi">0</span>
    <span class="mi">1</span>                    <span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>                         <span class="mi">1</span>
    <span class="mi">2</span>                    <span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>                         <span class="mi">2</span>
</pre></div>
</div>
<p>The info rocm wg 0 command will show the information of work-group 0 for the active dispatch</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Information</span> <span class="k">for</span> <span class="n">Work</span><span class="o">-</span><span class="n">group</span> <span class="mi">0</span>
<span class="n">Index</span>     <span class="n">Wave</span> <span class="n">ID</span> <span class="p">{</span><span class="n">SE</span><span class="p">,</span><span class="n">SH</span><span class="p">,</span><span class="n">CU</span><span class="p">,</span><span class="n">SIMD</span><span class="p">,</span><span class="n">Wave</span><span class="p">}</span>            <span class="n">Work</span><span class="o">-</span><span class="n">item</span> <span class="n">ID</span>        <span class="n">Abs</span> <span class="n">Work</span><span class="o">-</span><span class="n">item</span> <span class="n">ID</span>        <span class="n">PC</span>            <span class="n">Source</span> <span class="n">line</span>
   <span class="mi">0</span>  <span class="mh">0x408001c0</span> <span class="p">{</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">}</span>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span> <span class="mi">0</span> <span class="o">-</span> <span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span> <span class="mi">0</span> <span class="o">-</span> <span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>     <span class="mh">0x2a8</span>    <span class="n">temp_source</span><span class="nd">@line</span> <span class="mi">64</span>
   <span class="mi">1</span>  <span class="mh">0x408001d0</span> <span class="p">{</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span>   <span class="mi">0</span><span class="p">}</span>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span> <span class="o">-</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span> <span class="o">-</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>     <span class="mh">0x2a8</span>    <span class="n">temp_source</span><span class="nd">@line</span> <span class="mi">64</span>
   <span class="mi">2</span>  <span class="mh">0x408001e0</span> <span class="p">{</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>   <span class="mi">2</span><span class="p">,</span>   <span class="mi">0</span><span class="p">}</span>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="o">-</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="o">-</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>     <span class="mh">0x2a8</span>    <span class="n">temp_source</span><span class="nd">@line</span> <span class="mi">64</span>
   <span class="mi">3</span>  <span class="mh">0x408001f0</span> <span class="p">{</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>   <span class="mi">3</span><span class="p">,</span>   <span class="mi">0</span><span class="p">}</span>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span> <span class="o">-</span> <span class="mi">15</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span> <span class="o">-</span> <span class="mi">15</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>     <span class="mh">0x2a8</span>    <span class="n">temp_source</span><span class="nd">@line</span> <span class="mi">64</span>
</pre></div>
</div>
<p>Wave ID contains the hardware slot ids where SE is the Shader Engine id, SH is the shader array id, CU is the Compute Unit id, SIMD is the SIMD id, and Wave is the wave slot id.</p>
<p>The info rocm work-item command will show the focus work-item for the active dispatch</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">ROCm</span><span class="o">-</span><span class="n">gdb</span><span class="p">)</span> <span class="n">info</span> <span class="n">rocm</span> <span class="n">wi</span>
<span class="n">Information</span> <span class="k">for</span> <span class="n">Work</span><span class="o">-</span><span class="n">item</span>
<span class="n">Index</span>     <span class="n">Wave</span> <span class="n">ID</span> <span class="p">{</span><span class="n">SE</span><span class="p">,</span><span class="n">SH</span><span class="p">,</span><span class="n">CU</span><span class="p">,</span><span class="n">SIMD</span><span class="p">,</span><span class="n">Wave</span><span class="p">}</span>            <span class="n">Work</span><span class="o">-</span><span class="n">item</span> <span class="n">ID</span>        <span class="n">Abs</span> <span class="n">Work</span><span class="o">-</span><span class="n">item</span> <span class="n">ID</span>        <span class="n">PC</span>            <span class="n">Source</span> <span class="n">line</span>
   <span class="o">*</span><span class="mi">0</span>  <span class="mh">0x408002d0</span> <span class="p">{</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span>   <span class="mi">0</span><span class="p">}</span>               <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>              <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>      <span class="mh">0x68</span>    <span class="n">temp_source</span><span class="nd">@line</span> <span class="mi">150</span>
</pre></div>
</div>
<p>The info rocm devices command will show the available ROCm devices in the system and the device presently executing a dispatch.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">ROCm</span><span class="o">-</span><span class="n">gdb</span><span class="p">)</span> <span class="n">info</span> <span class="n">rocm</span>  <span class="n">devices</span>
<span class="n">Devices</span> <span class="n">info</span>
<span class="n">Index</span>                          <span class="n">Name</span>      <span class="n">ChipID</span>         <span class="n">CUs</span>    <span class="n">Waves</span><span class="o">/</span><span class="n">CU</span>  <span class="n">EngineFreq</span>  <span class="n">MemoryFreq</span>
   <span class="o">*</span><span class="mi">0</span>                    <span class="n">AMD</span> <span class="n">gfx803</span>      <span class="mh">0x7300</span>          <span class="mi">64</span>          <span class="mi">40</span>        <span class="mi">1000</span>         <span class="mi">500</span>
</pre></div>
</div>
</div>
<div class="section" id="how-do-i-view-a-trace-of-gpu-dispatches">
<h2>How do I view a trace of GPU dispatches<a class="headerlink" href="#how-do-i-view-a-trace-of-gpu-dispatches" title="Permalink to this headline">¶</a></h2>
<p>ROCm-gdb helps developers to view information about kernels that have been launched on the GPU using the rocm trace commands. ROCm-gdb can save a trace of all the GPU kernel launches to a Comma Separated Value (CSV) file using the set rocm trace command. The following commands enable tracing GPU kernel launches to mytrace.csv.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">ROCm</span><span class="o">-</span><span class="n">gdb</span><span class="p">)</span> <span class="nb">set</span> <span class="n">rocm</span> <span class="n">trace</span> <span class="n">mytrace</span><span class="o">.</span><span class="n">csv</span>
<span class="p">(</span><span class="n">ROCm</span><span class="o">-</span><span class="n">gdb</span><span class="p">)</span> <span class="nb">set</span> <span class="n">rocm</span> <span class="n">trace</span> <span class="n">on</span>
</pre></div>
</div>
<dl class="docutils">
<dt>You can now execute and debug the application within ROCm-gdb. Anytime during the application’s execution you can view my_trace.csv to see the kernels have been dispatched. A sample trace for an application that dispatches a vector add kernel followed by a matrix multiplication kernel in a loop is shown below.</dt>
<dd>&amp;__OpenCL_matrixMul_kernel</dd>
</dl>
<blockquote>
<div>group_segment_size      kernel_object   kernarg_address         reserved2       completion_signal</div></blockquote>
<p>0       380095252       0       &amp;__Gdt_vectoradd_kernel         5122    1       {64 1 1}        0       {64 1 1}        0       0       140737353981952         0x713000        0       7513216
1       380095252       1       &amp;__OpenCL_matrixMul_kernel      5122    2       {16 16 1}       0       {128 80 1}      0       0       140737353983488         0x6ca000        0       7910848
2       380095252       2       &amp;__Gdt_vectoradd_kernel         5122    1       {64 1 1}        0       {64 1 1}        0       0       140737353977856         0x6e2000        0       7858432
3       380095252       3       &amp;__OpenCL_matrixMul_kernel      5122    2       {16 16 1}       0       {128 80 1}      0       0       140737353979392         0x6a3000        0       7177152
4       380095252       4       &amp;__Gdt_vectoradd_kernel         5122    1       {64 1 1}        0       {64 1 1}        0       0       140737353973760         0x666000        0       7981376
5       380095252       5       &amp;__OpenCL_matrixMul_kernel      5122    2       {16 16 1}       0       {128 80 1}      0       0       140737353975296         0x7a3000        0       7192640
6       380095252       6       &amp;__Gdt_vectoradd_kernel         5122    1       {64 1 1}        0       {64 1 1}        0       0       140737353969664         0x7a3000        0       7940224
7       380095252       7       &amp;__OpenCL_matrixMul_kernel      5122    2       {16 16 1}       0       {128 80 1}      0       0       140737353971200         0x697000        0       7765760
8       380095252       8       &amp;__Gdt_vectoradd_kernel         5122    1       {64 1 1}        0       {64 1 1}        0       0       140737353965568         0x70f000        0       6968192
9       380095252       9       &amp;__OpenCL_matrixMul_kernel      5122    2       {16 16 1}       0       {128 80 1}      0       0       140737353967104         0x708000        0       7081216</p>
</div>
<div class="section" id="how-do-i-compile-gpu-kernels-for-debug">
<h2>How do I compile GPU kernels for debug?<a class="headerlink" href="#how-do-i-compile-gpu-kernels-for-debug" title="Permalink to this headline">¶</a></h2>
<p>To debug GPU kernels that target ROCm, you need to compile the kernels for debug and embed the HSAIL kernel source in the resulting code object. Debug flags can be passed to high level compiler and the finalizer using environment variables. To simplify this process, the rocm-gdb-debug-flags.sh script is included in the /opt/rocm/gpudebugsdk/bin directory.</p>
<p>It should be noted that the rocm-gdb-debug-flags.sh should be called as source rocm-gdb-debug-flags.sh and not executed as ./rocm-gdb-debug-flags.sh since the script sets environment variables and the variables need to be visible for the subsequent build commands.</p>
<blockquote>
<div><ul class="simple">
<li>For applications using libHSAIL to compile their GPU kernels source rocm-gdb-debug-flags.sh should be called when the application is         compiled.</li>
<li>For SNACK applications, you can call source rocm-gdb-debug-flags.sh before calling the buildrun.sh script for the SNACK applications.</li>
</ul>
</div></blockquote>
<p>Note that kernel debugging is not yet supported with applications compiled using HCC-LC.</p>
<p>Once the application has been built using the environment variables specified in rocm-gdb-debug-flags.sh, you can debug libHSAIL applications as described in this tutorial.</p>
</div>
<div class="section" id="generating-logs-for-reporting-issues-in-rocm-gdb">
<h2>Generating logs for reporting issues in rocm-gdb<a class="headerlink" href="#generating-logs-for-reporting-issues-in-rocm-gdb" title="Permalink to this headline">¶</a></h2>
<p>Additional log files can be generated by rocm-gdb. These log files should be sent to the rocm-gdb developers to allow them to diagnose issues. Logging is enabled with the ROCM_GDB_ENABLE_LOG environment variable as shown below</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">ROCM_GDB_ENABLE_LOG</span><span class="o">=</span><span class="s1">&#39;DebugLogs&#39;</span>
<span class="n">rocm</span><span class="o">-</span><span class="n">gdb</span> <span class="n">MatrixMul</span>
</pre></div>
</div>
<p>The environment variable enables logging and provides a prefix for the log file names. As the MatrixMul application executes, log files with the prefix <a href="#id2"><span class="problematic" id="id3">DebugLogs_</span></a> will be generated. The log files generated include logs from GDB, the HSA Debug Agent and the HSA code objects used in the applications. Each debug session’s log file’s name will include a unique SessionID.
Others</p>
<p>A useful tutorial on how to use GDB can be found on <a class="reference external" href="http://www.unknownroad.com/rtfm/gdbtut/">RMS’s site</a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Thomas Edvalson.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>